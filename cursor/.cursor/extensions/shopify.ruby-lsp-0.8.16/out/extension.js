"use strict";var Tb=Object.create;var Rs=Object.defineProperty;var Pb=Object.getOwnPropertyDescriptor;var kb=Object.getOwnPropertyNames;var Eb=Object.getPrototypeOf,xb=Object.prototype.hasOwnProperty;var x=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),Ib=(r,e)=>{for(var t in e)Rs(r,t,{get:e[t],enumerable:!0})},qf=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of kb(e))!xb.call(r,i)&&i!==t&&Rs(r,i,{get:()=>e[i],enumerable:!(n=Pb(e,i))||n.enumerable});return r};var te=(r,e,t)=>(t=r!=null?Tb(Eb(r)):{},qf(e||!r||!r.__esModule?Rs(t,"default",{value:r,enumerable:!0}):t,r)),qb=r=>qf(Rs({},"__esModule",{value:!0}),r);var hn=x(et=>{"use strict";Object.defineProperty(et,"__esModule",{value:!0});et.asPromise=et.thenable=et.typedArray=et.stringArray=et.array=et.func=et.error=et.number=et.string=et.boolean=void 0;function Fb(r){return r===!0||r===!1}et.boolean=Fb;function Ff(r){return typeof r=="string"||r instanceof String}et.string=Ff;function Ob(r){return typeof r=="number"||r instanceof Number}et.number=Ob;function Lb(r){return r instanceof Error}et.error=Lb;function Of(r){return typeof r=="function"}et.func=Of;function Lf(r){return Array.isArray(r)}et.array=Lf;function Mb(r){return Lf(r)&&r.every(e=>Ff(e))}et.stringArray=Mb;function Nb(r,e){return Array.isArray(r)&&r.every(e)}et.typedArray=Nb;function Mf(r){return r&&Of(r.then)}et.thenable=Mf;function Ab(r){return r instanceof Promise?r:Mf(r)?new Promise((e,t)=>{r.then(n=>e(n),n=>t(n))}):Promise.resolve(r)}et.asPromise=Ab});var Yr=x(_t=>{"use strict";Object.defineProperty(_t,"__esModule",{value:!0});_t.stringArray=_t.array=_t.func=_t.error=_t.number=_t.string=_t.boolean=void 0;function $b(r){return r===!0||r===!1}_t.boolean=$b;function Nf(r){return typeof r=="string"||r instanceof String}_t.string=Nf;function jb(r){return typeof r=="number"||r instanceof Number}_t.number=jb;function Ub(r){return r instanceof Error}_t.error=Ub;function Hb(r){return typeof r=="function"}_t.func=Hb;function Af(r){return Array.isArray(r)}_t.array=Af;function Wb(r){return Af(r)&&r.every(e=>Nf(e))}_t.stringArray=Wb});var ac=x(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.Message=Q.NotificationType9=Q.NotificationType8=Q.NotificationType7=Q.NotificationType6=Q.NotificationType5=Q.NotificationType4=Q.NotificationType3=Q.NotificationType2=Q.NotificationType1=Q.NotificationType0=Q.NotificationType=Q.RequestType9=Q.RequestType8=Q.RequestType7=Q.RequestType6=Q.RequestType5=Q.RequestType4=Q.RequestType3=Q.RequestType2=Q.RequestType1=Q.RequestType=Q.RequestType0=Q.AbstractMessageSignature=Q.ParameterStructures=Q.ResponseError=Q.ErrorCodes=void 0;var qr=Yr(),Na;(function(r){r.ParseError=-32700,r.InvalidRequest=-32600,r.MethodNotFound=-32601,r.InvalidParams=-32602,r.InternalError=-32603,r.jsonrpcReservedErrorRangeStart=-32099,r.serverErrorStart=-32099,r.MessageWriteError=-32099,r.MessageReadError=-32098,r.PendingResponseRejected=-32097,r.ConnectionInactive=-32096,r.ServerNotInitialized=-32002,r.UnknownErrorCode=-32001,r.jsonrpcReservedErrorRangeEnd=-32e3,r.serverErrorEnd=-32e3})(Na||(Q.ErrorCodes=Na={}));var Aa=class r extends Error{constructor(e,t,n){super(t),this.code=qr.number(e)?e:Na.UnknownErrorCode,this.data=n,Object.setPrototypeOf(this,r.prototype)}toJson(){let e={code:this.code,message:this.message};return this.data!==void 0&&(e.data=this.data),e}};Q.ResponseError=Aa;var Ht=class r{constructor(e){this.kind=e}static is(e){return e===r.auto||e===r.byName||e===r.byPosition}toString(){return this.kind}};Q.ParameterStructures=Ht;Ht.auto=new Ht("auto");Ht.byPosition=new Ht("byPosition");Ht.byName=new Ht("byName");var je=class{constructor(e,t){this.method=e,this.numberOfParams=t}get parameterStructures(){return Ht.auto}};Q.AbstractMessageSignature=je;var $a=class extends je{constructor(e){super(e,0)}};Q.RequestType0=$a;var ja=class extends je{constructor(e,t=Ht.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType=ja;var Ua=class extends je{constructor(e,t=Ht.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.RequestType1=Ua;var Ha=class extends je{constructor(e){super(e,2)}};Q.RequestType2=Ha;var Wa=class extends je{constructor(e){super(e,3)}};Q.RequestType3=Wa;var Ka=class extends je{constructor(e){super(e,4)}};Q.RequestType4=Ka;var Va=class extends je{constructor(e){super(e,5)}};Q.RequestType5=Va;var za=class extends je{constructor(e){super(e,6)}};Q.RequestType6=za;var Ba=class extends je{constructor(e){super(e,7)}};Q.RequestType7=Ba;var Ga=class extends je{constructor(e){super(e,8)}};Q.RequestType8=Ga;var Xa=class extends je{constructor(e){super(e,9)}};Q.RequestType9=Xa;var Ja=class extends je{constructor(e,t=Ht.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType=Ja;var Qa=class extends je{constructor(e){super(e,0)}};Q.NotificationType0=Qa;var Ya=class extends je{constructor(e,t=Ht.auto){super(e,1),this._parameterStructures=t}get parameterStructures(){return this._parameterStructures}};Q.NotificationType1=Ya;var Za=class extends je{constructor(e){super(e,2)}};Q.NotificationType2=Za;var ec=class extends je{constructor(e){super(e,3)}};Q.NotificationType3=ec;var tc=class extends je{constructor(e){super(e,4)}};Q.NotificationType4=tc;var nc=class extends je{constructor(e){super(e,5)}};Q.NotificationType5=nc;var rc=class extends je{constructor(e){super(e,6)}};Q.NotificationType6=rc;var ic=class extends je{constructor(e){super(e,7)}};Q.NotificationType7=ic;var sc=class extends je{constructor(e){super(e,8)}};Q.NotificationType8=sc;var oc=class extends je{constructor(e){super(e,9)}};Q.NotificationType9=oc;var $f;(function(r){function e(i){let s=i;return s&&qr.string(s.method)&&(qr.string(s.id)||qr.number(s.id))}r.isRequest=e;function t(i){let s=i;return s&&qr.string(s.method)&&i.id===void 0}r.isNotification=t;function n(i){let s=i;return s&&(s.result!==void 0||!!s.error)&&(qr.string(s.id)||qr.number(s.id)||s.id===null)}r.isResponse=n})($f||(Q.Message=$f={}))});var uc=x(hr=>{"use strict";var jf;Object.defineProperty(hr,"__esModule",{value:!0});hr.LRUCache=hr.LinkedMap=hr.Touch=void 0;var Tt;(function(r){r.None=0,r.First=1,r.AsOld=r.First,r.Last=2,r.AsNew=r.Last})(Tt||(hr.Touch=Tt={}));var Ss=class{constructor(){this[jf]="LinkedMap",this._map=new Map,this._head=void 0,this._tail=void 0,this._size=0,this._state=0}clear(){this._map.clear(),this._head=void 0,this._tail=void 0,this._size=0,this._state++}isEmpty(){return!this._head&&!this._tail}get size(){return this._size}get first(){return this._head?.value}get last(){return this._tail?.value}has(e){return this._map.has(e)}get(e,t=Tt.None){let n=this._map.get(e);if(n)return t!==Tt.None&&this.touch(n,t),n.value}set(e,t,n=Tt.None){let i=this._map.get(e);if(i)i.value=t,n!==Tt.None&&this.touch(i,n);else{switch(i={key:e,value:t,next:void 0,previous:void 0},n){case Tt.None:this.addItemLast(i);break;case Tt.First:this.addItemFirst(i);break;case Tt.Last:this.addItemLast(i);break;default:this.addItemLast(i);break}this._map.set(e,i),this._size++}return this}delete(e){return!!this.remove(e)}remove(e){let t=this._map.get(e);if(t)return this._map.delete(e),this.removeItem(t),this._size--,t.value}shift(){if(!this._head&&!this._tail)return;if(!this._head||!this._tail)throw new Error("Invalid list");let e=this._head;return this._map.delete(e.key),this.removeItem(e),this._size--,e.value}forEach(e,t){let n=this._state,i=this._head;for(;i;){if(t?e.bind(t)(i.value,i.key,this):e(i.value,i.key,this),this._state!==n)throw new Error("LinkedMap got modified during iteration.");i=i.next}}keys(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.key,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}values(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:t.value,done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}entries(){let e=this._state,t=this._head,n={[Symbol.iterator]:()=>n,next:()=>{if(this._state!==e)throw new Error("LinkedMap got modified during iteration.");if(t){let i={value:[t.key,t.value],done:!1};return t=t.next,i}else return{value:void 0,done:!0}}};return n}[(jf=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}trimOld(e){if(e>=this.size)return;if(e===0){this.clear();return}let t=this._head,n=this.size;for(;t&&n>e;)this._map.delete(t.key),t=t.next,n--;this._head=t,this._size=n,t&&(t.previous=void 0),this._state++}addItemFirst(e){if(!this._head&&!this._tail)this._tail=e;else if(this._head)e.next=this._head,this._head.previous=e;else throw new Error("Invalid list");this._head=e,this._state++}addItemLast(e){if(!this._head&&!this._tail)this._head=e;else if(this._tail)e.previous=this._tail,this._tail.next=e;else throw new Error("Invalid list");this._tail=e,this._state++}removeItem(e){if(e===this._head&&e===this._tail)this._head=void 0,this._tail=void 0;else if(e===this._head){if(!e.next)throw new Error("Invalid list");e.next.previous=void 0,this._head=e.next}else if(e===this._tail){if(!e.previous)throw new Error("Invalid list");e.previous.next=void 0,this._tail=e.previous}else{let t=e.next,n=e.previous;if(!t||!n)throw new Error("Invalid list");t.previous=n,n.next=t}e.next=void 0,e.previous=void 0,this._state++}touch(e,t){if(!this._head||!this._tail)throw new Error("Invalid list");if(!(t!==Tt.First&&t!==Tt.Last)){if(t===Tt.First){if(e===this._head)return;let n=e.next,i=e.previous;e===this._tail?(i.next=void 0,this._tail=i):(n.previous=i,i.next=n),e.previous=void 0,e.next=this._head,this._head.previous=e,this._head=e,this._state++}else if(t===Tt.Last){if(e===this._tail)return;let n=e.next,i=e.previous;e===this._head?(n.previous=void 0,this._head=n):(n.previous=i,i.next=n),e.next=void 0,e.previous=this._tail,this._tail.next=e,this._tail=e,this._state++}}}toJSON(){let e=[];return this.forEach((t,n)=>{e.push([n,t])}),e}fromJSON(e){this.clear();for(let[t,n]of e)this.set(t,n)}};hr.LinkedMap=Ss;var cc=class extends Ss{constructor(e,t=1){super(),this._limit=e,this._ratio=Math.min(Math.max(0,t),1)}get limit(){return this._limit}set limit(e){this._limit=e,this.checkTrim()}get ratio(){return this._ratio}set ratio(e){this._ratio=Math.min(Math.max(0,e),1),this.checkTrim()}get(e,t=Tt.AsNew){return super.get(e,t)}peek(e){return super.get(e,Tt.None)}set(e,t){return super.set(e,t,Tt.Last),this.checkTrim(),this}checkTrim(){this.size>this._limit&&this.trimOld(Math.round(this._limit*this._ratio))}};hr.LRUCache=cc});var Hf=x(Ds=>{"use strict";Object.defineProperty(Ds,"__esModule",{value:!0});Ds.Disposable=void 0;var Uf;(function(r){function e(t){return{dispose:t}}r.create=e})(Uf||(Ds.Disposable=Uf={}))});var pr=x(fc=>{"use strict";Object.defineProperty(fc,"__esModule",{value:!0});var dc;function lc(){if(dc===void 0)throw new Error("No runtime abstraction layer installed");return dc}(function(r){function e(t){if(t===void 0)throw new Error("No runtime abstraction layer provided");dc=t}r.install=e})(lc||(lc={}));fc.default=lc});var ei=x(Zr=>{"use strict";Object.defineProperty(Zr,"__esModule",{value:!0});Zr.Emitter=Zr.Event=void 0;var Kb=pr(),Wf;(function(r){let e={dispose(){}};r.None=function(){return e}})(Wf||(Zr.Event=Wf={}));var hc=class{add(e,t=null,n){this._callbacks||(this._callbacks=[],this._contexts=[]),this._callbacks.push(e),this._contexts.push(t),Array.isArray(n)&&n.push({dispose:()=>this.remove(e,t)})}remove(e,t=null){if(!this._callbacks)return;let n=!1;for(let i=0,s=this._callbacks.length;i<s;i++)if(this._callbacks[i]===e)if(this._contexts[i]===t){this._callbacks.splice(i,1),this._contexts.splice(i,1);return}else n=!0;if(n)throw new Error("When adding a listener with a context, you should remove it with the same context")}invoke(...e){if(!this._callbacks)return[];let t=[],n=this._callbacks.slice(0),i=this._contexts.slice(0);for(let s=0,o=n.length;s<o;s++)try{t.push(n[s].apply(i[s],e))}catch(a){(0,Kb.default)().console.error(a)}return t}isEmpty(){return!this._callbacks||this._callbacks.length===0}dispose(){this._callbacks=void 0,this._contexts=void 0}},_s=class r{constructor(e){this._options=e}get event(){return this._event||(this._event=(e,t,n)=>{this._callbacks||(this._callbacks=new hc),this._options&&this._options.onFirstListenerAdd&&this._callbacks.isEmpty()&&this._options.onFirstListenerAdd(this),this._callbacks.add(e,t);let i={dispose:()=>{this._callbacks&&(this._callbacks.remove(e,t),i.dispose=r._noop,this._options&&this._options.onLastListenerRemove&&this._callbacks.isEmpty()&&this._options.onLastListenerRemove(this))}};return Array.isArray(n)&&n.push(i),i}),this._event}fire(e){this._callbacks&&this._callbacks.invoke.call(this._callbacks,e)}dispose(){this._callbacks&&(this._callbacks.dispose(),this._callbacks=void 0)}};Zr.Emitter=_s;_s._noop=function(){}});var ks=x(ti=>{"use strict";Object.defineProperty(ti,"__esModule",{value:!0});ti.CancellationTokenSource=ti.CancellationToken=void 0;var Vb=pr(),zb=Yr(),pc=ei(),Ts;(function(r){r.None=Object.freeze({isCancellationRequested:!1,onCancellationRequested:pc.Event.None}),r.Cancelled=Object.freeze({isCancellationRequested:!0,onCancellationRequested:pc.Event.None});function e(t){let n=t;return n&&(n===r.None||n===r.Cancelled||zb.boolean(n.isCancellationRequested)&&!!n.onCancellationRequested)}r.is=e})(Ts||(ti.CancellationToken=Ts={}));var Bb=Object.freeze(function(r,e){let t=(0,Vb.default)().timer.setTimeout(r.bind(e),0);return{dispose(){t.dispose()}}}),Ps=class{constructor(){this._isCancelled=!1}cancel(){this._isCancelled||(this._isCancelled=!0,this._emitter&&(this._emitter.fire(void 0),this.dispose()))}get isCancellationRequested(){return this._isCancelled}get onCancellationRequested(){return this._isCancelled?Bb:(this._emitter||(this._emitter=new pc.Emitter),this._emitter.event)}dispose(){this._emitter&&(this._emitter.dispose(),this._emitter=void 0)}},gc=class{get token(){return this._token||(this._token=new Ps),this._token}cancel(){this._token?this._token.cancel():this._token=Ts.Cancelled}dispose(){this._token?this._token instanceof Ps&&this._token.dispose():this._token=Ts.None}};ti.CancellationTokenSource=gc});var Kf=x(ni=>{"use strict";Object.defineProperty(ni,"__esModule",{value:!0});ni.SharedArrayReceiverStrategy=ni.SharedArraySenderStrategy=void 0;var Gb=ks(),Oi;(function(r){r.Continue=0,r.Cancelled=1})(Oi||(Oi={}));var mc=class{constructor(){this.buffers=new Map}enableCancellation(e){if(e.id===null)return;let t=new SharedArrayBuffer(4),n=new Int32Array(t,0,1);n[0]=Oi.Continue,this.buffers.set(e.id,t),e.$cancellationData=t}async sendCancellation(e,t){let n=this.buffers.get(t);if(n===void 0)return;let i=new Int32Array(n,0,1);Atomics.store(i,0,Oi.Cancelled)}cleanup(e){this.buffers.delete(e)}dispose(){this.buffers.clear()}};ni.SharedArraySenderStrategy=mc;var vc=class{constructor(e){this.data=new Int32Array(e,0,1)}get isCancellationRequested(){return Atomics.load(this.data,0)===Oi.Cancelled}get onCancellationRequested(){throw new Error("Cancellation over SharedArrayBuffer doesn't support cancellation events")}},yc=class{constructor(e){this.token=new vc(e)}cancel(){}dispose(){}},bc=class{constructor(){this.kind="request"}createCancellationTokenSource(e){let t=e.$cancellationData;return t===void 0?new Gb.CancellationTokenSource:new yc(t)}};ni.SharedArrayReceiverStrategy=bc});var Cc=x(Es=>{"use strict";Object.defineProperty(Es,"__esModule",{value:!0});Es.Semaphore=void 0;var Xb=pr(),wc=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Xb.default)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};Es.Semaphore=wc});var zf=x(gr=>{"use strict";Object.defineProperty(gr,"__esModule",{value:!0});gr.ReadableStreamMessageReader=gr.AbstractMessageReader=gr.MessageReader=void 0;var Sc=pr(),ri=Yr(),Rc=ei(),Jb=Cc(),Vf;(function(r){function e(t){let n=t;return n&&ri.func(n.listen)&&ri.func(n.dispose)&&ri.func(n.onError)&&ri.func(n.onClose)&&ri.func(n.onPartialMessage)}r.is=e})(Vf||(gr.MessageReader=Vf={}));var xs=class{constructor(){this.errorEmitter=new Rc.Emitter,this.closeEmitter=new Rc.Emitter,this.partialMessageEmitter=new Rc.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e){this.errorEmitter.fire(this.asError(e))}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}get onPartialMessage(){return this.partialMessageEmitter.event}firePartialMessage(e){this.partialMessageEmitter.fire(e)}asError(e){return e instanceof Error?e:new Error(`Reader received error. Reason: ${ri.string(e.message)?e.message:"unknown"}`)}};gr.AbstractMessageReader=xs;var Dc;(function(r){function e(t){let n,i,s,o=new Map,a,u=new Map;if(t===void 0||typeof t=="string")n=t??"utf-8";else{if(n=t.charset??"utf-8",t.contentDecoder!==void 0&&(s=t.contentDecoder,o.set(s.name,s)),t.contentDecoders!==void 0)for(let d of t.contentDecoders)o.set(d.name,d);if(t.contentTypeDecoder!==void 0&&(a=t.contentTypeDecoder,u.set(a.name,a)),t.contentTypeDecoders!==void 0)for(let d of t.contentTypeDecoders)u.set(d.name,d)}return a===void 0&&(a=(0,Sc.default)().applicationJson.decoder,u.set(a.name,a)),{charset:n,contentDecoder:s,contentDecoders:o,contentTypeDecoder:a,contentTypeDecoders:u}}r.fromOptions=e})(Dc||(Dc={}));var _c=class extends xs{constructor(e,t){super(),this.readable=e,this.options=Dc.fromOptions(t),this.buffer=(0,Sc.default)().messageBuffer.create(this.options.charset),this._partialMessageTimeout=1e4,this.nextMessageLength=-1,this.messageToken=0,this.readSemaphore=new Jb.Semaphore(1)}set partialMessageTimeout(e){this._partialMessageTimeout=e}get partialMessageTimeout(){return this._partialMessageTimeout}listen(e){this.nextMessageLength=-1,this.messageToken=0,this.partialMessageTimer=void 0,this.callback=e;let t=this.readable.onData(n=>{this.onData(n)});return this.readable.onError(n=>this.fireError(n)),this.readable.onClose(()=>this.fireClose()),t}onData(e){try{for(this.buffer.append(e);;){if(this.nextMessageLength===-1){let n=this.buffer.tryReadHeaders(!0);if(!n)return;let i=n.get("content-length");if(!i){this.fireError(new Error(`Header must provide a Content-Length property.
${JSON.stringify(Object.fromEntries(n))}`));return}let s=parseInt(i);if(isNaN(s)){this.fireError(new Error(`Content-Length value must be a number. Got ${i}`));return}this.nextMessageLength=s}let t=this.buffer.tryReadBody(this.nextMessageLength);if(t===void 0){this.setPartialMessageTimer();return}this.clearPartialMessageTimer(),this.nextMessageLength=-1,this.readSemaphore.lock(async()=>{let n=this.options.contentDecoder!==void 0?await this.options.contentDecoder.decode(t):t,i=await this.options.contentTypeDecoder.decode(n,this.options);this.callback(i)}).catch(n=>{this.fireError(n)})}}catch(t){this.fireError(t)}}clearPartialMessageTimer(){this.partialMessageTimer&&(this.partialMessageTimer.dispose(),this.partialMessageTimer=void 0)}setPartialMessageTimer(){this.clearPartialMessageTimer(),!(this._partialMessageTimeout<=0)&&(this.partialMessageTimer=(0,Sc.default)().timer.setTimeout((e,t)=>{this.partialMessageTimer=void 0,e===this.messageToken&&(this.firePartialMessage({messageToken:e,waitingTime:t}),this.setPartialMessageTimer())},this._partialMessageTimeout,this.messageToken,this._partialMessageTimeout))}};gr.ReadableStreamMessageReader=_c});var Qf=x(mr=>{"use strict";Object.defineProperty(mr,"__esModule",{value:!0});mr.WriteableStreamMessageWriter=mr.AbstractMessageWriter=mr.MessageWriter=void 0;var Bf=pr(),Li=Yr(),Qb=Cc(),Gf=ei(),Yb="Content-Length: ",Xf=`\r
`,Jf;(function(r){function e(t){let n=t;return n&&Li.func(n.dispose)&&Li.func(n.onClose)&&Li.func(n.onError)&&Li.func(n.write)}r.is=e})(Jf||(mr.MessageWriter=Jf={}));var Is=class{constructor(){this.errorEmitter=new Gf.Emitter,this.closeEmitter=new Gf.Emitter}dispose(){this.errorEmitter.dispose(),this.closeEmitter.dispose()}get onError(){return this.errorEmitter.event}fireError(e,t,n){this.errorEmitter.fire([this.asError(e),t,n])}get onClose(){return this.closeEmitter.event}fireClose(){this.closeEmitter.fire(void 0)}asError(e){return e instanceof Error?e:new Error(`Writer received error. Reason: ${Li.string(e.message)?e.message:"unknown"}`)}};mr.AbstractMessageWriter=Is;var Tc;(function(r){function e(t){return t===void 0||typeof t=="string"?{charset:t??"utf-8",contentTypeEncoder:(0,Bf.default)().applicationJson.encoder}:{charset:t.charset??"utf-8",contentEncoder:t.contentEncoder,contentTypeEncoder:t.contentTypeEncoder??(0,Bf.default)().applicationJson.encoder}}r.fromOptions=e})(Tc||(Tc={}));var Pc=class extends Is{constructor(e,t){super(),this.writable=e,this.options=Tc.fromOptions(t),this.errorCount=0,this.writeSemaphore=new Qb.Semaphore(1),this.writable.onError(n=>this.fireError(n)),this.writable.onClose(()=>this.fireClose())}async write(e){return this.writeSemaphore.lock(async()=>this.options.contentTypeEncoder.encode(e,this.options).then(n=>this.options.contentEncoder!==void 0?this.options.contentEncoder.encode(n):n).then(n=>{let i=[];return i.push(Yb,n.byteLength.toString(),Xf),i.push(Xf),this.doWrite(e,i,n)},n=>{throw this.fireError(n),n}))}async doWrite(e,t,n){try{return await this.writable.write(t.join(""),"ascii"),this.writable.write(n)}catch(i){return this.handleError(i,e),Promise.reject(i)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){this.writable.end()}};mr.WriteableStreamMessageWriter=Pc});var Yf=x(qs=>{"use strict";Object.defineProperty(qs,"__esModule",{value:!0});qs.AbstractMessageBuffer=void 0;var Zb=13,ew=10,tw=`\r
`,kc=class{constructor(e="utf-8"){this._encoding=e,this._chunks=[],this._totalLength=0}get encoding(){return this._encoding}append(e){let t=typeof e=="string"?this.fromString(e,this._encoding):e;this._chunks.push(t),this._totalLength+=t.byteLength}tryReadHeaders(e=!1){if(this._chunks.length===0)return;let t=0,n=0,i=0,s=0;e:for(;n<this._chunks.length;){let d=this._chunks[n];for(i=0;i<d.length;){switch(d[i]){case Zb:switch(t){case 0:t=1;break;case 2:t=3;break;default:t=0}break;case ew:switch(t){case 1:t=2;break;case 3:t=4,i++;break e;default:t=0}break;default:t=0}i++}s+=d.byteLength,n++}if(t!==4)return;let o=this._read(s+i),a=new Map,u=this.toString(o,"ascii").split(tw);if(u.length<2)return a;for(let d=0;d<u.length-2;d++){let p=u[d],m=p.indexOf(":");if(m===-1)throw new Error(`Message header must separate key and value using ':'
${p}`);let g=p.substr(0,m),S=p.substr(m+1).trim();a.set(e?g.toLowerCase():g,S)}return a}tryReadBody(e){if(!(this._totalLength<e))return this._read(e)}get numberOfBytes(){return this._totalLength}_read(e){if(e===0)return this.emptyBuffer();if(e>this._totalLength)throw new Error("Cannot read so many bytes!");if(this._chunks[0].byteLength===e){let s=this._chunks[0];return this._chunks.shift(),this._totalLength-=e,this.asNative(s)}if(this._chunks[0].byteLength>e){let s=this._chunks[0],o=this.asNative(s,e);return this._chunks[0]=s.slice(e),this._totalLength-=e,o}let t=this.allocNative(e),n=0,i=0;for(;e>0;){let s=this._chunks[i];if(s.byteLength>e){let o=s.slice(0,e);t.set(o,n),n+=e,this._chunks[i]=s.slice(e),this._totalLength-=e,e-=e}else t.set(s,n),n+=s.byteLength,this._chunks.shift(),this._totalLength-=s.byteLength,e-=s.byteLength}return t}};qs.AbstractMessageBuffer=kc});var rh=x(se=>{"use strict";Object.defineProperty(se,"__esModule",{value:!0});se.createMessageConnection=se.ConnectionOptions=se.MessageStrategy=se.CancellationStrategy=se.CancellationSenderStrategy=se.CancellationReceiverStrategy=se.RequestCancellationReceiverStrategy=se.IdCancellationReceiverStrategy=se.ConnectionStrategy=se.ConnectionError=se.ConnectionErrors=se.LogTraceNotification=se.SetTraceNotification=se.TraceFormat=se.TraceValues=se.Trace=se.NullLogger=se.ProgressType=se.ProgressToken=void 0;var Zf=pr(),Be=Yr(),Y=ac(),eh=uc(),Mi=ei(),Ec=ks(),$i;(function(r){r.type=new Y.NotificationType("$/cancelRequest")})($i||($i={}));var xc;(function(r){function e(t){return typeof t=="string"||typeof t=="number"}r.is=e})(xc||(se.ProgressToken=xc={}));var Ni;(function(r){r.type=new Y.NotificationType("$/progress")})(Ni||(Ni={}));var Ic=class{constructor(){}};se.ProgressType=Ic;var qc;(function(r){function e(t){return Be.func(t)}r.is=e})(qc||(qc={}));se.NullLogger=Object.freeze({error:()=>{},warn:()=>{},info:()=>{},log:()=>{}});var _e;(function(r){r[r.Off=0]="Off",r[r.Messages=1]="Messages",r[r.Compact=2]="Compact",r[r.Verbose=3]="Verbose"})(_e||(se.Trace=_e={}));var th;(function(r){r.Off="off",r.Messages="messages",r.Compact="compact",r.Verbose="verbose"})(th||(se.TraceValues=th={}));(function(r){function e(n){if(!Be.string(n))return r.Off;switch(n=n.toLowerCase(),n){case"off":return r.Off;case"messages":return r.Messages;case"compact":return r.Compact;case"verbose":return r.Verbose;default:return r.Off}}r.fromString=e;function t(n){switch(n){case r.Off:return"off";case r.Messages:return"messages";case r.Compact:return"compact";case r.Verbose:return"verbose";default:return"off"}}r.toString=t})(_e||(se.Trace=_e={}));var tn;(function(r){r.Text="text",r.JSON="json"})(tn||(se.TraceFormat=tn={}));(function(r){function e(t){return Be.string(t)?(t=t.toLowerCase(),t==="json"?r.JSON:r.Text):r.Text}r.fromString=e})(tn||(se.TraceFormat=tn={}));var Fc;(function(r){r.type=new Y.NotificationType("$/setTrace")})(Fc||(se.SetTraceNotification=Fc={}));var Fs;(function(r){r.type=new Y.NotificationType("$/logTrace")})(Fs||(se.LogTraceNotification=Fs={}));var Ai;(function(r){r[r.Closed=1]="Closed",r[r.Disposed=2]="Disposed",r[r.AlreadyListening=3]="AlreadyListening"})(Ai||(se.ConnectionErrors=Ai={}));var ii=class r extends Error{constructor(e,t){super(t),this.code=e,Object.setPrototypeOf(this,r.prototype)}};se.ConnectionError=ii;var Oc;(function(r){function e(t){let n=t;return n&&Be.func(n.cancelUndispatched)}r.is=e})(Oc||(se.ConnectionStrategy=Oc={}));var Os;(function(r){function e(t){let n=t;return n&&(n.kind===void 0||n.kind==="id")&&Be.func(n.createCancellationTokenSource)&&(n.dispose===void 0||Be.func(n.dispose))}r.is=e})(Os||(se.IdCancellationReceiverStrategy=Os={}));var Lc;(function(r){function e(t){let n=t;return n&&n.kind==="request"&&Be.func(n.createCancellationTokenSource)&&(n.dispose===void 0||Be.func(n.dispose))}r.is=e})(Lc||(se.RequestCancellationReceiverStrategy=Lc={}));var Ls;(function(r){r.Message=Object.freeze({createCancellationTokenSource(t){return new Ec.CancellationTokenSource}});function e(t){return Os.is(t)||Lc.is(t)}r.is=e})(Ls||(se.CancellationReceiverStrategy=Ls={}));var Ms;(function(r){r.Message=Object.freeze({sendCancellation(t,n){return t.sendNotification($i.type,{id:n})},cleanup(t){}});function e(t){let n=t;return n&&Be.func(n.sendCancellation)&&Be.func(n.cleanup)}r.is=e})(Ms||(se.CancellationSenderStrategy=Ms={}));var Ns;(function(r){r.Message=Object.freeze({receiver:Ls.Message,sender:Ms.Message});function e(t){let n=t;return n&&Ls.is(n.receiver)&&Ms.is(n.sender)}r.is=e})(Ns||(se.CancellationStrategy=Ns={}));var As;(function(r){function e(t){let n=t;return n&&Be.func(n.handleMessage)}r.is=e})(As||(se.MessageStrategy=As={}));var nh;(function(r){function e(t){let n=t;return n&&(Ns.is(n.cancellationStrategy)||Oc.is(n.connectionStrategy)||As.is(n.messageStrategy))}r.is=e})(nh||(se.ConnectionOptions=nh={}));var Pn;(function(r){r[r.New=1]="New",r[r.Listening=2]="Listening",r[r.Closed=3]="Closed",r[r.Disposed=4]="Disposed"})(Pn||(Pn={}));function nw(r,e,t,n){let i=t!==void 0?t:se.NullLogger,s=0,o=0,a=0,u="2.0",d,p=new Map,m,g=new Map,S=new Map,y,P=new eh.LinkedMap,E=new Map,L=new Set,N=new Map,M=_e.Off,H=tn.Text,J,pe=Pn.New,G=new Mi.Emitter,ee=new Mi.Emitter,de=new Mi.Emitter,it=new Mi.Emitter,Ye=new Mi.Emitter,at=n&&n.cancellationStrategy?n.cancellationStrategy:Ns.Message;function dn(w){if(w===null)throw new Error("Can't send requests with id null since the response can't be correlated.");return"req-"+w.toString()}function Ft(w){return w===null?"res-unknown-"+(++a).toString():"res-"+w.toString()}function yt(){return"not-"+(++o).toString()}function bt(w,q){Y.Message.isRequest(q)?w.set(dn(q.id),q):Y.Message.isResponse(q)?w.set(Ft(q.id),q):w.set(yt(),q)}function Cn(w){}function Fn(){return pe===Pn.Listening}function Ne(){return pe===Pn.Closed}function $t(){return pe===Pn.Disposed}function Ot(){(pe===Pn.New||pe===Pn.Listening)&&(pe=Pn.Closed,ee.fire(void 0))}function wt(w){G.fire([w,void 0,void 0])}function cr(w){G.fire(w)}r.onClose(Ot),r.onError(wt),e.onClose(Ot),e.onError(cr);function On(){y||P.size===0||(y=(0,Zf.default)().timer.setImmediate(()=>{y=void 0,Bn()}))}function Ln(w){Y.Message.isRequest(w)?Mn(w):Y.Message.isNotification(w)?Sn(w):Y.Message.isResponse(w)?Rn(w):Nn(w)}function Bn(){if(P.size===0)return;let w=P.shift();try{let q=n?.messageStrategy;As.is(q)?q.handleMessage(w,Ln):Ln(w)}finally{On()}}let ur=w=>{try{if(Y.Message.isNotification(w)&&w.method===$i.type.method){let q=w.params.id,U=dn(q),K=P.get(U);if(Y.Message.isRequest(K)){let be=n?.connectionStrategy,Pe=be&&be.cancelUndispatched?be.cancelUndispatched(K,Cn):void 0;if(Pe&&(Pe.error!==void 0||Pe.result!==void 0)){P.delete(U),N.delete(q),Pe.id=K.id,ln(Pe,w.method,Date.now()),e.write(Pe).catch(()=>i.error("Sending response for canceled message failed."));return}}let Ce=N.get(q);if(Ce!==void 0){Ce.cancel(),fn(w);return}else L.add(q)}bt(P,w)}finally{On()}};function Mn(w){if($t())return;function q(ce,Se,ge){let Fe={jsonrpc:u,id:w.id};ce instanceof Y.ResponseError?Fe.error=ce.toJson():Fe.result=ce===void 0?null:ce,ln(Fe,Se,ge),e.write(Fe).catch(()=>i.error("Sending response failed."))}function U(ce,Se,ge){let Fe={jsonrpc:u,id:w.id,error:ce.toJson()};ln(Fe,Se,ge),e.write(Fe).catch(()=>i.error("Sending response failed."))}function K(ce,Se,ge){ce===void 0&&(ce=null);let Fe={jsonrpc:u,id:w.id,result:ce};ln(Fe,Se,ge),e.write(Fe).catch(()=>i.error("Sending response failed."))}dr(w);let Ce=p.get(w.method),be,Pe;Ce&&(be=Ce.type,Pe=Ce.handler);let qe=Date.now();if(Pe||d){let ce=w.id??String(Date.now()),Se=Os.is(at.receiver)?at.receiver.createCancellationTokenSource(ce):at.receiver.createCancellationTokenSource(w);w.id!==null&&L.has(w.id)&&Se.cancel(),w.id!==null&&N.set(ce,Se);try{let ge;if(Pe)if(w.params===void 0){if(be!==void 0&&be.numberOfParams!==0){U(new Y.ResponseError(Y.ErrorCodes.InvalidParams,`Request ${w.method} defines ${be.numberOfParams} params but received none.`),w.method,qe);return}ge=Pe(Se.token)}else if(Array.isArray(w.params)){if(be!==void 0&&be.parameterStructures===Y.ParameterStructures.byName){U(new Y.ResponseError(Y.ErrorCodes.InvalidParams,`Request ${w.method} defines parameters by name but received parameters by position`),w.method,qe);return}ge=Pe(...w.params,Se.token)}else{if(be!==void 0&&be.parameterStructures===Y.ParameterStructures.byPosition){U(new Y.ResponseError(Y.ErrorCodes.InvalidParams,`Request ${w.method} defines parameters by position but received parameters by name`),w.method,qe);return}ge=Pe(w.params,Se.token)}else d&&(ge=d(w.method,w.params,Se.token));let Fe=ge;ge?Fe.then?Fe.then(Ze=>{N.delete(ce),q(Ze,w.method,qe)},Ze=>{N.delete(ce),Ze instanceof Y.ResponseError?U(Ze,w.method,qe):Ze&&Be.string(Ze.message)?U(new Y.ResponseError(Y.ErrorCodes.InternalError,`Request ${w.method} failed with message: ${Ze.message}`),w.method,qe):U(new Y.ResponseError(Y.ErrorCodes.InternalError,`Request ${w.method} failed unexpectedly without providing any details.`),w.method,qe)}):(N.delete(ce),q(ge,w.method,qe)):(N.delete(ce),K(ge,w.method,qe))}catch(ge){N.delete(ce),ge instanceof Y.ResponseError?q(ge,w.method,qe):ge&&Be.string(ge.message)?U(new Y.ResponseError(Y.ErrorCodes.InternalError,`Request ${w.method} failed with message: ${ge.message}`),w.method,qe):U(new Y.ResponseError(Y.ErrorCodes.InternalError,`Request ${w.method} failed unexpectedly without providing any details.`),w.method,qe)}}else U(new Y.ResponseError(Y.ErrorCodes.MethodNotFound,`Unhandled method ${w.method}`),w.method,qe)}function Rn(w){if(!$t())if(w.id===null)w.error?i.error(`Received response message without id: Error is: 
${JSON.stringify(w.error,void 0,4)}`):i.error("Received response message without id. No further error information provided.");else{let q=w.id,U=E.get(q);if(An(w,U),U!==void 0){E.delete(q);try{if(w.error){let K=w.error;U.reject(new Y.ResponseError(K.code,K.message,K.data))}else if(w.result!==void 0)U.resolve(w.result);else throw new Error("Should never happen.")}catch(K){K.message?i.error(`Response handler '${U.method}' failed with message: ${K.message}`):i.error(`Response handler '${U.method}' failed unexpectedly.`)}}}}function Sn(w){if($t())return;let q,U;if(w.method===$i.type.method){let K=w.params.id;L.delete(K),fn(w);return}else{let K=g.get(w.method);K&&(U=K.handler,q=K.type)}if(U||m)try{if(fn(w),U)if(w.params===void 0)q!==void 0&&q.numberOfParams!==0&&q.parameterStructures!==Y.ParameterStructures.byName&&i.error(`Notification ${w.method} defines ${q.numberOfParams} params but received none.`),U();else if(Array.isArray(w.params)){let K=w.params;w.method===Ni.type.method&&K.length===2&&xc.is(K[0])?U({token:K[0],value:K[1]}):(q!==void 0&&(q.parameterStructures===Y.ParameterStructures.byName&&i.error(`Notification ${w.method} defines parameters by name but received parameters by position`),q.numberOfParams!==w.params.length&&i.error(`Notification ${w.method} defines ${q.numberOfParams} params but received ${K.length} arguments`)),U(...K))}else q!==void 0&&q.parameterStructures===Y.ParameterStructures.byPosition&&i.error(`Notification ${w.method} defines parameters by position but received parameters by name`),U(w.params);else m&&m(w.method,w.params)}catch(K){K.message?i.error(`Notification handler '${w.method}' failed with message: ${K.message}`):i.error(`Notification handler '${w.method}' failed unexpectedly.`)}else de.fire(w)}function Nn(w){if(!w){i.error("Received empty message.");return}i.error(`Received message which is neither a response nor a notification message:
${JSON.stringify(w,null,4)}`);let q=w;if(Be.string(q.id)||Be.number(q.id)){let U=q.id,K=E.get(U);K&&K.reject(new Error("The received response has neither a result nor an error property."))}}function ct(w){if(w!=null)switch(M){case _e.Verbose:return JSON.stringify(w,null,4);case _e.Compact:return JSON.stringify(w);default:return}}function Gn(w){if(!(M===_e.Off||!J))if(H===tn.Text){let q;(M===_e.Verbose||M===_e.Compact)&&w.params&&(q=`Params: ${ct(w.params)}

`),J.log(`Sending request '${w.method} - (${w.id})'.`,q)}else st("send-request",w)}function Dn(w){if(!(M===_e.Off||!J))if(H===tn.Text){let q;(M===_e.Verbose||M===_e.Compact)&&(w.params?q=`Params: ${ct(w.params)}

`:q=`No parameters provided.

`),J.log(`Sending notification '${w.method}'.`,q)}else st("send-notification",w)}function ln(w,q,U){if(!(M===_e.Off||!J))if(H===tn.Text){let K;(M===_e.Verbose||M===_e.Compact)&&(w.error&&w.error.data?K=`Error data: ${ct(w.error.data)}

`:w.result?K=`Result: ${ct(w.result)}

`:w.error===void 0&&(K=`No result returned.

`)),J.log(`Sending response '${q} - (${w.id})'. Processing request took ${Date.now()-U}ms`,K)}else st("send-response",w)}function dr(w){if(!(M===_e.Off||!J))if(H===tn.Text){let q;(M===_e.Verbose||M===_e.Compact)&&w.params&&(q=`Params: ${ct(w.params)}

`),J.log(`Received request '${w.method} - (${w.id})'.`,q)}else st("receive-request",w)}function fn(w){if(!(M===_e.Off||!J||w.method===Fs.type.method))if(H===tn.Text){let q;(M===_e.Verbose||M===_e.Compact)&&(w.params?q=`Params: ${ct(w.params)}

`:q=`No parameters provided.

`),J.log(`Received notification '${w.method}'.`,q)}else st("receive-notification",w)}function An(w,q){if(!(M===_e.Off||!J))if(H===tn.Text){let U;if((M===_e.Verbose||M===_e.Compact)&&(w.error&&w.error.data?U=`Error data: ${ct(w.error.data)}

`:w.result?U=`Result: ${ct(w.result)}

`:w.error===void 0&&(U=`No result returned.

`)),q){let K=w.error?` Request failed: ${w.error.message} (${w.error.code}).`:"";J.log(`Received response '${q.method} - (${w.id})' in ${Date.now()-q.timerStart}ms.${K}`,U)}else J.log(`Received response ${w.id} without active response promise.`,U)}else st("receive-response",w)}function st(w,q){if(!J||M===_e.Off)return;let U={isLSPMessage:!0,type:w,message:q,timestamp:Date.now()};J.log(U)}function Dt(){if(Ne())throw new ii(Ai.Closed,"Connection is closed.");if($t())throw new ii(Ai.Disposed,"Connection is disposed.")}function Ct(){if(Fn())throw new ii(Ai.AlreadyListening,"Connection is already listening")}function Zt(){if(!Fn())throw new Error("Call listen() first.")}function jt(w){return w===void 0?null:w}function $n(w){if(w!==null)return w}function Xn(w){return w!=null&&!Array.isArray(w)&&typeof w=="object"}function _n(w,q){switch(w){case Y.ParameterStructures.auto:return Xn(q)?$n(q):[jt(q)];case Y.ParameterStructures.byName:if(!Xn(q))throw new Error("Received parameters by name but param is not an object literal.");return $n(q);case Y.ParameterStructures.byPosition:return[jt(q)];default:throw new Error(`Unknown parameter structure ${w.toString()}`)}}function Jn(w,q){let U,K=w.numberOfParams;switch(K){case 0:U=void 0;break;case 1:U=_n(w.parameterStructures,q[0]);break;default:U=[];for(let Ce=0;Ce<q.length&&Ce<K;Ce++)U.push(jt(q[Ce]));if(q.length<K)for(let Ce=q.length;Ce<K;Ce++)U.push(null);break}return U}let Lt={sendNotification:(w,...q)=>{Dt();let U,K;if(Be.string(w)){U=w;let be=q[0],Pe=0,qe=Y.ParameterStructures.auto;Y.ParameterStructures.is(be)&&(Pe=1,qe=be);let ce=q.length,Se=ce-Pe;switch(Se){case 0:K=void 0;break;case 1:K=_n(qe,q[Pe]);break;default:if(qe===Y.ParameterStructures.byName)throw new Error(`Received ${Se} parameters for 'by Name' notification parameter structure.`);K=q.slice(Pe,ce).map(ge=>jt(ge));break}}else{let be=q;U=w.method,K=Jn(w,be)}let Ce={jsonrpc:u,method:U,params:K};return Dn(Ce),e.write(Ce).catch(be=>{throw i.error("Sending notification failed."),be})},onNotification:(w,q)=>{Dt();let U;return Be.func(w)?m=w:q&&(Be.string(w)?(U=w,g.set(w,{type:void 0,handler:q})):(U=w.method,g.set(w.method,{type:w,handler:q}))),{dispose:()=>{U!==void 0?g.delete(U):m=void 0}}},onProgress:(w,q,U)=>{if(S.has(q))throw new Error(`Progress handler for token ${q} already registered`);return S.set(q,U),{dispose:()=>{S.delete(q)}}},sendProgress:(w,q,U)=>Lt.sendNotification(Ni.type,{token:q,value:U}),onUnhandledProgress:it.event,sendRequest:(w,...q)=>{Dt(),Zt();let U,K,Ce;if(Be.string(w)){U=w;let ce=q[0],Se=q[q.length-1],ge=0,Fe=Y.ParameterStructures.auto;Y.ParameterStructures.is(ce)&&(ge=1,Fe=ce);let Ze=q.length;Ec.CancellationToken.is(Se)&&(Ze=Ze-1,Ce=Se);let ft=Ze-ge;switch(ft){case 0:K=void 0;break;case 1:K=_n(Fe,q[ge]);break;default:if(Fe===Y.ParameterStructures.byName)throw new Error(`Received ${ft} parameters for 'by Name' request parameter structure.`);K=q.slice(ge,Ze).map(lr=>jt(lr));break}}else{let ce=q;U=w.method,K=Jn(w,ce);let Se=w.numberOfParams;Ce=Ec.CancellationToken.is(ce[Se])?ce[Se]:void 0}let be=s++,Pe;Ce&&(Pe=Ce.onCancellationRequested(()=>{let ce=at.sender.sendCancellation(Lt,be);return ce===void 0?(i.log(`Received no promise from cancellation strategy when cancelling id ${be}`),Promise.resolve()):ce.catch(()=>{i.log(`Sending cancellation messages for id ${be} failed`)})}));let qe={jsonrpc:u,id:be,method:U,params:K};return Gn(qe),typeof at.sender.enableCancellation=="function"&&at.sender.enableCancellation(qe),new Promise(async(ce,Se)=>{let ge=ft=>{ce(ft),at.sender.cleanup(be),Pe?.dispose()},Fe=ft=>{Se(ft),at.sender.cleanup(be),Pe?.dispose()},Ze={method:U,timerStart:Date.now(),resolve:ge,reject:Fe};try{await e.write(qe),E.set(be,Ze)}catch(ft){throw i.error("Sending request failed."),Ze.reject(new Y.ResponseError(Y.ErrorCodes.MessageWriteError,ft.message?ft.message:"Unknown reason")),ft}})},onRequest:(w,q)=>{Dt();let U=null;return qc.is(w)?(U=void 0,d=w):Be.string(w)?(U=null,q!==void 0&&(U=w,p.set(w,{handler:q,type:void 0}))):q!==void 0&&(U=w.method,p.set(w.method,{type:w,handler:q})),{dispose:()=>{U!==null&&(U!==void 0?p.delete(U):d=void 0)}}},hasPendingResponse:()=>E.size>0,trace:async(w,q,U)=>{let K=!1,Ce=tn.Text;U!==void 0&&(Be.boolean(U)?K=U:(K=U.sendNotification||!1,Ce=U.traceFormat||tn.Text)),M=w,H=Ce,M===_e.Off?J=void 0:J=q,K&&!Ne()&&!$t()&&await Lt.sendNotification(Fc.type,{value:_e.toString(w)})},onError:G.event,onClose:ee.event,onUnhandledNotification:de.event,onDispose:Ye.event,end:()=>{e.end()},dispose:()=>{if($t())return;pe=Pn.Disposed,Ye.fire(void 0);let w=new Y.ResponseError(Y.ErrorCodes.PendingResponseRejected,"Pending response rejected since connection got disposed");for(let q of E.values())q.reject(w);E=new Map,N=new Map,L=new Set,P=new eh.LinkedMap,Be.func(e.dispose)&&e.dispose(),Be.func(r.dispose)&&r.dispose()},listen:()=>{Dt(),Ct(),pe=Pn.Listening,r.listen(ur)},inspect:()=>{(0,Zf.default)().console.log("inspect")}};return Lt.onNotification(Fs.type,w=>{if(M===_e.Off||!J)return;let q=M===_e.Verbose||M===_e.Compact;J.log(w.message,q?w.verbose:void 0)}),Lt.onNotification(Ni.type,w=>{let q=S.get(w.token);q?q(w.value):it.fire(w)}),Lt}se.createMessageConnection=nw});var $s=x(I=>{"use strict";Object.defineProperty(I,"__esModule",{value:!0});I.ProgressType=I.ProgressToken=I.createMessageConnection=I.NullLogger=I.ConnectionOptions=I.ConnectionStrategy=I.AbstractMessageBuffer=I.WriteableStreamMessageWriter=I.AbstractMessageWriter=I.MessageWriter=I.ReadableStreamMessageReader=I.AbstractMessageReader=I.MessageReader=I.SharedArrayReceiverStrategy=I.SharedArraySenderStrategy=I.CancellationToken=I.CancellationTokenSource=I.Emitter=I.Event=I.Disposable=I.LRUCache=I.Touch=I.LinkedMap=I.ParameterStructures=I.NotificationType9=I.NotificationType8=I.NotificationType7=I.NotificationType6=I.NotificationType5=I.NotificationType4=I.NotificationType3=I.NotificationType2=I.NotificationType1=I.NotificationType0=I.NotificationType=I.ErrorCodes=I.ResponseError=I.RequestType9=I.RequestType8=I.RequestType7=I.RequestType6=I.RequestType5=I.RequestType4=I.RequestType3=I.RequestType2=I.RequestType1=I.RequestType0=I.RequestType=I.Message=I.RAL=void 0;I.MessageStrategy=I.CancellationStrategy=I.CancellationSenderStrategy=I.CancellationReceiverStrategy=I.ConnectionError=I.ConnectionErrors=I.LogTraceNotification=I.SetTraceNotification=I.TraceFormat=I.TraceValues=I.Trace=void 0;var Ae=ac();Object.defineProperty(I,"Message",{enumerable:!0,get:function(){return Ae.Message}});Object.defineProperty(I,"RequestType",{enumerable:!0,get:function(){return Ae.RequestType}});Object.defineProperty(I,"RequestType0",{enumerable:!0,get:function(){return Ae.RequestType0}});Object.defineProperty(I,"RequestType1",{enumerable:!0,get:function(){return Ae.RequestType1}});Object.defineProperty(I,"RequestType2",{enumerable:!0,get:function(){return Ae.RequestType2}});Object.defineProperty(I,"RequestType3",{enumerable:!0,get:function(){return Ae.RequestType3}});Object.defineProperty(I,"RequestType4",{enumerable:!0,get:function(){return Ae.RequestType4}});Object.defineProperty(I,"RequestType5",{enumerable:!0,get:function(){return Ae.RequestType5}});Object.defineProperty(I,"RequestType6",{enumerable:!0,get:function(){return Ae.RequestType6}});Object.defineProperty(I,"RequestType7",{enumerable:!0,get:function(){return Ae.RequestType7}});Object.defineProperty(I,"RequestType8",{enumerable:!0,get:function(){return Ae.RequestType8}});Object.defineProperty(I,"RequestType9",{enumerable:!0,get:function(){return Ae.RequestType9}});Object.defineProperty(I,"ResponseError",{enumerable:!0,get:function(){return Ae.ResponseError}});Object.defineProperty(I,"ErrorCodes",{enumerable:!0,get:function(){return Ae.ErrorCodes}});Object.defineProperty(I,"NotificationType",{enumerable:!0,get:function(){return Ae.NotificationType}});Object.defineProperty(I,"NotificationType0",{enumerable:!0,get:function(){return Ae.NotificationType0}});Object.defineProperty(I,"NotificationType1",{enumerable:!0,get:function(){return Ae.NotificationType1}});Object.defineProperty(I,"NotificationType2",{enumerable:!0,get:function(){return Ae.NotificationType2}});Object.defineProperty(I,"NotificationType3",{enumerable:!0,get:function(){return Ae.NotificationType3}});Object.defineProperty(I,"NotificationType4",{enumerable:!0,get:function(){return Ae.NotificationType4}});Object.defineProperty(I,"NotificationType5",{enumerable:!0,get:function(){return Ae.NotificationType5}});Object.defineProperty(I,"NotificationType6",{enumerable:!0,get:function(){return Ae.NotificationType6}});Object.defineProperty(I,"NotificationType7",{enumerable:!0,get:function(){return Ae.NotificationType7}});Object.defineProperty(I,"NotificationType8",{enumerable:!0,get:function(){return Ae.NotificationType8}});Object.defineProperty(I,"NotificationType9",{enumerable:!0,get:function(){return Ae.NotificationType9}});Object.defineProperty(I,"ParameterStructures",{enumerable:!0,get:function(){return Ae.ParameterStructures}});var Mc=uc();Object.defineProperty(I,"LinkedMap",{enumerable:!0,get:function(){return Mc.LinkedMap}});Object.defineProperty(I,"LRUCache",{enumerable:!0,get:function(){return Mc.LRUCache}});Object.defineProperty(I,"Touch",{enumerable:!0,get:function(){return Mc.Touch}});var rw=Hf();Object.defineProperty(I,"Disposable",{enumerable:!0,get:function(){return rw.Disposable}});var ih=ei();Object.defineProperty(I,"Event",{enumerable:!0,get:function(){return ih.Event}});Object.defineProperty(I,"Emitter",{enumerable:!0,get:function(){return ih.Emitter}});var sh=ks();Object.defineProperty(I,"CancellationTokenSource",{enumerable:!0,get:function(){return sh.CancellationTokenSource}});Object.defineProperty(I,"CancellationToken",{enumerable:!0,get:function(){return sh.CancellationToken}});var oh=Kf();Object.defineProperty(I,"SharedArraySenderStrategy",{enumerable:!0,get:function(){return oh.SharedArraySenderStrategy}});Object.defineProperty(I,"SharedArrayReceiverStrategy",{enumerable:!0,get:function(){return oh.SharedArrayReceiverStrategy}});var Nc=zf();Object.defineProperty(I,"MessageReader",{enumerable:!0,get:function(){return Nc.MessageReader}});Object.defineProperty(I,"AbstractMessageReader",{enumerable:!0,get:function(){return Nc.AbstractMessageReader}});Object.defineProperty(I,"ReadableStreamMessageReader",{enumerable:!0,get:function(){return Nc.ReadableStreamMessageReader}});var Ac=Qf();Object.defineProperty(I,"MessageWriter",{enumerable:!0,get:function(){return Ac.MessageWriter}});Object.defineProperty(I,"AbstractMessageWriter",{enumerable:!0,get:function(){return Ac.AbstractMessageWriter}});Object.defineProperty(I,"WriteableStreamMessageWriter",{enumerable:!0,get:function(){return Ac.WriteableStreamMessageWriter}});var iw=Yf();Object.defineProperty(I,"AbstractMessageBuffer",{enumerable:!0,get:function(){return iw.AbstractMessageBuffer}});var St=rh();Object.defineProperty(I,"ConnectionStrategy",{enumerable:!0,get:function(){return St.ConnectionStrategy}});Object.defineProperty(I,"ConnectionOptions",{enumerable:!0,get:function(){return St.ConnectionOptions}});Object.defineProperty(I,"NullLogger",{enumerable:!0,get:function(){return St.NullLogger}});Object.defineProperty(I,"createMessageConnection",{enumerable:!0,get:function(){return St.createMessageConnection}});Object.defineProperty(I,"ProgressToken",{enumerable:!0,get:function(){return St.ProgressToken}});Object.defineProperty(I,"ProgressType",{enumerable:!0,get:function(){return St.ProgressType}});Object.defineProperty(I,"Trace",{enumerable:!0,get:function(){return St.Trace}});Object.defineProperty(I,"TraceValues",{enumerable:!0,get:function(){return St.TraceValues}});Object.defineProperty(I,"TraceFormat",{enumerable:!0,get:function(){return St.TraceFormat}});Object.defineProperty(I,"SetTraceNotification",{enumerable:!0,get:function(){return St.SetTraceNotification}});Object.defineProperty(I,"LogTraceNotification",{enumerable:!0,get:function(){return St.LogTraceNotification}});Object.defineProperty(I,"ConnectionErrors",{enumerable:!0,get:function(){return St.ConnectionErrors}});Object.defineProperty(I,"ConnectionError",{enumerable:!0,get:function(){return St.ConnectionError}});Object.defineProperty(I,"CancellationReceiverStrategy",{enumerable:!0,get:function(){return St.CancellationReceiverStrategy}});Object.defineProperty(I,"CancellationSenderStrategy",{enumerable:!0,get:function(){return St.CancellationSenderStrategy}});Object.defineProperty(I,"CancellationStrategy",{enumerable:!0,get:function(){return St.CancellationStrategy}});Object.defineProperty(I,"MessageStrategy",{enumerable:!0,get:function(){return St.MessageStrategy}});var sw=pr();I.RAL=sw.default});var uh=x(Hc=>{"use strict";Object.defineProperty(Hc,"__esModule",{value:!0});var ah=require("util"),Qn=$s(),js=class r extends Qn.AbstractMessageBuffer{constructor(e="utf-8"){super(e)}emptyBuffer(){return r.emptyBuffer}fromString(e,t){return Buffer.from(e,t)}toString(e,t){return e instanceof Buffer?e.toString(t):new ah.TextDecoder(t).decode(e)}asNative(e,t){return t===void 0?e instanceof Buffer?e:Buffer.from(e):e instanceof Buffer?e.slice(0,t):Buffer.from(e,0,t)}allocNative(e){return Buffer.allocUnsafe(e)}};js.emptyBuffer=Buffer.allocUnsafe(0);var $c=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Qn.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Qn.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Qn.Disposable.create(()=>this.stream.off("end",e))}onData(e){return this.stream.on("data",e),Qn.Disposable.create(()=>this.stream.off("data",e))}},jc=class{constructor(e){this.stream=e}onClose(e){return this.stream.on("close",e),Qn.Disposable.create(()=>this.stream.off("close",e))}onError(e){return this.stream.on("error",e),Qn.Disposable.create(()=>this.stream.off("error",e))}onEnd(e){return this.stream.on("end",e),Qn.Disposable.create(()=>this.stream.off("end",e))}write(e,t){return new Promise((n,i)=>{let s=o=>{o==null?n():i(o)};typeof e=="string"?this.stream.write(e,t,s):this.stream.write(e,s)})}end(){this.stream.end()}},ch=Object.freeze({messageBuffer:Object.freeze({create:r=>new js(r)}),applicationJson:Object.freeze({encoder:Object.freeze({name:"application/json",encode:(r,e)=>{try{return Promise.resolve(Buffer.from(JSON.stringify(r,void 0,0),e.charset))}catch(t){return Promise.reject(t)}}}),decoder:Object.freeze({name:"application/json",decode:(r,e)=>{try{return r instanceof Buffer?Promise.resolve(JSON.parse(r.toString(e.charset))):Promise.resolve(JSON.parse(new ah.TextDecoder(e.charset).decode(r)))}catch(t){return Promise.reject(t)}}})}),stream:Object.freeze({asReadableStream:r=>new $c(r),asWritableStream:r=>new jc(r)}),console,timer:Object.freeze({setTimeout(r,e,...t){let n=setTimeout(r,e,...t);return{dispose:()=>clearTimeout(n)}},setImmediate(r,...e){let t=setImmediate(r,...e);return{dispose:()=>clearImmediate(t)}},setInterval(r,e,...t){let n=setInterval(r,e,...t);return{dispose:()=>clearInterval(n)}}})});function Uc(){return ch}(function(r){function e(){Qn.RAL.install(ch)}r.install=e})(Uc||(Uc={}));Hc.default=Uc});var Lr=x(ye=>{"use strict";var ow=ye&&ye.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),aw=ye&&ye.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ow(e,r,t)};Object.defineProperty(ye,"__esModule",{value:!0});ye.createMessageConnection=ye.createServerSocketTransport=ye.createClientSocketTransport=ye.createServerPipeTransport=ye.createClientPipeTransport=ye.generateRandomPipeName=ye.StreamMessageWriter=ye.StreamMessageReader=ye.SocketMessageWriter=ye.SocketMessageReader=ye.PortMessageWriter=ye.PortMessageReader=ye.IPCMessageWriter=ye.IPCMessageReader=void 0;var si=uh();si.default.install();var dh=require("path"),cw=require("os"),uw=require("crypto"),Ws=require("net"),nn=$s();aw($s(),ye);var Wc=class extends nn.AbstractMessageReader{constructor(e){super(),this.process=e;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose())}listen(e){return this.process.on("message",e),nn.Disposable.create(()=>this.process.off("message",e))}};ye.IPCMessageReader=Wc;var Kc=class extends nn.AbstractMessageWriter{constructor(e){super(),this.process=e,this.errorCount=0;let t=this.process;t.on("error",n=>this.fireError(n)),t.on("close",()=>this.fireClose)}write(e){try{return typeof this.process.send=="function"&&this.process.send(e,void 0,void 0,t=>{t?(this.errorCount++,this.handleError(t,e)):this.errorCount=0}),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};ye.IPCMessageWriter=Kc;var Vc=class extends nn.AbstractMessageReader{constructor(e){super(),this.onData=new nn.Emitter,e.on("close",()=>this.fireClose),e.on("error",t=>this.fireError(t)),e.on("message",t=>{this.onData.fire(t)})}listen(e){return this.onData.event(e)}};ye.PortMessageReader=Vc;var zc=class extends nn.AbstractMessageWriter{constructor(e){super(),this.port=e,this.errorCount=0,e.on("close",()=>this.fireClose()),e.on("error",t=>this.fireError(t))}write(e){try{return this.port.postMessage(e),Promise.resolve()}catch(t){return this.handleError(t,e),Promise.reject(t)}}handleError(e,t){this.errorCount++,this.fireError(e,t,this.errorCount)}end(){}};ye.PortMessageWriter=zc;var Fr=class extends nn.ReadableStreamMessageReader{constructor(e,t="utf-8"){super((0,si.default)().stream.asReadableStream(e),t)}};ye.SocketMessageReader=Fr;var Or=class extends nn.WriteableStreamMessageWriter{constructor(e,t){super((0,si.default)().stream.asWritableStream(e),t),this.socket=e}dispose(){super.dispose(),this.socket.destroy()}};ye.SocketMessageWriter=Or;var Us=class extends nn.ReadableStreamMessageReader{constructor(e,t){super((0,si.default)().stream.asReadableStream(e),t)}};ye.StreamMessageReader=Us;var Hs=class extends nn.WriteableStreamMessageWriter{constructor(e,t){super((0,si.default)().stream.asWritableStream(e),t)}};ye.StreamMessageWriter=Hs;var lh=process.env.XDG_RUNTIME_DIR,dw=new Map([["linux",107],["darwin",103]]);function lw(){let r=(0,uw.randomBytes)(21).toString("hex");if(process.platform==="win32")return`\\\\.\\pipe\\vscode-jsonrpc-${r}-sock`;let e;lh?e=dh.join(lh,`vscode-ipc-${r}.sock`):e=dh.join(cw.tmpdir(),`vscode-${r}.sock`);let t=dw.get(process.platform);return t!==void 0&&e.length>t&&(0,si.default)().console.warn(`WARNING: IPC handle "${e}" is longer than ${t} characters.`),e}ye.generateRandomPipeName=lw;function fw(r,e="utf-8"){let t,n=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ws.createServer)(a=>{o.close(),t([new Fr(a,e),new Or(a,e)])});o.on("error",s),o.listen(r,()=>{o.removeListener("error",s),i({onConnected:()=>n})})})}ye.createClientPipeTransport=fw;function hw(r,e="utf-8"){let t=(0,Ws.createConnection)(r);return[new Fr(t,e),new Or(t,e)]}ye.createServerPipeTransport=hw;function pw(r,e="utf-8"){let t,n=new Promise((i,s)=>{t=i});return new Promise((i,s)=>{let o=(0,Ws.createServer)(a=>{o.close(),t([new Fr(a,e),new Or(a,e)])});o.on("error",s),o.listen(r,"127.0.0.1",()=>{o.removeListener("error",s),i({onConnected:()=>n})})})}ye.createClientSocketTransport=pw;function gw(r,e="utf-8"){let t=(0,Ws.createConnection)(r,"127.0.0.1");return[new Fr(t,e),new Or(t,e)]}ye.createServerSocketTransport=gw;function mw(r){let e=r;return e.read!==void 0&&e.addListener!==void 0}function vw(r){let e=r;return e.write!==void 0&&e.addListener!==void 0}function yw(r,e,t,n){t||(t=nn.NullLogger);let i=mw(r)?new Us(r):r,s=vw(e)?new Hs(e):e;return nn.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,nn.createMessageConnection)(i,s,t,n)}ye.createMessageConnection=yw});var Bc=x((d_,fh)=>{"use strict";fh.exports=Lr()});var Vs=x((hh,Ks)=>{(function(r){if(typeof Ks=="object"&&typeof Ks.exports=="object"){var e=r(require,hh);e!==void 0&&(Ks.exports=e)}else typeof define=="function"&&define.amd&&define(["require","exports"],r)})(function(r,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.TextDocument=e.EOL=e.WorkspaceFolder=e.InlineCompletionContext=e.SelectedCompletionInfo=e.InlineCompletionTriggerKind=e.InlineCompletionList=e.InlineCompletionItem=e.StringValue=e.InlayHint=e.InlayHintLabelPart=e.InlayHintKind=e.InlineValueContext=e.InlineValueEvaluatableExpression=e.InlineValueVariableLookup=e.InlineValueText=e.SemanticTokens=e.SemanticTokenModifiers=e.SemanticTokenTypes=e.SelectionRange=e.DocumentLink=e.FormattingOptions=e.CodeLens=e.CodeAction=e.CodeActionContext=e.CodeActionTriggerKind=e.CodeActionKind=e.DocumentSymbol=e.WorkspaceSymbol=e.SymbolInformation=e.SymbolTag=e.SymbolKind=e.DocumentHighlight=e.DocumentHighlightKind=e.SignatureInformation=e.ParameterInformation=e.Hover=e.MarkedString=e.CompletionList=e.CompletionItem=e.CompletionItemLabelDetails=e.InsertTextMode=e.InsertReplaceEdit=e.CompletionItemTag=e.InsertTextFormat=e.CompletionItemKind=e.MarkupContent=e.MarkupKind=e.TextDocumentItem=e.OptionalVersionedTextDocumentIdentifier=e.VersionedTextDocumentIdentifier=e.TextDocumentIdentifier=e.WorkspaceChange=e.WorkspaceEdit=e.DeleteFile=e.RenameFile=e.CreateFile=e.TextDocumentEdit=e.AnnotatedTextEdit=e.ChangeAnnotationIdentifier=e.ChangeAnnotation=e.TextEdit=e.Command=e.Diagnostic=e.CodeDescription=e.DiagnosticTag=e.DiagnosticSeverity=e.DiagnosticRelatedInformation=e.FoldingRange=e.FoldingRangeKind=e.ColorPresentation=e.ColorInformation=e.Color=e.LocationLink=e.Location=e.Range=e.Position=e.uinteger=e.integer=e.URI=e.DocumentUri=void 0;var t;(function(h){function C(R){return typeof R=="string"}h.is=C})(t||(e.DocumentUri=t={}));var n;(function(h){function C(R){return typeof R=="string"}h.is=C})(n||(e.URI=n={}));var i;(function(h){h.MIN_VALUE=-2147483648,h.MAX_VALUE=2147483647;function C(R){return typeof R=="number"&&h.MIN_VALUE<=R&&R<=h.MAX_VALUE}h.is=C})(i||(e.integer=i={}));var s;(function(h){h.MIN_VALUE=0,h.MAX_VALUE=2147483647;function C(R){return typeof R=="number"&&h.MIN_VALUE<=R&&R<=h.MAX_VALUE}h.is=C})(s||(e.uinteger=s={}));var o;(function(h){function C(v,l){return v===Number.MAX_VALUE&&(v=s.MAX_VALUE),l===Number.MAX_VALUE&&(l=s.MAX_VALUE),{line:v,character:l}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&_.uinteger(l.line)&&_.uinteger(l.character)}h.is=R})(o||(e.Position=o={}));var a;(function(h){function C(v,l,T,F){if(_.uinteger(v)&&_.uinteger(l)&&_.uinteger(T)&&_.uinteger(F))return{start:o.create(v,l),end:o.create(T,F)};if(o.is(v)&&o.is(l))return{start:v,end:l};throw new Error("Range#create called with invalid arguments[".concat(v,", ").concat(l,", ").concat(T,", ").concat(F,"]"))}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&o.is(l.start)&&o.is(l.end)}h.is=R})(a||(e.Range=a={}));var u;(function(h){function C(v,l){return{uri:v,range:l}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&a.is(l.range)&&(_.string(l.uri)||_.undefined(l.uri))}h.is=R})(u||(e.Location=u={}));var d;(function(h){function C(v,l,T,F){return{targetUri:v,targetRange:l,targetSelectionRange:T,originSelectionRange:F}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&a.is(l.targetRange)&&_.string(l.targetUri)&&a.is(l.targetSelectionRange)&&(a.is(l.originSelectionRange)||_.undefined(l.originSelectionRange))}h.is=R})(d||(e.LocationLink=d={}));var p;(function(h){function C(v,l,T,F){return{red:v,green:l,blue:T,alpha:F}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&_.numberRange(l.red,0,1)&&_.numberRange(l.green,0,1)&&_.numberRange(l.blue,0,1)&&_.numberRange(l.alpha,0,1)}h.is=R})(p||(e.Color=p={}));var m;(function(h){function C(v,l){return{range:v,color:l}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&a.is(l.range)&&p.is(l.color)}h.is=R})(m||(e.ColorInformation=m={}));var g;(function(h){function C(v,l,T){return{label:v,textEdit:l,additionalTextEdits:T}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&_.string(l.label)&&(_.undefined(l.textEdit)||J.is(l))&&(_.undefined(l.additionalTextEdits)||_.typedArray(l.additionalTextEdits,J.is))}h.is=R})(g||(e.ColorPresentation=g={}));var S;(function(h){h.Comment="comment",h.Imports="imports",h.Region="region"})(S||(e.FoldingRangeKind=S={}));var y;(function(h){function C(v,l,T,F,ne,He){var Oe={startLine:v,endLine:l};return _.defined(T)&&(Oe.startCharacter=T),_.defined(F)&&(Oe.endCharacter=F),_.defined(ne)&&(Oe.kind=ne),_.defined(He)&&(Oe.collapsedText=He),Oe}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&_.uinteger(l.startLine)&&_.uinteger(l.startLine)&&(_.undefined(l.startCharacter)||_.uinteger(l.startCharacter))&&(_.undefined(l.endCharacter)||_.uinteger(l.endCharacter))&&(_.undefined(l.kind)||_.string(l.kind))}h.is=R})(y||(e.FoldingRange=y={}));var P;(function(h){function C(v,l){return{location:v,message:l}}h.create=C;function R(v){var l=v;return _.defined(l)&&u.is(l.location)&&_.string(l.message)}h.is=R})(P||(e.DiagnosticRelatedInformation=P={}));var E;(function(h){h.Error=1,h.Warning=2,h.Information=3,h.Hint=4})(E||(e.DiagnosticSeverity=E={}));var L;(function(h){h.Unnecessary=1,h.Deprecated=2})(L||(e.DiagnosticTag=L={}));var N;(function(h){function C(R){var v=R;return _.objectLiteral(v)&&_.string(v.href)}h.is=C})(N||(e.CodeDescription=N={}));var M;(function(h){function C(v,l,T,F,ne,He){var Oe={range:v,message:l};return _.defined(T)&&(Oe.severity=T),_.defined(F)&&(Oe.code=F),_.defined(ne)&&(Oe.source=ne),_.defined(He)&&(Oe.relatedInformation=He),Oe}h.create=C;function R(v){var l,T=v;return _.defined(T)&&a.is(T.range)&&_.string(T.message)&&(_.number(T.severity)||_.undefined(T.severity))&&(_.integer(T.code)||_.string(T.code)||_.undefined(T.code))&&(_.undefined(T.codeDescription)||_.string((l=T.codeDescription)===null||l===void 0?void 0:l.href))&&(_.string(T.source)||_.undefined(T.source))&&(_.undefined(T.relatedInformation)||_.typedArray(T.relatedInformation,P.is))}h.is=R})(M||(e.Diagnostic=M={}));var H;(function(h){function C(v,l){for(var T=[],F=2;F<arguments.length;F++)T[F-2]=arguments[F];var ne={title:v,command:l};return _.defined(T)&&T.length>0&&(ne.arguments=T),ne}h.create=C;function R(v){var l=v;return _.defined(l)&&_.string(l.title)&&_.string(l.command)}h.is=R})(H||(e.Command=H={}));var J;(function(h){function C(T,F){return{range:T,newText:F}}h.replace=C;function R(T,F){return{range:{start:T,end:T},newText:F}}h.insert=R;function v(T){return{range:T,newText:""}}h.del=v;function l(T){var F=T;return _.objectLiteral(F)&&_.string(F.newText)&&a.is(F.range)}h.is=l})(J||(e.TextEdit=J={}));var pe;(function(h){function C(v,l,T){var F={label:v};return l!==void 0&&(F.needsConfirmation=l),T!==void 0&&(F.description=T),F}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&_.string(l.label)&&(_.boolean(l.needsConfirmation)||l.needsConfirmation===void 0)&&(_.string(l.description)||l.description===void 0)}h.is=R})(pe||(e.ChangeAnnotation=pe={}));var G;(function(h){function C(R){var v=R;return _.string(v)}h.is=C})(G||(e.ChangeAnnotationIdentifier=G={}));var ee;(function(h){function C(T,F,ne){return{range:T,newText:F,annotationId:ne}}h.replace=C;function R(T,F,ne){return{range:{start:T,end:T},newText:F,annotationId:ne}}h.insert=R;function v(T,F){return{range:T,newText:"",annotationId:F}}h.del=v;function l(T){var F=T;return J.is(F)&&(pe.is(F.annotationId)||G.is(F.annotationId))}h.is=l})(ee||(e.AnnotatedTextEdit=ee={}));var de;(function(h){function C(v,l){return{textDocument:v,edits:l}}h.create=C;function R(v){var l=v;return _.defined(l)&&Ne.is(l.textDocument)&&Array.isArray(l.edits)}h.is=R})(de||(e.TextDocumentEdit=de={}));var it;(function(h){function C(v,l,T){var F={kind:"create",uri:v};return l!==void 0&&(l.overwrite!==void 0||l.ignoreIfExists!==void 0)&&(F.options=l),T!==void 0&&(F.annotationId=T),F}h.create=C;function R(v){var l=v;return l&&l.kind==="create"&&_.string(l.uri)&&(l.options===void 0||(l.options.overwrite===void 0||_.boolean(l.options.overwrite))&&(l.options.ignoreIfExists===void 0||_.boolean(l.options.ignoreIfExists)))&&(l.annotationId===void 0||G.is(l.annotationId))}h.is=R})(it||(e.CreateFile=it={}));var Ye;(function(h){function C(v,l,T,F){var ne={kind:"rename",oldUri:v,newUri:l};return T!==void 0&&(T.overwrite!==void 0||T.ignoreIfExists!==void 0)&&(ne.options=T),F!==void 0&&(ne.annotationId=F),ne}h.create=C;function R(v){var l=v;return l&&l.kind==="rename"&&_.string(l.oldUri)&&_.string(l.newUri)&&(l.options===void 0||(l.options.overwrite===void 0||_.boolean(l.options.overwrite))&&(l.options.ignoreIfExists===void 0||_.boolean(l.options.ignoreIfExists)))&&(l.annotationId===void 0||G.is(l.annotationId))}h.is=R})(Ye||(e.RenameFile=Ye={}));var at;(function(h){function C(v,l,T){var F={kind:"delete",uri:v};return l!==void 0&&(l.recursive!==void 0||l.ignoreIfNotExists!==void 0)&&(F.options=l),T!==void 0&&(F.annotationId=T),F}h.create=C;function R(v){var l=v;return l&&l.kind==="delete"&&_.string(l.uri)&&(l.options===void 0||(l.options.recursive===void 0||_.boolean(l.options.recursive))&&(l.options.ignoreIfNotExists===void 0||_.boolean(l.options.ignoreIfNotExists)))&&(l.annotationId===void 0||G.is(l.annotationId))}h.is=R})(at||(e.DeleteFile=at={}));var dn;(function(h){function C(R){var v=R;return v&&(v.changes!==void 0||v.documentChanges!==void 0)&&(v.documentChanges===void 0||v.documentChanges.every(function(l){return _.string(l.kind)?it.is(l)||Ye.is(l)||at.is(l):de.is(l)}))}h.is=C})(dn||(e.WorkspaceEdit=dn={}));var Ft=function(){function h(C,R){this.edits=C,this.changeAnnotations=R}return h.prototype.insert=function(C,R,v){var l,T;if(v===void 0?l=J.insert(C,R):G.is(v)?(T=v,l=ee.insert(C,R,v)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(v),l=ee.insert(C,R,T)),this.edits.push(l),T!==void 0)return T},h.prototype.replace=function(C,R,v){var l,T;if(v===void 0?l=J.replace(C,R):G.is(v)?(T=v,l=ee.replace(C,R,v)):(this.assertChangeAnnotations(this.changeAnnotations),T=this.changeAnnotations.manage(v),l=ee.replace(C,R,T)),this.edits.push(l),T!==void 0)return T},h.prototype.delete=function(C,R){var v,l;if(R===void 0?v=J.del(C):G.is(R)?(l=R,v=ee.del(C,R)):(this.assertChangeAnnotations(this.changeAnnotations),l=this.changeAnnotations.manage(R),v=ee.del(C,l)),this.edits.push(v),l!==void 0)return l},h.prototype.add=function(C){this.edits.push(C)},h.prototype.all=function(){return this.edits},h.prototype.clear=function(){this.edits.splice(0,this.edits.length)},h.prototype.assertChangeAnnotations=function(C){if(C===void 0)throw new Error("Text edit change is not configured to manage change annotations.")},h}(),yt=function(){function h(C){this._annotations=C===void 0?Object.create(null):C,this._counter=0,this._size=0}return h.prototype.all=function(){return this._annotations},Object.defineProperty(h.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),h.prototype.manage=function(C,R){var v;if(G.is(C)?v=C:(v=this.nextId(),R=C),this._annotations[v]!==void 0)throw new Error("Id ".concat(v," is already in use."));if(R===void 0)throw new Error("No annotation provided for id ".concat(v));return this._annotations[v]=R,this._size++,v},h.prototype.nextId=function(){return this._counter++,this._counter.toString()},h}(),bt=function(){function h(C){var R=this;this._textEditChanges=Object.create(null),C!==void 0?(this._workspaceEdit=C,C.documentChanges?(this._changeAnnotations=new yt(C.changeAnnotations),C.changeAnnotations=this._changeAnnotations.all(),C.documentChanges.forEach(function(v){if(de.is(v)){var l=new Ft(v.edits,R._changeAnnotations);R._textEditChanges[v.textDocument.uri]=l}})):C.changes&&Object.keys(C.changes).forEach(function(v){var l=new Ft(C.changes[v]);R._textEditChanges[v]=l})):this._workspaceEdit={}}return Object.defineProperty(h.prototype,"edit",{get:function(){return this.initDocumentChanges(),this._changeAnnotations!==void 0&&(this._changeAnnotations.size===0?this._workspaceEdit.changeAnnotations=void 0:this._workspaceEdit.changeAnnotations=this._changeAnnotations.all()),this._workspaceEdit},enumerable:!1,configurable:!0}),h.prototype.getTextEditChange=function(C){if(Ne.is(C)){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var R={uri:C.uri,version:C.version},v=this._textEditChanges[R.uri];if(!v){var l=[],T={textDocument:R,edits:l};this._workspaceEdit.documentChanges.push(T),v=new Ft(l,this._changeAnnotations),this._textEditChanges[R.uri]=v}return v}else{if(this.initChanges(),this._workspaceEdit.changes===void 0)throw new Error("Workspace edit is not configured for normal text edit changes.");var v=this._textEditChanges[C];if(!v){var l=[];this._workspaceEdit.changes[C]=l,v=new Ft(l),this._textEditChanges[C]=v}return v}},h.prototype.initDocumentChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._changeAnnotations=new yt,this._workspaceEdit.documentChanges=[],this._workspaceEdit.changeAnnotations=this._changeAnnotations.all())},h.prototype.initChanges=function(){this._workspaceEdit.documentChanges===void 0&&this._workspaceEdit.changes===void 0&&(this._workspaceEdit.changes=Object.create(null))},h.prototype.createFile=function(C,R,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var l;pe.is(R)||G.is(R)?l=R:v=R;var T,F;if(l===void 0?T=it.create(C,v):(F=G.is(l)?l:this._changeAnnotations.manage(l),T=it.create(C,v,F)),this._workspaceEdit.documentChanges.push(T),F!==void 0)return F},h.prototype.renameFile=function(C,R,v,l){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var T;pe.is(v)||G.is(v)?T=v:l=v;var F,ne;if(T===void 0?F=Ye.create(C,R,l):(ne=G.is(T)?T:this._changeAnnotations.manage(T),F=Ye.create(C,R,l,ne)),this._workspaceEdit.documentChanges.push(F),ne!==void 0)return ne},h.prototype.deleteFile=function(C,R,v){if(this.initDocumentChanges(),this._workspaceEdit.documentChanges===void 0)throw new Error("Workspace edit is not configured for document changes.");var l;pe.is(R)||G.is(R)?l=R:v=R;var T,F;if(l===void 0?T=at.create(C,v):(F=G.is(l)?l:this._changeAnnotations.manage(l),T=at.create(C,v,F)),this._workspaceEdit.documentChanges.push(T),F!==void 0)return F},h}();e.WorkspaceChange=bt;var Cn;(function(h){function C(v){return{uri:v}}h.create=C;function R(v){var l=v;return _.defined(l)&&_.string(l.uri)}h.is=R})(Cn||(e.TextDocumentIdentifier=Cn={}));var Fn;(function(h){function C(v,l){return{uri:v,version:l}}h.create=C;function R(v){var l=v;return _.defined(l)&&_.string(l.uri)&&_.integer(l.version)}h.is=R})(Fn||(e.VersionedTextDocumentIdentifier=Fn={}));var Ne;(function(h){function C(v,l){return{uri:v,version:l}}h.create=C;function R(v){var l=v;return _.defined(l)&&_.string(l.uri)&&(l.version===null||_.integer(l.version))}h.is=R})(Ne||(e.OptionalVersionedTextDocumentIdentifier=Ne={}));var $t;(function(h){function C(v,l,T,F){return{uri:v,languageId:l,version:T,text:F}}h.create=C;function R(v){var l=v;return _.defined(l)&&_.string(l.uri)&&_.string(l.languageId)&&_.integer(l.version)&&_.string(l.text)}h.is=R})($t||(e.TextDocumentItem=$t={}));var Ot;(function(h){h.PlainText="plaintext",h.Markdown="markdown";function C(R){var v=R;return v===h.PlainText||v===h.Markdown}h.is=C})(Ot||(e.MarkupKind=Ot={}));var wt;(function(h){function C(R){var v=R;return _.objectLiteral(R)&&Ot.is(v.kind)&&_.string(v.value)}h.is=C})(wt||(e.MarkupContent=wt={}));var cr;(function(h){h.Text=1,h.Method=2,h.Function=3,h.Constructor=4,h.Field=5,h.Variable=6,h.Class=7,h.Interface=8,h.Module=9,h.Property=10,h.Unit=11,h.Value=12,h.Enum=13,h.Keyword=14,h.Snippet=15,h.Color=16,h.File=17,h.Reference=18,h.Folder=19,h.EnumMember=20,h.Constant=21,h.Struct=22,h.Event=23,h.Operator=24,h.TypeParameter=25})(cr||(e.CompletionItemKind=cr={}));var On;(function(h){h.PlainText=1,h.Snippet=2})(On||(e.InsertTextFormat=On={}));var Ln;(function(h){h.Deprecated=1})(Ln||(e.CompletionItemTag=Ln={}));var Bn;(function(h){function C(v,l,T){return{newText:v,insert:l,replace:T}}h.create=C;function R(v){var l=v;return l&&_.string(l.newText)&&a.is(l.insert)&&a.is(l.replace)}h.is=R})(Bn||(e.InsertReplaceEdit=Bn={}));var ur;(function(h){h.asIs=1,h.adjustIndentation=2})(ur||(e.InsertTextMode=ur={}));var Mn;(function(h){function C(R){var v=R;return v&&(_.string(v.detail)||v.detail===void 0)&&(_.string(v.description)||v.description===void 0)}h.is=C})(Mn||(e.CompletionItemLabelDetails=Mn={}));var Rn;(function(h){function C(R){return{label:R}}h.create=C})(Rn||(e.CompletionItem=Rn={}));var Sn;(function(h){function C(R,v){return{items:R||[],isIncomplete:!!v}}h.create=C})(Sn||(e.CompletionList=Sn={}));var Nn;(function(h){function C(v){return v.replace(/[\\`*_{}[\]()#+\-.!]/g,"\\$&")}h.fromPlainText=C;function R(v){var l=v;return _.string(l)||_.objectLiteral(l)&&_.string(l.language)&&_.string(l.value)}h.is=R})(Nn||(e.MarkedString=Nn={}));var ct;(function(h){function C(R){var v=R;return!!v&&_.objectLiteral(v)&&(wt.is(v.contents)||Nn.is(v.contents)||_.typedArray(v.contents,Nn.is))&&(R.range===void 0||a.is(R.range))}h.is=C})(ct||(e.Hover=ct={}));var Gn;(function(h){function C(R,v){return v?{label:R,documentation:v}:{label:R}}h.create=C})(Gn||(e.ParameterInformation=Gn={}));var Dn;(function(h){function C(R,v){for(var l=[],T=2;T<arguments.length;T++)l[T-2]=arguments[T];var F={label:R};return _.defined(v)&&(F.documentation=v),_.defined(l)?F.parameters=l:F.parameters=[],F}h.create=C})(Dn||(e.SignatureInformation=Dn={}));var ln;(function(h){h.Text=1,h.Read=2,h.Write=3})(ln||(e.DocumentHighlightKind=ln={}));var dr;(function(h){function C(R,v){var l={range:R};return _.number(v)&&(l.kind=v),l}h.create=C})(dr||(e.DocumentHighlight=dr={}));var fn;(function(h){h.File=1,h.Module=2,h.Namespace=3,h.Package=4,h.Class=5,h.Method=6,h.Property=7,h.Field=8,h.Constructor=9,h.Enum=10,h.Interface=11,h.Function=12,h.Variable=13,h.Constant=14,h.String=15,h.Number=16,h.Boolean=17,h.Array=18,h.Object=19,h.Key=20,h.Null=21,h.EnumMember=22,h.Struct=23,h.Event=24,h.Operator=25,h.TypeParameter=26})(fn||(e.SymbolKind=fn={}));var An;(function(h){h.Deprecated=1})(An||(e.SymbolTag=An={}));var st;(function(h){function C(R,v,l,T,F){var ne={name:R,kind:v,location:{uri:T,range:l}};return F&&(ne.containerName=F),ne}h.create=C})(st||(e.SymbolInformation=st={}));var Dt;(function(h){function C(R,v,l,T){return T!==void 0?{name:R,kind:v,location:{uri:l,range:T}}:{name:R,kind:v,location:{uri:l}}}h.create=C})(Dt||(e.WorkspaceSymbol=Dt={}));var Ct;(function(h){function C(v,l,T,F,ne,He){var Oe={name:v,detail:l,kind:T,range:F,selectionRange:ne};return He!==void 0&&(Oe.children=He),Oe}h.create=C;function R(v){var l=v;return l&&_.string(l.name)&&_.number(l.kind)&&a.is(l.range)&&a.is(l.selectionRange)&&(l.detail===void 0||_.string(l.detail))&&(l.deprecated===void 0||_.boolean(l.deprecated))&&(l.children===void 0||Array.isArray(l.children))&&(l.tags===void 0||Array.isArray(l.tags))}h.is=R})(Ct||(e.DocumentSymbol=Ct={}));var Zt;(function(h){h.Empty="",h.QuickFix="quickfix",h.Refactor="refactor",h.RefactorExtract="refactor.extract",h.RefactorInline="refactor.inline",h.RefactorRewrite="refactor.rewrite",h.Source="source",h.SourceOrganizeImports="source.organizeImports",h.SourceFixAll="source.fixAll"})(Zt||(e.CodeActionKind=Zt={}));var jt;(function(h){h.Invoked=1,h.Automatic=2})(jt||(e.CodeActionTriggerKind=jt={}));var $n;(function(h){function C(v,l,T){var F={diagnostics:v};return l!=null&&(F.only=l),T!=null&&(F.triggerKind=T),F}h.create=C;function R(v){var l=v;return _.defined(l)&&_.typedArray(l.diagnostics,M.is)&&(l.only===void 0||_.typedArray(l.only,_.string))&&(l.triggerKind===void 0||l.triggerKind===jt.Invoked||l.triggerKind===jt.Automatic)}h.is=R})($n||(e.CodeActionContext=$n={}));var Xn;(function(h){function C(v,l,T){var F={title:v},ne=!0;return typeof l=="string"?(ne=!1,F.kind=l):H.is(l)?F.command=l:F.edit=l,ne&&T!==void 0&&(F.kind=T),F}h.create=C;function R(v){var l=v;return l&&_.string(l.title)&&(l.diagnostics===void 0||_.typedArray(l.diagnostics,M.is))&&(l.kind===void 0||_.string(l.kind))&&(l.edit!==void 0||l.command!==void 0)&&(l.command===void 0||H.is(l.command))&&(l.isPreferred===void 0||_.boolean(l.isPreferred))&&(l.edit===void 0||dn.is(l.edit))}h.is=R})(Xn||(e.CodeAction=Xn={}));var _n;(function(h){function C(v,l){var T={range:v};return _.defined(l)&&(T.data=l),T}h.create=C;function R(v){var l=v;return _.defined(l)&&a.is(l.range)&&(_.undefined(l.command)||H.is(l.command))}h.is=R})(_n||(e.CodeLens=_n={}));var Jn;(function(h){function C(v,l){return{tabSize:v,insertSpaces:l}}h.create=C;function R(v){var l=v;return _.defined(l)&&_.uinteger(l.tabSize)&&_.boolean(l.insertSpaces)}h.is=R})(Jn||(e.FormattingOptions=Jn={}));var Lt;(function(h){function C(v,l,T){return{range:v,target:l,data:T}}h.create=C;function R(v){var l=v;return _.defined(l)&&a.is(l.range)&&(_.undefined(l.target)||_.string(l.target))}h.is=R})(Lt||(e.DocumentLink=Lt={}));var w;(function(h){function C(v,l){return{range:v,parent:l}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&a.is(l.range)&&(l.parent===void 0||h.is(l.parent))}h.is=R})(w||(e.SelectionRange=w={}));var q;(function(h){h.namespace="namespace",h.type="type",h.class="class",h.enum="enum",h.interface="interface",h.struct="struct",h.typeParameter="typeParameter",h.parameter="parameter",h.variable="variable",h.property="property",h.enumMember="enumMember",h.event="event",h.function="function",h.method="method",h.macro="macro",h.keyword="keyword",h.modifier="modifier",h.comment="comment",h.string="string",h.number="number",h.regexp="regexp",h.operator="operator",h.decorator="decorator"})(q||(e.SemanticTokenTypes=q={}));var U;(function(h){h.declaration="declaration",h.definition="definition",h.readonly="readonly",h.static="static",h.deprecated="deprecated",h.abstract="abstract",h.async="async",h.modification="modification",h.documentation="documentation",h.defaultLibrary="defaultLibrary"})(U||(e.SemanticTokenModifiers=U={}));var K;(function(h){function C(R){var v=R;return _.objectLiteral(v)&&(v.resultId===void 0||typeof v.resultId=="string")&&Array.isArray(v.data)&&(v.data.length===0||typeof v.data[0]=="number")}h.is=C})(K||(e.SemanticTokens=K={}));var Ce;(function(h){function C(v,l){return{range:v,text:l}}h.create=C;function R(v){var l=v;return l!=null&&a.is(l.range)&&_.string(l.text)}h.is=R})(Ce||(e.InlineValueText=Ce={}));var be;(function(h){function C(v,l,T){return{range:v,variableName:l,caseSensitiveLookup:T}}h.create=C;function R(v){var l=v;return l!=null&&a.is(l.range)&&_.boolean(l.caseSensitiveLookup)&&(_.string(l.variableName)||l.variableName===void 0)}h.is=R})(be||(e.InlineValueVariableLookup=be={}));var Pe;(function(h){function C(v,l){return{range:v,expression:l}}h.create=C;function R(v){var l=v;return l!=null&&a.is(l.range)&&(_.string(l.expression)||l.expression===void 0)}h.is=R})(Pe||(e.InlineValueEvaluatableExpression=Pe={}));var qe;(function(h){function C(v,l){return{frameId:v,stoppedLocation:l}}h.create=C;function R(v){var l=v;return _.defined(l)&&a.is(v.stoppedLocation)}h.is=R})(qe||(e.InlineValueContext=qe={}));var ce;(function(h){h.Type=1,h.Parameter=2;function C(R){return R===1||R===2}h.is=C})(ce||(e.InlayHintKind=ce={}));var Se;(function(h){function C(v){return{value:v}}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&(l.tooltip===void 0||_.string(l.tooltip)||wt.is(l.tooltip))&&(l.location===void 0||u.is(l.location))&&(l.command===void 0||H.is(l.command))}h.is=R})(Se||(e.InlayHintLabelPart=Se={}));var ge;(function(h){function C(v,l,T){var F={position:v,label:l};return T!==void 0&&(F.kind=T),F}h.create=C;function R(v){var l=v;return _.objectLiteral(l)&&o.is(l.position)&&(_.string(l.label)||_.typedArray(l.label,Se.is))&&(l.kind===void 0||ce.is(l.kind))&&l.textEdits===void 0||_.typedArray(l.textEdits,J.is)&&(l.tooltip===void 0||_.string(l.tooltip)||wt.is(l.tooltip))&&(l.paddingLeft===void 0||_.boolean(l.paddingLeft))&&(l.paddingRight===void 0||_.boolean(l.paddingRight))}h.is=R})(ge||(e.InlayHint=ge={}));var Fe;(function(h){function C(R){return{kind:"snippet",value:R}}h.createSnippet=C})(Fe||(e.StringValue=Fe={}));var Ze;(function(h){function C(R,v,l,T){return{insertText:R,filterText:v,range:l,command:T}}h.create=C})(Ze||(e.InlineCompletionItem=Ze={}));var ft;(function(h){function C(R){return{items:R}}h.create=C})(ft||(e.InlineCompletionList=ft={}));var lr;(function(h){h.Invoked=0,h.Automatic=1})(lr||(e.InlineCompletionTriggerKind=lr={}));var fr;(function(h){function C(R,v){return{range:R,text:v}}h.create=C})(fr||(e.SelectedCompletionInfo=fr={}));var f;(function(h){function C(R,v){return{triggerKind:R,selectedCompletionInfo:v}}h.create=C})(f||(e.InlineCompletionContext=f={}));var k;(function(h){function C(R){var v=R;return _.objectLiteral(v)&&n.is(v.uri)&&_.string(v.name)}h.is=C})(k||(e.WorkspaceFolder=k={})),e.EOL=[`
`,`\r
`,"\r"];var B;(function(h){function C(T,F,ne,He){return new De(T,F,ne,He)}h.create=C;function R(T){var F=T;return!!(_.defined(F)&&_.string(F.uri)&&(_.undefined(F.languageId)||_.string(F.languageId))&&_.uinteger(F.lineCount)&&_.func(F.getText)&&_.func(F.positionAt)&&_.func(F.offsetAt))}h.is=R;function v(T,F){for(var ne=T.getText(),He=l(F,function(jn,c){var D=jn.range.start.line-c.range.start.line;return D===0?jn.range.start.character-c.range.start.character:D}),Oe=ne.length,Ut=He.length-1;Ut>=0;Ut--){var en=He[Ut],Tn=T.offsetAt(en.range.start),fe=T.offsetAt(en.range.end);if(fe<=Oe)ne=ne.substring(0,Tn)+en.newText+ne.substring(fe,ne.length);else throw new Error("Overlapping edit");Oe=Tn}return ne}h.applyEdits=v;function l(T,F){if(T.length<=1)return T;var ne=T.length/2|0,He=T.slice(0,ne),Oe=T.slice(ne);l(He,F),l(Oe,F);for(var Ut=0,en=0,Tn=0;Ut<He.length&&en<Oe.length;){var fe=F(He[Ut],Oe[en]);fe<=0?T[Tn++]=He[Ut++]:T[Tn++]=Oe[en++]}for(;Ut<He.length;)T[Tn++]=He[Ut++];for(;en<Oe.length;)T[Tn++]=Oe[en++];return T}})(B||(e.TextDocument=B={}));var De=function(){function h(C,R,v,l){this._uri=C,this._languageId=R,this._version=v,this._content=l,this._lineOffsets=void 0}return Object.defineProperty(h.prototype,"uri",{get:function(){return this._uri},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"languageId",{get:function(){return this._languageId},enumerable:!1,configurable:!0}),Object.defineProperty(h.prototype,"version",{get:function(){return this._version},enumerable:!1,configurable:!0}),h.prototype.getText=function(C){if(C){var R=this.offsetAt(C.start),v=this.offsetAt(C.end);return this._content.substring(R,v)}return this._content},h.prototype.update=function(C,R){this._content=C.text,this._version=R,this._lineOffsets=void 0},h.prototype.getLineOffsets=function(){if(this._lineOffsets===void 0){for(var C=[],R=this._content,v=!0,l=0;l<R.length;l++){v&&(C.push(l),v=!1);var T=R.charAt(l);v=T==="\r"||T===`
`,T==="\r"&&l+1<R.length&&R.charAt(l+1)===`
`&&l++}v&&R.length>0&&C.push(R.length),this._lineOffsets=C}return this._lineOffsets},h.prototype.positionAt=function(C){C=Math.max(Math.min(C,this._content.length),0);var R=this.getLineOffsets(),v=0,l=R.length;if(l===0)return o.create(0,C);for(;v<l;){var T=Math.floor((v+l)/2);R[T]>C?l=T:v=T+1}var F=v-1;return o.create(F,C-R[F])},h.prototype.offsetAt=function(C){var R=this.getLineOffsets();if(C.line>=R.length)return this._content.length;if(C.line<0)return 0;var v=R[C.line],l=C.line+1<R.length?R[C.line+1]:this._content.length;return Math.max(Math.min(v+C.character,l),v)},Object.defineProperty(h.prototype,"lineCount",{get:function(){return this.getLineOffsets().length},enumerable:!1,configurable:!0}),h}(),_;(function(h){var C=Object.prototype.toString;function R(fe){return typeof fe<"u"}h.defined=R;function v(fe){return typeof fe>"u"}h.undefined=v;function l(fe){return fe===!0||fe===!1}h.boolean=l;function T(fe){return C.call(fe)==="[object String]"}h.string=T;function F(fe){return C.call(fe)==="[object Number]"}h.number=F;function ne(fe,jn,c){return C.call(fe)==="[object Number]"&&jn<=fe&&fe<=c}h.numberRange=ne;function He(fe){return C.call(fe)==="[object Number]"&&-2147483648<=fe&&fe<=2147483647}h.integer=He;function Oe(fe){return C.call(fe)==="[object Number]"&&0<=fe&&fe<=2147483647}h.uinteger=Oe;function Ut(fe){return C.call(fe)==="[object Function]"}h.func=Ut;function en(fe){return fe!==null&&typeof fe=="object"}h.objectLiteral=en;function Tn(fe,jn){return Array.isArray(fe)&&fe.every(jn)}h.typedArray=Tn})(_||(_={}))})});var We=x(Wt=>{"use strict";Object.defineProperty(Wt,"__esModule",{value:!0});Wt.ProtocolNotificationType=Wt.ProtocolNotificationType0=Wt.ProtocolRequestType=Wt.ProtocolRequestType0=Wt.RegistrationType=Wt.MessageDirection=void 0;var oi=Lr(),ph;(function(r){r.clientToServer="clientToServer",r.serverToClient="serverToClient",r.both="both"})(ph||(Wt.MessageDirection=ph={}));var Gc=class{constructor(e){this.method=e}};Wt.RegistrationType=Gc;var Xc=class extends oi.RequestType0{constructor(e){super(e)}};Wt.ProtocolRequestType0=Xc;var Jc=class extends oi.RequestType{constructor(e){super(e,oi.ParameterStructures.byName)}};Wt.ProtocolRequestType=Jc;var Qc=class extends oi.NotificationType0{constructor(e){super(e)}};Wt.ProtocolNotificationType0=Qc;var Yc=class extends oi.NotificationType{constructor(e){super(e,oi.ParameterStructures.byName)}};Wt.ProtocolNotificationType=Yc});var zs=x(ut=>{"use strict";Object.defineProperty(ut,"__esModule",{value:!0});ut.objectLiteral=ut.typedArray=ut.stringArray=ut.array=ut.func=ut.error=ut.number=ut.string=ut.boolean=void 0;function bw(r){return r===!0||r===!1}ut.boolean=bw;function gh(r){return typeof r=="string"||r instanceof String}ut.string=gh;function ww(r){return typeof r=="number"||r instanceof Number}ut.number=ww;function Cw(r){return r instanceof Error}ut.error=Cw;function Rw(r){return typeof r=="function"}ut.func=Rw;function mh(r){return Array.isArray(r)}ut.array=mh;function Sw(r){return mh(r)&&r.every(e=>gh(e))}ut.stringArray=Sw;function Dw(r,e){return Array.isArray(r)&&r.every(e)}ut.typedArray=Dw;function _w(r){return r!==null&&typeof r=="object"}ut.objectLiteral=_w});var bh=x(Bs=>{"use strict";Object.defineProperty(Bs,"__esModule",{value:!0});Bs.ImplementationRequest=void 0;var vh=We(),yh;(function(r){r.method="textDocument/implementation",r.messageDirection=vh.MessageDirection.clientToServer,r.type=new vh.ProtocolRequestType(r.method)})(yh||(Bs.ImplementationRequest=yh={}))});var Rh=x(Gs=>{"use strict";Object.defineProperty(Gs,"__esModule",{value:!0});Gs.TypeDefinitionRequest=void 0;var wh=We(),Ch;(function(r){r.method="textDocument/typeDefinition",r.messageDirection=wh.MessageDirection.clientToServer,r.type=new wh.ProtocolRequestType(r.method)})(Ch||(Gs.TypeDefinitionRequest=Ch={}))});var _h=x(ai=>{"use strict";Object.defineProperty(ai,"__esModule",{value:!0});ai.DidChangeWorkspaceFoldersNotification=ai.WorkspaceFoldersRequest=void 0;var Xs=We(),Sh;(function(r){r.method="workspace/workspaceFolders",r.messageDirection=Xs.MessageDirection.serverToClient,r.type=new Xs.ProtocolRequestType0(r.method)})(Sh||(ai.WorkspaceFoldersRequest=Sh={}));var Dh;(function(r){r.method="workspace/didChangeWorkspaceFolders",r.messageDirection=Xs.MessageDirection.clientToServer,r.type=new Xs.ProtocolNotificationType(r.method)})(Dh||(ai.DidChangeWorkspaceFoldersNotification=Dh={}))});var kh=x(Js=>{"use strict";Object.defineProperty(Js,"__esModule",{value:!0});Js.ConfigurationRequest=void 0;var Th=We(),Ph;(function(r){r.method="workspace/configuration",r.messageDirection=Th.MessageDirection.serverToClient,r.type=new Th.ProtocolRequestType(r.method)})(Ph||(Js.ConfigurationRequest=Ph={}))});var Ih=x(ci=>{"use strict";Object.defineProperty(ci,"__esModule",{value:!0});ci.ColorPresentationRequest=ci.DocumentColorRequest=void 0;var Qs=We(),Eh;(function(r){r.method="textDocument/documentColor",r.messageDirection=Qs.MessageDirection.clientToServer,r.type=new Qs.ProtocolRequestType(r.method)})(Eh||(ci.DocumentColorRequest=Eh={}));var xh;(function(r){r.method="textDocument/colorPresentation",r.messageDirection=Qs.MessageDirection.clientToServer,r.type=new Qs.ProtocolRequestType(r.method)})(xh||(ci.ColorPresentationRequest=xh={}))});var Oh=x(ui=>{"use strict";Object.defineProperty(ui,"__esModule",{value:!0});ui.FoldingRangeRefreshRequest=ui.FoldingRangeRequest=void 0;var Ys=We(),qh;(function(r){r.method="textDocument/foldingRange",r.messageDirection=Ys.MessageDirection.clientToServer,r.type=new Ys.ProtocolRequestType(r.method)})(qh||(ui.FoldingRangeRequest=qh={}));var Fh;(function(r){r.method="workspace/foldingRange/refresh",r.messageDirection=Ys.MessageDirection.serverToClient,r.type=new Ys.ProtocolRequestType0(r.method)})(Fh||(ui.FoldingRangeRefreshRequest=Fh={}))});var Nh=x(Zs=>{"use strict";Object.defineProperty(Zs,"__esModule",{value:!0});Zs.DeclarationRequest=void 0;var Lh=We(),Mh;(function(r){r.method="textDocument/declaration",r.messageDirection=Lh.MessageDirection.clientToServer,r.type=new Lh.ProtocolRequestType(r.method)})(Mh||(Zs.DeclarationRequest=Mh={}))});var jh=x(eo=>{"use strict";Object.defineProperty(eo,"__esModule",{value:!0});eo.SelectionRangeRequest=void 0;var Ah=We(),$h;(function(r){r.method="textDocument/selectionRange",r.messageDirection=Ah.MessageDirection.clientToServer,r.type=new Ah.ProtocolRequestType(r.method)})($h||(eo.SelectionRangeRequest=$h={}))});var Kh=x(vr=>{"use strict";Object.defineProperty(vr,"__esModule",{value:!0});vr.WorkDoneProgressCancelNotification=vr.WorkDoneProgressCreateRequest=vr.WorkDoneProgress=void 0;var Tw=Lr(),to=We(),Uh;(function(r){r.type=new Tw.ProgressType;function e(t){return t===r.type}r.is=e})(Uh||(vr.WorkDoneProgress=Uh={}));var Hh;(function(r){r.method="window/workDoneProgress/create",r.messageDirection=to.MessageDirection.serverToClient,r.type=new to.ProtocolRequestType(r.method)})(Hh||(vr.WorkDoneProgressCreateRequest=Hh={}));var Wh;(function(r){r.method="window/workDoneProgress/cancel",r.messageDirection=to.MessageDirection.clientToServer,r.type=new to.ProtocolNotificationType(r.method)})(Wh||(vr.WorkDoneProgressCancelNotification=Wh={}))});var Gh=x(yr=>{"use strict";Object.defineProperty(yr,"__esModule",{value:!0});yr.CallHierarchyOutgoingCallsRequest=yr.CallHierarchyIncomingCallsRequest=yr.CallHierarchyPrepareRequest=void 0;var di=We(),Vh;(function(r){r.method="textDocument/prepareCallHierarchy",r.messageDirection=di.MessageDirection.clientToServer,r.type=new di.ProtocolRequestType(r.method)})(Vh||(yr.CallHierarchyPrepareRequest=Vh={}));var zh;(function(r){r.method="callHierarchy/incomingCalls",r.messageDirection=di.MessageDirection.clientToServer,r.type=new di.ProtocolRequestType(r.method)})(zh||(yr.CallHierarchyIncomingCallsRequest=zh={}));var Bh;(function(r){r.method="callHierarchy/outgoingCalls",r.messageDirection=di.MessageDirection.clientToServer,r.type=new di.ProtocolRequestType(r.method)})(Bh||(yr.CallHierarchyOutgoingCallsRequest=Bh={}))});var ep=x(Kt=>{"use strict";Object.defineProperty(Kt,"__esModule",{value:!0});Kt.SemanticTokensRefreshRequest=Kt.SemanticTokensRangeRequest=Kt.SemanticTokensDeltaRequest=Kt.SemanticTokensRequest=Kt.SemanticTokensRegistrationType=Kt.TokenFormat=void 0;var Yn=We(),Xh;(function(r){r.Relative="relative"})(Xh||(Kt.TokenFormat=Xh={}));var ji;(function(r){r.method="textDocument/semanticTokens",r.type=new Yn.RegistrationType(r.method)})(ji||(Kt.SemanticTokensRegistrationType=ji={}));var Jh;(function(r){r.method="textDocument/semanticTokens/full",r.messageDirection=Yn.MessageDirection.clientToServer,r.type=new Yn.ProtocolRequestType(r.method),r.registrationMethod=ji.method})(Jh||(Kt.SemanticTokensRequest=Jh={}));var Qh;(function(r){r.method="textDocument/semanticTokens/full/delta",r.messageDirection=Yn.MessageDirection.clientToServer,r.type=new Yn.ProtocolRequestType(r.method),r.registrationMethod=ji.method})(Qh||(Kt.SemanticTokensDeltaRequest=Qh={}));var Yh;(function(r){r.method="textDocument/semanticTokens/range",r.messageDirection=Yn.MessageDirection.clientToServer,r.type=new Yn.ProtocolRequestType(r.method),r.registrationMethod=ji.method})(Yh||(Kt.SemanticTokensRangeRequest=Yh={}));var Zh;(function(r){r.method="workspace/semanticTokens/refresh",r.messageDirection=Yn.MessageDirection.serverToClient,r.type=new Yn.ProtocolRequestType0(r.method)})(Zh||(Kt.SemanticTokensRefreshRequest=Zh={}))});var rp=x(no=>{"use strict";Object.defineProperty(no,"__esModule",{value:!0});no.ShowDocumentRequest=void 0;var tp=We(),np;(function(r){r.method="window/showDocument",r.messageDirection=tp.MessageDirection.serverToClient,r.type=new tp.ProtocolRequestType(r.method)})(np||(no.ShowDocumentRequest=np={}))});var op=x(ro=>{"use strict";Object.defineProperty(ro,"__esModule",{value:!0});ro.LinkedEditingRangeRequest=void 0;var ip=We(),sp;(function(r){r.method="textDocument/linkedEditingRange",r.messageDirection=ip.MessageDirection.clientToServer,r.type=new ip.ProtocolRequestType(r.method)})(sp||(ro.LinkedEditingRangeRequest=sp={}))});var pp=x(Pt=>{"use strict";Object.defineProperty(Pt,"__esModule",{value:!0});Pt.WillDeleteFilesRequest=Pt.DidDeleteFilesNotification=Pt.DidRenameFilesNotification=Pt.WillRenameFilesRequest=Pt.DidCreateFilesNotification=Pt.WillCreateFilesRequest=Pt.FileOperationPatternKind=void 0;var pn=We(),ap;(function(r){r.file="file",r.folder="folder"})(ap||(Pt.FileOperationPatternKind=ap={}));var cp;(function(r){r.method="workspace/willCreateFiles",r.messageDirection=pn.MessageDirection.clientToServer,r.type=new pn.ProtocolRequestType(r.method)})(cp||(Pt.WillCreateFilesRequest=cp={}));var up;(function(r){r.method="workspace/didCreateFiles",r.messageDirection=pn.MessageDirection.clientToServer,r.type=new pn.ProtocolNotificationType(r.method)})(up||(Pt.DidCreateFilesNotification=up={}));var dp;(function(r){r.method="workspace/willRenameFiles",r.messageDirection=pn.MessageDirection.clientToServer,r.type=new pn.ProtocolRequestType(r.method)})(dp||(Pt.WillRenameFilesRequest=dp={}));var lp;(function(r){r.method="workspace/didRenameFiles",r.messageDirection=pn.MessageDirection.clientToServer,r.type=new pn.ProtocolNotificationType(r.method)})(lp||(Pt.DidRenameFilesNotification=lp={}));var fp;(function(r){r.method="workspace/didDeleteFiles",r.messageDirection=pn.MessageDirection.clientToServer,r.type=new pn.ProtocolNotificationType(r.method)})(fp||(Pt.DidDeleteFilesNotification=fp={}));var hp;(function(r){r.method="workspace/willDeleteFiles",r.messageDirection=pn.MessageDirection.clientToServer,r.type=new pn.ProtocolRequestType(r.method)})(hp||(Pt.WillDeleteFilesRequest=hp={}))});var bp=x(br=>{"use strict";Object.defineProperty(br,"__esModule",{value:!0});br.MonikerRequest=br.MonikerKind=br.UniquenessLevel=void 0;var gp=We(),mp;(function(r){r.document="document",r.project="project",r.group="group",r.scheme="scheme",r.global="global"})(mp||(br.UniquenessLevel=mp={}));var vp;(function(r){r.$import="import",r.$export="export",r.local="local"})(vp||(br.MonikerKind=vp={}));var yp;(function(r){r.method="textDocument/moniker",r.messageDirection=gp.MessageDirection.clientToServer,r.type=new gp.ProtocolRequestType(r.method)})(yp||(br.MonikerRequest=yp={}))});var Sp=x(wr=>{"use strict";Object.defineProperty(wr,"__esModule",{value:!0});wr.TypeHierarchySubtypesRequest=wr.TypeHierarchySupertypesRequest=wr.TypeHierarchyPrepareRequest=void 0;var li=We(),wp;(function(r){r.method="textDocument/prepareTypeHierarchy",r.messageDirection=li.MessageDirection.clientToServer,r.type=new li.ProtocolRequestType(r.method)})(wp||(wr.TypeHierarchyPrepareRequest=wp={}));var Cp;(function(r){r.method="typeHierarchy/supertypes",r.messageDirection=li.MessageDirection.clientToServer,r.type=new li.ProtocolRequestType(r.method)})(Cp||(wr.TypeHierarchySupertypesRequest=Cp={}));var Rp;(function(r){r.method="typeHierarchy/subtypes",r.messageDirection=li.MessageDirection.clientToServer,r.type=new li.ProtocolRequestType(r.method)})(Rp||(wr.TypeHierarchySubtypesRequest=Rp={}))});var Tp=x(fi=>{"use strict";Object.defineProperty(fi,"__esModule",{value:!0});fi.InlineValueRefreshRequest=fi.InlineValueRequest=void 0;var io=We(),Dp;(function(r){r.method="textDocument/inlineValue",r.messageDirection=io.MessageDirection.clientToServer,r.type=new io.ProtocolRequestType(r.method)})(Dp||(fi.InlineValueRequest=Dp={}));var _p;(function(r){r.method="workspace/inlineValue/refresh",r.messageDirection=io.MessageDirection.serverToClient,r.type=new io.ProtocolRequestType0(r.method)})(_p||(fi.InlineValueRefreshRequest=_p={}))});var xp=x(Cr=>{"use strict";Object.defineProperty(Cr,"__esModule",{value:!0});Cr.InlayHintRefreshRequest=Cr.InlayHintResolveRequest=Cr.InlayHintRequest=void 0;var hi=We(),Pp;(function(r){r.method="textDocument/inlayHint",r.messageDirection=hi.MessageDirection.clientToServer,r.type=new hi.ProtocolRequestType(r.method)})(Pp||(Cr.InlayHintRequest=Pp={}));var kp;(function(r){r.method="inlayHint/resolve",r.messageDirection=hi.MessageDirection.clientToServer,r.type=new hi.ProtocolRequestType(r.method)})(kp||(Cr.InlayHintResolveRequest=kp={}));var Ep;(function(r){r.method="workspace/inlayHint/refresh",r.messageDirection=hi.MessageDirection.serverToClient,r.type=new hi.ProtocolRequestType0(r.method)})(Ep||(Cr.InlayHintRefreshRequest=Ep={}))});var Np=x(gn=>{"use strict";Object.defineProperty(gn,"__esModule",{value:!0});gn.DiagnosticRefreshRequest=gn.WorkspaceDiagnosticRequest=gn.DocumentDiagnosticRequest=gn.DocumentDiagnosticReportKind=gn.DiagnosticServerCancellationData=void 0;var Mp=Lr(),Pw=zs(),pi=We(),Ip;(function(r){function e(t){let n=t;return n&&Pw.boolean(n.retriggerRequest)}r.is=e})(Ip||(gn.DiagnosticServerCancellationData=Ip={}));var qp;(function(r){r.Full="full",r.Unchanged="unchanged"})(qp||(gn.DocumentDiagnosticReportKind=qp={}));var Fp;(function(r){r.method="textDocument/diagnostic",r.messageDirection=pi.MessageDirection.clientToServer,r.type=new pi.ProtocolRequestType(r.method),r.partialResult=new Mp.ProgressType})(Fp||(gn.DocumentDiagnosticRequest=Fp={}));var Op;(function(r){r.method="workspace/diagnostic",r.messageDirection=pi.MessageDirection.clientToServer,r.type=new pi.ProtocolRequestType(r.method),r.partialResult=new Mp.ProgressType})(Op||(gn.WorkspaceDiagnosticRequest=Op={}));var Lp;(function(r){r.method="workspace/diagnostic/refresh",r.messageDirection=pi.MessageDirection.serverToClient,r.type=new pi.ProtocolRequestType0(r.method)})(Lp||(gn.DiagnosticRefreshRequest=Lp={}))});var Kp=x(tt=>{"use strict";Object.defineProperty(tt,"__esModule",{value:!0});tt.DidCloseNotebookDocumentNotification=tt.DidSaveNotebookDocumentNotification=tt.DidChangeNotebookDocumentNotification=tt.NotebookCellArrayChange=tt.DidOpenNotebookDocumentNotification=tt.NotebookDocumentSyncRegistrationType=tt.NotebookDocument=tt.NotebookCell=tt.ExecutionSummary=tt.NotebookCellKind=void 0;var Ui=Vs(),kn=zs(),Hn=We(),Zc;(function(r){r.Markup=1,r.Code=2;function e(t){return t===1||t===2}r.is=e})(Zc||(tt.NotebookCellKind=Zc={}));var eu;(function(r){function e(i,s){let o={executionOrder:i};return(s===!0||s===!1)&&(o.success=s),o}r.create=e;function t(i){let s=i;return kn.objectLiteral(s)&&Ui.uinteger.is(s.executionOrder)&&(s.success===void 0||kn.boolean(s.success))}r.is=t;function n(i,s){return i===s?!0:i==null||s===null||s===void 0?!1:i.executionOrder===s.executionOrder&&i.success===s.success}r.equals=n})(eu||(tt.ExecutionSummary=eu={}));var so;(function(r){function e(s,o){return{kind:s,document:o}}r.create=e;function t(s){let o=s;return kn.objectLiteral(o)&&Zc.is(o.kind)&&Ui.DocumentUri.is(o.document)&&(o.metadata===void 0||kn.objectLiteral(o.metadata))}r.is=t;function n(s,o){let a=new Set;return s.document!==o.document&&a.add("document"),s.kind!==o.kind&&a.add("kind"),s.executionSummary!==o.executionSummary&&a.add("executionSummary"),(s.metadata!==void 0||o.metadata!==void 0)&&!i(s.metadata,o.metadata)&&a.add("metadata"),(s.executionSummary!==void 0||o.executionSummary!==void 0)&&!eu.equals(s.executionSummary,o.executionSummary)&&a.add("executionSummary"),a}r.diff=n;function i(s,o){if(s===o)return!0;if(s==null||o===null||o===void 0||typeof s!=typeof o||typeof s!="object")return!1;let a=Array.isArray(s),u=Array.isArray(o);if(a!==u)return!1;if(a&&u){if(s.length!==o.length)return!1;for(let d=0;d<s.length;d++)if(!i(s[d],o[d]))return!1}if(kn.objectLiteral(s)&&kn.objectLiteral(o)){let d=Object.keys(s),p=Object.keys(o);if(d.length!==p.length||(d.sort(),p.sort(),!i(d,p)))return!1;for(let m=0;m<d.length;m++){let g=d[m];if(!i(s[g],o[g]))return!1}}return!0}})(so||(tt.NotebookCell=so={}));var Ap;(function(r){function e(n,i,s,o){return{uri:n,notebookType:i,version:s,cells:o}}r.create=e;function t(n){let i=n;return kn.objectLiteral(i)&&kn.string(i.uri)&&Ui.integer.is(i.version)&&kn.typedArray(i.cells,so.is)}r.is=t})(Ap||(tt.NotebookDocument=Ap={}));var gi;(function(r){r.method="notebookDocument/sync",r.messageDirection=Hn.MessageDirection.clientToServer,r.type=new Hn.RegistrationType(r.method)})(gi||(tt.NotebookDocumentSyncRegistrationType=gi={}));var $p;(function(r){r.method="notebookDocument/didOpen",r.messageDirection=Hn.MessageDirection.clientToServer,r.type=new Hn.ProtocolNotificationType(r.method),r.registrationMethod=gi.method})($p||(tt.DidOpenNotebookDocumentNotification=$p={}));var jp;(function(r){function e(n){let i=n;return kn.objectLiteral(i)&&Ui.uinteger.is(i.start)&&Ui.uinteger.is(i.deleteCount)&&(i.cells===void 0||kn.typedArray(i.cells,so.is))}r.is=e;function t(n,i,s){let o={start:n,deleteCount:i};return s!==void 0&&(o.cells=s),o}r.create=t})(jp||(tt.NotebookCellArrayChange=jp={}));var Up;(function(r){r.method="notebookDocument/didChange",r.messageDirection=Hn.MessageDirection.clientToServer,r.type=new Hn.ProtocolNotificationType(r.method),r.registrationMethod=gi.method})(Up||(tt.DidChangeNotebookDocumentNotification=Up={}));var Hp;(function(r){r.method="notebookDocument/didSave",r.messageDirection=Hn.MessageDirection.clientToServer,r.type=new Hn.ProtocolNotificationType(r.method),r.registrationMethod=gi.method})(Hp||(tt.DidSaveNotebookDocumentNotification=Hp={}));var Wp;(function(r){r.method="notebookDocument/didClose",r.messageDirection=Hn.MessageDirection.clientToServer,r.type=new Hn.ProtocolNotificationType(r.method),r.registrationMethod=gi.method})(Wp||(tt.DidCloseNotebookDocumentNotification=Wp={}))});var Bp=x(oo=>{"use strict";Object.defineProperty(oo,"__esModule",{value:!0});oo.InlineCompletionRequest=void 0;var Vp=We(),zp;(function(r){r.method="textDocument/inlineCompletion",r.messageDirection=Vp.MessageDirection.clientToServer,r.type=new Vp.ProtocolRequestType(r.method)})(zp||(oo.InlineCompletionRequest=zp={}))});var om=x(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.WorkspaceSymbolRequest=b.CodeActionResolveRequest=b.CodeActionRequest=b.DocumentSymbolRequest=b.DocumentHighlightRequest=b.ReferencesRequest=b.DefinitionRequest=b.SignatureHelpRequest=b.SignatureHelpTriggerKind=b.HoverRequest=b.CompletionResolveRequest=b.CompletionRequest=b.CompletionTriggerKind=b.PublishDiagnosticsNotification=b.WatchKind=b.RelativePattern=b.FileChangeType=b.DidChangeWatchedFilesNotification=b.WillSaveTextDocumentWaitUntilRequest=b.WillSaveTextDocumentNotification=b.TextDocumentSaveReason=b.DidSaveTextDocumentNotification=b.DidCloseTextDocumentNotification=b.DidChangeTextDocumentNotification=b.TextDocumentContentChangeEvent=b.DidOpenTextDocumentNotification=b.TextDocumentSyncKind=b.TelemetryEventNotification=b.LogMessageNotification=b.ShowMessageRequest=b.ShowMessageNotification=b.MessageType=b.DidChangeConfigurationNotification=b.ExitNotification=b.ShutdownRequest=b.InitializedNotification=b.InitializeErrorCodes=b.InitializeRequest=b.WorkDoneProgressOptions=b.TextDocumentRegistrationOptions=b.StaticRegistrationOptions=b.PositionEncodingKind=b.FailureHandlingKind=b.ResourceOperationKind=b.UnregistrationRequest=b.RegistrationRequest=b.DocumentSelector=b.NotebookCellTextDocumentFilter=b.NotebookDocumentFilter=b.TextDocumentFilter=void 0;b.MonikerRequest=b.MonikerKind=b.UniquenessLevel=b.WillDeleteFilesRequest=b.DidDeleteFilesNotification=b.WillRenameFilesRequest=b.DidRenameFilesNotification=b.WillCreateFilesRequest=b.DidCreateFilesNotification=b.FileOperationPatternKind=b.LinkedEditingRangeRequest=b.ShowDocumentRequest=b.SemanticTokensRegistrationType=b.SemanticTokensRefreshRequest=b.SemanticTokensRangeRequest=b.SemanticTokensDeltaRequest=b.SemanticTokensRequest=b.TokenFormat=b.CallHierarchyPrepareRequest=b.CallHierarchyOutgoingCallsRequest=b.CallHierarchyIncomingCallsRequest=b.WorkDoneProgressCancelNotification=b.WorkDoneProgressCreateRequest=b.WorkDoneProgress=b.SelectionRangeRequest=b.DeclarationRequest=b.FoldingRangeRefreshRequest=b.FoldingRangeRequest=b.ColorPresentationRequest=b.DocumentColorRequest=b.ConfigurationRequest=b.DidChangeWorkspaceFoldersNotification=b.WorkspaceFoldersRequest=b.TypeDefinitionRequest=b.ImplementationRequest=b.ApplyWorkspaceEditRequest=b.ExecuteCommandRequest=b.PrepareRenameRequest=b.RenameRequest=b.PrepareSupportDefaultBehavior=b.DocumentOnTypeFormattingRequest=b.DocumentRangesFormattingRequest=b.DocumentRangeFormattingRequest=b.DocumentFormattingRequest=b.DocumentLinkResolveRequest=b.DocumentLinkRequest=b.CodeLensRefreshRequest=b.CodeLensResolveRequest=b.CodeLensRequest=b.WorkspaceSymbolResolveRequest=void 0;b.InlineCompletionRequest=b.DidCloseNotebookDocumentNotification=b.DidSaveNotebookDocumentNotification=b.DidChangeNotebookDocumentNotification=b.NotebookCellArrayChange=b.DidOpenNotebookDocumentNotification=b.NotebookDocumentSyncRegistrationType=b.NotebookDocument=b.NotebookCell=b.ExecutionSummary=b.NotebookCellKind=b.DiagnosticRefreshRequest=b.WorkspaceDiagnosticRequest=b.DocumentDiagnosticRequest=b.DocumentDiagnosticReportKind=b.DiagnosticServerCancellationData=b.InlayHintRefreshRequest=b.InlayHintResolveRequest=b.InlayHintRequest=b.InlineValueRefreshRequest=b.InlineValueRequest=b.TypeHierarchySupertypesRequest=b.TypeHierarchySubtypesRequest=b.TypeHierarchyPrepareRequest=void 0;var j=We(),Gp=Vs(),pt=zs(),kw=bh();Object.defineProperty(b,"ImplementationRequest",{enumerable:!0,get:function(){return kw.ImplementationRequest}});var Ew=Rh();Object.defineProperty(b,"TypeDefinitionRequest",{enumerable:!0,get:function(){return Ew.TypeDefinitionRequest}});var nm=_h();Object.defineProperty(b,"WorkspaceFoldersRequest",{enumerable:!0,get:function(){return nm.WorkspaceFoldersRequest}});Object.defineProperty(b,"DidChangeWorkspaceFoldersNotification",{enumerable:!0,get:function(){return nm.DidChangeWorkspaceFoldersNotification}});var xw=kh();Object.defineProperty(b,"ConfigurationRequest",{enumerable:!0,get:function(){return xw.ConfigurationRequest}});var rm=Ih();Object.defineProperty(b,"DocumentColorRequest",{enumerable:!0,get:function(){return rm.DocumentColorRequest}});Object.defineProperty(b,"ColorPresentationRequest",{enumerable:!0,get:function(){return rm.ColorPresentationRequest}});var im=Oh();Object.defineProperty(b,"FoldingRangeRequest",{enumerable:!0,get:function(){return im.FoldingRangeRequest}});Object.defineProperty(b,"FoldingRangeRefreshRequest",{enumerable:!0,get:function(){return im.FoldingRangeRefreshRequest}});var Iw=Nh();Object.defineProperty(b,"DeclarationRequest",{enumerable:!0,get:function(){return Iw.DeclarationRequest}});var qw=jh();Object.defineProperty(b,"SelectionRangeRequest",{enumerable:!0,get:function(){return qw.SelectionRangeRequest}});var su=Kh();Object.defineProperty(b,"WorkDoneProgress",{enumerable:!0,get:function(){return su.WorkDoneProgress}});Object.defineProperty(b,"WorkDoneProgressCreateRequest",{enumerable:!0,get:function(){return su.WorkDoneProgressCreateRequest}});Object.defineProperty(b,"WorkDoneProgressCancelNotification",{enumerable:!0,get:function(){return su.WorkDoneProgressCancelNotification}});var ou=Gh();Object.defineProperty(b,"CallHierarchyIncomingCallsRequest",{enumerable:!0,get:function(){return ou.CallHierarchyIncomingCallsRequest}});Object.defineProperty(b,"CallHierarchyOutgoingCallsRequest",{enumerable:!0,get:function(){return ou.CallHierarchyOutgoingCallsRequest}});Object.defineProperty(b,"CallHierarchyPrepareRequest",{enumerable:!0,get:function(){return ou.CallHierarchyPrepareRequest}});var mi=ep();Object.defineProperty(b,"TokenFormat",{enumerable:!0,get:function(){return mi.TokenFormat}});Object.defineProperty(b,"SemanticTokensRequest",{enumerable:!0,get:function(){return mi.SemanticTokensRequest}});Object.defineProperty(b,"SemanticTokensDeltaRequest",{enumerable:!0,get:function(){return mi.SemanticTokensDeltaRequest}});Object.defineProperty(b,"SemanticTokensRangeRequest",{enumerable:!0,get:function(){return mi.SemanticTokensRangeRequest}});Object.defineProperty(b,"SemanticTokensRefreshRequest",{enumerable:!0,get:function(){return mi.SemanticTokensRefreshRequest}});Object.defineProperty(b,"SemanticTokensRegistrationType",{enumerable:!0,get:function(){return mi.SemanticTokensRegistrationType}});var Fw=rp();Object.defineProperty(b,"ShowDocumentRequest",{enumerable:!0,get:function(){return Fw.ShowDocumentRequest}});var Ow=op();Object.defineProperty(b,"LinkedEditingRangeRequest",{enumerable:!0,get:function(){return Ow.LinkedEditingRangeRequest}});var Mr=pp();Object.defineProperty(b,"FileOperationPatternKind",{enumerable:!0,get:function(){return Mr.FileOperationPatternKind}});Object.defineProperty(b,"DidCreateFilesNotification",{enumerable:!0,get:function(){return Mr.DidCreateFilesNotification}});Object.defineProperty(b,"WillCreateFilesRequest",{enumerable:!0,get:function(){return Mr.WillCreateFilesRequest}});Object.defineProperty(b,"DidRenameFilesNotification",{enumerable:!0,get:function(){return Mr.DidRenameFilesNotification}});Object.defineProperty(b,"WillRenameFilesRequest",{enumerable:!0,get:function(){return Mr.WillRenameFilesRequest}});Object.defineProperty(b,"DidDeleteFilesNotification",{enumerable:!0,get:function(){return Mr.DidDeleteFilesNotification}});Object.defineProperty(b,"WillDeleteFilesRequest",{enumerable:!0,get:function(){return Mr.WillDeleteFilesRequest}});var au=bp();Object.defineProperty(b,"UniquenessLevel",{enumerable:!0,get:function(){return au.UniquenessLevel}});Object.defineProperty(b,"MonikerKind",{enumerable:!0,get:function(){return au.MonikerKind}});Object.defineProperty(b,"MonikerRequest",{enumerable:!0,get:function(){return au.MonikerRequest}});var cu=Sp();Object.defineProperty(b,"TypeHierarchyPrepareRequest",{enumerable:!0,get:function(){return cu.TypeHierarchyPrepareRequest}});Object.defineProperty(b,"TypeHierarchySubtypesRequest",{enumerable:!0,get:function(){return cu.TypeHierarchySubtypesRequest}});Object.defineProperty(b,"TypeHierarchySupertypesRequest",{enumerable:!0,get:function(){return cu.TypeHierarchySupertypesRequest}});var sm=Tp();Object.defineProperty(b,"InlineValueRequest",{enumerable:!0,get:function(){return sm.InlineValueRequest}});Object.defineProperty(b,"InlineValueRefreshRequest",{enumerable:!0,get:function(){return sm.InlineValueRefreshRequest}});var uu=xp();Object.defineProperty(b,"InlayHintRequest",{enumerable:!0,get:function(){return uu.InlayHintRequest}});Object.defineProperty(b,"InlayHintResolveRequest",{enumerable:!0,get:function(){return uu.InlayHintResolveRequest}});Object.defineProperty(b,"InlayHintRefreshRequest",{enumerable:!0,get:function(){return uu.InlayHintRefreshRequest}});var Hi=Np();Object.defineProperty(b,"DiagnosticServerCancellationData",{enumerable:!0,get:function(){return Hi.DiagnosticServerCancellationData}});Object.defineProperty(b,"DocumentDiagnosticReportKind",{enumerable:!0,get:function(){return Hi.DocumentDiagnosticReportKind}});Object.defineProperty(b,"DocumentDiagnosticRequest",{enumerable:!0,get:function(){return Hi.DocumentDiagnosticRequest}});Object.defineProperty(b,"WorkspaceDiagnosticRequest",{enumerable:!0,get:function(){return Hi.WorkspaceDiagnosticRequest}});Object.defineProperty(b,"DiagnosticRefreshRequest",{enumerable:!0,get:function(){return Hi.DiagnosticRefreshRequest}});var Wn=Kp();Object.defineProperty(b,"NotebookCellKind",{enumerable:!0,get:function(){return Wn.NotebookCellKind}});Object.defineProperty(b,"ExecutionSummary",{enumerable:!0,get:function(){return Wn.ExecutionSummary}});Object.defineProperty(b,"NotebookCell",{enumerable:!0,get:function(){return Wn.NotebookCell}});Object.defineProperty(b,"NotebookDocument",{enumerable:!0,get:function(){return Wn.NotebookDocument}});Object.defineProperty(b,"NotebookDocumentSyncRegistrationType",{enumerable:!0,get:function(){return Wn.NotebookDocumentSyncRegistrationType}});Object.defineProperty(b,"DidOpenNotebookDocumentNotification",{enumerable:!0,get:function(){return Wn.DidOpenNotebookDocumentNotification}});Object.defineProperty(b,"NotebookCellArrayChange",{enumerable:!0,get:function(){return Wn.NotebookCellArrayChange}});Object.defineProperty(b,"DidChangeNotebookDocumentNotification",{enumerable:!0,get:function(){return Wn.DidChangeNotebookDocumentNotification}});Object.defineProperty(b,"DidSaveNotebookDocumentNotification",{enumerable:!0,get:function(){return Wn.DidSaveNotebookDocumentNotification}});Object.defineProperty(b,"DidCloseNotebookDocumentNotification",{enumerable:!0,get:function(){return Wn.DidCloseNotebookDocumentNotification}});var Lw=Bp();Object.defineProperty(b,"InlineCompletionRequest",{enumerable:!0,get:function(){return Lw.InlineCompletionRequest}});var tu;(function(r){function e(t){let n=t;return pt.string(n)||pt.string(n.language)||pt.string(n.scheme)||pt.string(n.pattern)}r.is=e})(tu||(b.TextDocumentFilter=tu={}));var nu;(function(r){function e(t){let n=t;return pt.objectLiteral(n)&&(pt.string(n.notebookType)||pt.string(n.scheme)||pt.string(n.pattern))}r.is=e})(nu||(b.NotebookDocumentFilter=nu={}));var ru;(function(r){function e(t){let n=t;return pt.objectLiteral(n)&&(pt.string(n.notebook)||nu.is(n.notebook))&&(n.language===void 0||pt.string(n.language))}r.is=e})(ru||(b.NotebookCellTextDocumentFilter=ru={}));var iu;(function(r){function e(t){if(!Array.isArray(t))return!1;for(let n of t)if(!pt.string(n)&&!tu.is(n)&&!ru.is(n))return!1;return!0}r.is=e})(iu||(b.DocumentSelector=iu={}));var Xp;(function(r){r.method="client/registerCapability",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolRequestType(r.method)})(Xp||(b.RegistrationRequest=Xp={}));var Jp;(function(r){r.method="client/unregisterCapability",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolRequestType(r.method)})(Jp||(b.UnregistrationRequest=Jp={}));var Qp;(function(r){r.Create="create",r.Rename="rename",r.Delete="delete"})(Qp||(b.ResourceOperationKind=Qp={}));var Yp;(function(r){r.Abort="abort",r.Transactional="transactional",r.TextOnlyTransactional="textOnlyTransactional",r.Undo="undo"})(Yp||(b.FailureHandlingKind=Yp={}));var Zp;(function(r){r.UTF8="utf-8",r.UTF16="utf-16",r.UTF32="utf-32"})(Zp||(b.PositionEncodingKind=Zp={}));var eg;(function(r){function e(t){let n=t;return n&&pt.string(n.id)&&n.id.length>0}r.hasId=e})(eg||(b.StaticRegistrationOptions=eg={}));var tg;(function(r){function e(t){let n=t;return n&&(n.documentSelector===null||iu.is(n.documentSelector))}r.is=e})(tg||(b.TextDocumentRegistrationOptions=tg={}));var ng;(function(r){function e(n){let i=n;return pt.objectLiteral(i)&&(i.workDoneProgress===void 0||pt.boolean(i.workDoneProgress))}r.is=e;function t(n){let i=n;return i&&pt.boolean(i.workDoneProgress)}r.hasWorkDoneProgress=t})(ng||(b.WorkDoneProgressOptions=ng={}));var rg;(function(r){r.method="initialize",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(rg||(b.InitializeRequest=rg={}));var ig;(function(r){r.unknownProtocolVersion=1})(ig||(b.InitializeErrorCodes=ig={}));var sg;(function(r){r.method="initialized",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(sg||(b.InitializedNotification=sg={}));var og;(function(r){r.method="shutdown",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType0(r.method)})(og||(b.ShutdownRequest=og={}));var ag;(function(r){r.method="exit",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType0(r.method)})(ag||(b.ExitNotification=ag={}));var cg;(function(r){r.method="workspace/didChangeConfiguration",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(cg||(b.DidChangeConfigurationNotification=cg={}));var ug;(function(r){r.Error=1,r.Warning=2,r.Info=3,r.Log=4,r.Debug=5})(ug||(b.MessageType=ug={}));var dg;(function(r){r.method="window/showMessage",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolNotificationType(r.method)})(dg||(b.ShowMessageNotification=dg={}));var lg;(function(r){r.method="window/showMessageRequest",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolRequestType(r.method)})(lg||(b.ShowMessageRequest=lg={}));var fg;(function(r){r.method="window/logMessage",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolNotificationType(r.method)})(fg||(b.LogMessageNotification=fg={}));var hg;(function(r){r.method="telemetry/event",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolNotificationType(r.method)})(hg||(b.TelemetryEventNotification=hg={}));var pg;(function(r){r.None=0,r.Full=1,r.Incremental=2})(pg||(b.TextDocumentSyncKind=pg={}));var gg;(function(r){r.method="textDocument/didOpen",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(gg||(b.DidOpenTextDocumentNotification=gg={}));var mg;(function(r){function e(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range!==void 0&&(i.rangeLength===void 0||typeof i.rangeLength=="number")}r.isIncremental=e;function t(n){let i=n;return i!=null&&typeof i.text=="string"&&i.range===void 0&&i.rangeLength===void 0}r.isFull=t})(mg||(b.TextDocumentContentChangeEvent=mg={}));var vg;(function(r){r.method="textDocument/didChange",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(vg||(b.DidChangeTextDocumentNotification=vg={}));var yg;(function(r){r.method="textDocument/didClose",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(yg||(b.DidCloseTextDocumentNotification=yg={}));var bg;(function(r){r.method="textDocument/didSave",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(bg||(b.DidSaveTextDocumentNotification=bg={}));var wg;(function(r){r.Manual=1,r.AfterDelay=2,r.FocusOut=3})(wg||(b.TextDocumentSaveReason=wg={}));var Cg;(function(r){r.method="textDocument/willSave",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(Cg||(b.WillSaveTextDocumentNotification=Cg={}));var Rg;(function(r){r.method="textDocument/willSaveWaitUntil",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Rg||(b.WillSaveTextDocumentWaitUntilRequest=Rg={}));var Sg;(function(r){r.method="workspace/didChangeWatchedFiles",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolNotificationType(r.method)})(Sg||(b.DidChangeWatchedFilesNotification=Sg={}));var Dg;(function(r){r.Created=1,r.Changed=2,r.Deleted=3})(Dg||(b.FileChangeType=Dg={}));var _g;(function(r){function e(t){let n=t;return pt.objectLiteral(n)&&(Gp.URI.is(n.baseUri)||Gp.WorkspaceFolder.is(n.baseUri))&&pt.string(n.pattern)}r.is=e})(_g||(b.RelativePattern=_g={}));var Tg;(function(r){r.Create=1,r.Change=2,r.Delete=4})(Tg||(b.WatchKind=Tg={}));var Pg;(function(r){r.method="textDocument/publishDiagnostics",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolNotificationType(r.method)})(Pg||(b.PublishDiagnosticsNotification=Pg={}));var kg;(function(r){r.Invoked=1,r.TriggerCharacter=2,r.TriggerForIncompleteCompletions=3})(kg||(b.CompletionTriggerKind=kg={}));var Eg;(function(r){r.method="textDocument/completion",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Eg||(b.CompletionRequest=Eg={}));var xg;(function(r){r.method="completionItem/resolve",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(xg||(b.CompletionResolveRequest=xg={}));var Ig;(function(r){r.method="textDocument/hover",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Ig||(b.HoverRequest=Ig={}));var qg;(function(r){r.Invoked=1,r.TriggerCharacter=2,r.ContentChange=3})(qg||(b.SignatureHelpTriggerKind=qg={}));var Fg;(function(r){r.method="textDocument/signatureHelp",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Fg||(b.SignatureHelpRequest=Fg={}));var Og;(function(r){r.method="textDocument/definition",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Og||(b.DefinitionRequest=Og={}));var Lg;(function(r){r.method="textDocument/references",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Lg||(b.ReferencesRequest=Lg={}));var Mg;(function(r){r.method="textDocument/documentHighlight",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Mg||(b.DocumentHighlightRequest=Mg={}));var Ng;(function(r){r.method="textDocument/documentSymbol",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Ng||(b.DocumentSymbolRequest=Ng={}));var Ag;(function(r){r.method="textDocument/codeAction",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Ag||(b.CodeActionRequest=Ag={}));var $g;(function(r){r.method="codeAction/resolve",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})($g||(b.CodeActionResolveRequest=$g={}));var jg;(function(r){r.method="workspace/symbol",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(jg||(b.WorkspaceSymbolRequest=jg={}));var Ug;(function(r){r.method="workspaceSymbol/resolve",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Ug||(b.WorkspaceSymbolResolveRequest=Ug={}));var Hg;(function(r){r.method="textDocument/codeLens",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Hg||(b.CodeLensRequest=Hg={}));var Wg;(function(r){r.method="codeLens/resolve",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Wg||(b.CodeLensResolveRequest=Wg={}));var Kg;(function(r){r.method="workspace/codeLens/refresh",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolRequestType0(r.method)})(Kg||(b.CodeLensRefreshRequest=Kg={}));var Vg;(function(r){r.method="textDocument/documentLink",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Vg||(b.DocumentLinkRequest=Vg={}));var zg;(function(r){r.method="documentLink/resolve",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(zg||(b.DocumentLinkResolveRequest=zg={}));var Bg;(function(r){r.method="textDocument/formatting",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Bg||(b.DocumentFormattingRequest=Bg={}));var Gg;(function(r){r.method="textDocument/rangeFormatting",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Gg||(b.DocumentRangeFormattingRequest=Gg={}));var Xg;(function(r){r.method="textDocument/rangesFormatting",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Xg||(b.DocumentRangesFormattingRequest=Xg={}));var Jg;(function(r){r.method="textDocument/onTypeFormatting",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Jg||(b.DocumentOnTypeFormattingRequest=Jg={}));var Qg;(function(r){r.Identifier=1})(Qg||(b.PrepareSupportDefaultBehavior=Qg={}));var Yg;(function(r){r.method="textDocument/rename",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Yg||(b.RenameRequest=Yg={}));var Zg;(function(r){r.method="textDocument/prepareRename",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(Zg||(b.PrepareRenameRequest=Zg={}));var em;(function(r){r.method="workspace/executeCommand",r.messageDirection=j.MessageDirection.clientToServer,r.type=new j.ProtocolRequestType(r.method)})(em||(b.ExecuteCommandRequest=em={}));var tm;(function(r){r.method="workspace/applyEdit",r.messageDirection=j.MessageDirection.serverToClient,r.type=new j.ProtocolRequestType("workspace/applyEdit")})(tm||(b.ApplyWorkspaceEditRequest=tm={}))});var cm=x(ao=>{"use strict";Object.defineProperty(ao,"__esModule",{value:!0});ao.createProtocolConnection=void 0;var am=Lr();function Mw(r,e,t,n){return am.ConnectionStrategy.is(n)&&(n={connectionStrategy:n}),(0,am.createMessageConnection)(r,e,t,n)}ao.createProtocolConnection=Mw});var dm=x(Vt=>{"use strict";var Nw=Vt&&Vt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),co=Vt&&Vt.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Nw(e,r,t)};Object.defineProperty(Vt,"__esModule",{value:!0});Vt.LSPErrorCodes=Vt.createProtocolConnection=void 0;co(Lr(),Vt);co(Vs(),Vt);co(We(),Vt);co(om(),Vt);var Aw=cm();Object.defineProperty(Vt,"createProtocolConnection",{enumerable:!0,get:function(){return Aw.createProtocolConnection}});var um;(function(r){r.lspReservedErrorRangeStart=-32899,r.RequestFailed=-32803,r.ServerCancelled=-32802,r.ContentModified=-32801,r.RequestCancelled=-32800,r.lspReservedErrorRangeEnd=-32800})(um||(Vt.LSPErrorCodes=um={}))});var re=x(Kn=>{"use strict";var $w=Kn&&Kn.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),lm=Kn&&Kn.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&$w(e,r,t)};Object.defineProperty(Kn,"__esModule",{value:!0});Kn.createProtocolConnection=void 0;var jw=Bc();lm(Bc(),Kn);lm(dm(),Kn);function Uw(r,e,t,n){return(0,jw.createMessageConnection)(r,e,t,n)}Kn.createProtocolConnection=Uw});var uo=x(kt=>{"use strict";Object.defineProperty(kt,"__esModule",{value:!0});kt.forEach=kt.mapAsync=kt.map=kt.clearTestMode=kt.setTestMode=kt.Semaphore=kt.Delayer=void 0;var Ki=re(),du=class{constructor(e){this.defaultDelay=e,this.timeout=void 0,this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0}trigger(e,t=this.defaultDelay){return this.task=e,t>=0&&this.cancelTimeout(),this.completionPromise||(this.completionPromise=new Promise(n=>{this.onSuccess=n}).then(()=>{this.completionPromise=void 0,this.onSuccess=void 0;var n=this.task();return this.task=void 0,n})),(t>=0||this.timeout===void 0)&&(this.timeout=(0,Ki.RAL)().timer.setTimeout(()=>{this.timeout=void 0,this.onSuccess(void 0)},t>=0?t:this.defaultDelay)),this.completionPromise}forceDelivery(){if(!this.completionPromise)return;this.cancelTimeout();let e=this.task();return this.completionPromise=void 0,this.onSuccess=void 0,this.task=void 0,e}isTriggered(){return this.timeout!==void 0}cancel(){this.cancelTimeout(),this.completionPromise=void 0}cancelTimeout(){this.timeout!==void 0&&(this.timeout.dispose(),this.timeout=void 0)}};kt.Delayer=du;var lu=class{constructor(e=1){if(e<=0)throw new Error("Capacity must be greater than 0");this._capacity=e,this._active=0,this._waiting=[]}lock(e){return new Promise((t,n)=>{this._waiting.push({thunk:e,resolve:t,reject:n}),this.runNext()})}get active(){return this._active}runNext(){this._waiting.length===0||this._active===this._capacity||(0,Ki.RAL)().timer.setImmediate(()=>this.doRunNext())}doRunNext(){if(this._waiting.length===0||this._active===this._capacity)return;let e=this._waiting.shift();if(this._active++,this._active>this._capacity)throw new Error("To many thunks active");try{let t=e.thunk();t instanceof Promise?t.then(n=>{this._active--,e.resolve(n),this.runNext()},n=>{this._active--,e.reject(n),this.runNext()}):(this._active--,e.resolve(t),this.runNext())}catch(t){this._active--,e.reject(t),this.runNext()}}};kt.Semaphore=lu;var fu=!1;function Hw(){fu=!0}kt.setTestMode=Hw;function Ww(){fu=!1}kt.clearTestMode=Ww;var fm=15,Wi=class{constructor(e=fm){this.yieldAfter=fu===!0?Math.max(e,2):Math.max(e,fm),this.startTime=Date.now(),this.counter=0,this.total=0,this.counterInterval=1}start(){this.counter=0,this.total=0,this.counterInterval=1,this.startTime=Date.now()}shouldYield(){if(++this.counter>=this.counterInterval){let e=Date.now()-this.startTime,t=Math.max(0,this.yieldAfter-e);if(this.total+=this.counter,this.counter=0,e>=this.yieldAfter||t<=1)return this.counterInterval=1,this.total=0,!0;switch(e){case 0:case 1:this.counterInterval=this.total*2;break}}return!1}};async function Kw(r,e,t,n){if(r.length===0)return[];let i=new Array(r.length),s=new Wi(n?.yieldAfter);function o(u){s.start();for(let d=u;d<r.length;d++)if(i[d]=e(r[d]),s.shouldYield())return n?.yieldCallback&&n.yieldCallback(),d+1;return-1}let a=o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,Ki.RAL)().timer.setImmediate(()=>{u(o(a))})});return i}kt.map=Kw;async function Vw(r,e,t,n){if(r.length===0)return[];let i=new Array(r.length),s=new Wi(n?.yieldAfter);async function o(u){s.start();for(let d=u;d<r.length;d++)if(i[d]=await e(r[d],t),s.shouldYield())return n?.yieldCallback&&n.yieldCallback(),d+1;return-1}let a=await o(0);for(;a!==-1&&!(t!==void 0&&t.isCancellationRequested);)a=await new Promise(u=>{(0,Ki.RAL)().timer.setImmediate(()=>{u(o(a))})});return i}kt.mapAsync=Vw;async function zw(r,e,t,n){if(r.length===0)return;let i=new Wi(n?.yieldAfter);function s(a){i.start();for(let u=a;u<r.length;u++)if(e(r[u]),i.shouldYield())return n?.yieldCallback&&n.yieldCallback(),u+1;return-1}let o=s(0);for(;o!==-1&&!(t!==void 0&&t.isCancellationRequested);)o=await new Promise(a=>{(0,Ki.RAL)().timer.setImmediate(()=>{a(s(o))})})}kt.forEach=zw});var gu=x(pu=>{"use strict";Object.defineProperty(pu,"__esModule",{value:!0});var Bw=require("vscode"),hu=class extends Bw.CompletionItem{constructor(e){super(e)}};pu.default=hu});var yu=x(vu=>{"use strict";Object.defineProperty(vu,"__esModule",{value:!0});var Gw=require("vscode"),mu=class extends Gw.CodeLens{constructor(e){super(e)}};vu.default=mu});var Cu=x(wu=>{"use strict";Object.defineProperty(wu,"__esModule",{value:!0});var Xw=require("vscode"),bu=class extends Xw.DocumentLink{constructor(e,t){super(e,t)}};wu.default=bu});var Du=x(Su=>{"use strict";Object.defineProperty(Su,"__esModule",{value:!0});var Jw=require("vscode"),Ru=class extends Jw.CodeAction{constructor(e,t){super(e),this.data=t}};Su.default=Ru});var Pu=x(vi=>{"use strict";Object.defineProperty(vi,"__esModule",{value:!0});vi.ProtocolDiagnostic=vi.DiagnosticCode=void 0;var Qw=require("vscode"),_u=hn(),hm;(function(r){function e(t){let n=t;return n!=null&&(_u.number(n.value)||_u.string(n.value))&&_u.string(n.target)}r.is=e})(hm||(vi.DiagnosticCode=hm={}));var Tu=class extends Qw.Diagnostic{constructor(e,t,n,i){super(e,t,n),this.data=i,this.hasDiagnosticCode=!1}};vi.ProtocolDiagnostic=Tu});var xu=x(Eu=>{"use strict";Object.defineProperty(Eu,"__esModule",{value:!0});var Yw=require("vscode"),ku=class extends Yw.CallHierarchyItem{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s,o),a!==void 0&&(this.data=a)}};Eu.default=ku});var Fu=x(qu=>{"use strict";Object.defineProperty(qu,"__esModule",{value:!0});var Zw=require("vscode"),Iu=class extends Zw.TypeHierarchyItem{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s,o),a!==void 0&&(this.data=a)}};qu.default=Iu});var Mu=x(Lu=>{"use strict";Object.defineProperty(Lu,"__esModule",{value:!0});var lo=require("vscode"),Ou=class extends lo.SymbolInformation{constructor(e,t,n,i,s){let o=!(i instanceof lo.Uri);super(e,t,n,o?i:new lo.Location(i,new lo.Range(0,0,0,0))),this.hasRange=o,s!==void 0&&(this.data=s)}};Lu.default=Ou});var $u=x(Au=>{"use strict";Object.defineProperty(Au,"__esModule",{value:!0});var eC=require("vscode"),Nu=class extends eC.InlayHint{constructor(e,t,n){super(e,t,n)}};Au.default=Nu});var vm=x(fo=>{"use strict";Object.defineProperty(fo,"__esModule",{value:!0});fo.createConverter=void 0;var dt=require("vscode"),ie=re(),Nr=hn(),pm=uo(),tC=gu(),nC=yu(),rC=Cu(),gm=Du(),mm=Pu(),iC=xu(),sC=Fu(),oC=Mu(),aC=$u(),ju;(function(r){function e(t){let n=t;return n&&!!n.inserting&&!!n.replacing}r.is=e})(ju||(ju={}));function cC(r){let t=r||(f=>f.toString());function n(f){return t(f)}function i(f){return{uri:t(f.uri)}}function s(f){return{uri:t(f.uri),languageId:f.languageId,version:f.version,text:f.getText()}}function o(f){return{uri:t(f.uri),version:f.version}}function a(f){return{textDocument:s(f)}}function u(f){let k=f;return!!k.document&&!!k.contentChanges}function d(f){let k=f;return!!k.uri&&!!k.version}function p(f,k,B){if(d(f))return{textDocument:{uri:t(f.uri),version:f.version},contentChanges:[{text:f.getText()}]};if(u(f)){let De=k,_=B;return{textDocument:{uri:t(De),version:_},contentChanges:f.contentChanges.map(C=>{let R=C.range;return{range:{start:{line:R.start.line,character:R.start.character},end:{line:R.end.line,character:R.end.character}},rangeLength:C.rangeLength,text:C.text}})}}else throw Error("Unsupported text document change parameter")}function m(f){return{textDocument:i(f)}}function g(f,k=!1){let B={textDocument:i(f)};return k&&(B.text=f.getText()),B}function S(f){switch(f){case dt.TextDocumentSaveReason.Manual:return ie.TextDocumentSaveReason.Manual;case dt.TextDocumentSaveReason.AfterDelay:return ie.TextDocumentSaveReason.AfterDelay;case dt.TextDocumentSaveReason.FocusOut:return ie.TextDocumentSaveReason.FocusOut}return ie.TextDocumentSaveReason.Manual}function y(f){return{textDocument:i(f.document),reason:S(f.reason)}}function P(f){return{files:f.files.map(k=>({uri:t(k)}))}}function E(f){return{files:f.files.map(k=>({oldUri:t(k.oldUri),newUri:t(k.newUri)}))}}function L(f){return{files:f.files.map(k=>({uri:t(k)}))}}function N(f){return{files:f.files.map(k=>({uri:t(k)}))}}function M(f){return{files:f.files.map(k=>({oldUri:t(k.oldUri),newUri:t(k.newUri)}))}}function H(f){return{files:f.files.map(k=>({uri:t(k)}))}}function J(f,k){return{textDocument:i(f),position:yt(k)}}function pe(f){switch(f){case dt.CompletionTriggerKind.TriggerCharacter:return ie.CompletionTriggerKind.TriggerCharacter;case dt.CompletionTriggerKind.TriggerForIncompleteCompletions:return ie.CompletionTriggerKind.TriggerForIncompleteCompletions;default:return ie.CompletionTriggerKind.Invoked}}function G(f,k,B){return{textDocument:i(f),position:yt(k),context:{triggerKind:pe(B.triggerKind),triggerCharacter:B.triggerCharacter}}}function ee(f){switch(f){case dt.SignatureHelpTriggerKind.Invoke:return ie.SignatureHelpTriggerKind.Invoked;case dt.SignatureHelpTriggerKind.TriggerCharacter:return ie.SignatureHelpTriggerKind.TriggerCharacter;case dt.SignatureHelpTriggerKind.ContentChange:return ie.SignatureHelpTriggerKind.ContentChange}}function de(f){return{label:f.label}}function it(f){return f.map(de)}function Ye(f){return{label:f.label,parameters:it(f.parameters)}}function at(f){return f.map(Ye)}function dn(f){return f===void 0?f:{signatures:at(f.signatures),activeSignature:f.activeSignature,activeParameter:f.activeParameter}}function Ft(f,k,B){return{textDocument:i(f),position:yt(k),context:{isRetrigger:B.isRetrigger,triggerCharacter:B.triggerCharacter,triggerKind:ee(B.triggerKind),activeSignatureHelp:dn(B.activeSignatureHelp)}}}function yt(f){return{line:f.line,character:f.character}}function bt(f){return f==null?f:{line:f.line>ie.uinteger.MAX_VALUE?ie.uinteger.MAX_VALUE:f.line,character:f.character>ie.uinteger.MAX_VALUE?ie.uinteger.MAX_VALUE:f.character}}function Cn(f,k){return pm.map(f,bt,k)}function Fn(f){return f.map(bt)}function Ne(f){return f==null?f:{start:bt(f.start),end:bt(f.end)}}function $t(f){return f.map(Ne)}function Ot(f){return f==null?f:ie.Location.create(n(f.uri),Ne(f.range))}function wt(f){switch(f){case dt.DiagnosticSeverity.Error:return ie.DiagnosticSeverity.Error;case dt.DiagnosticSeverity.Warning:return ie.DiagnosticSeverity.Warning;case dt.DiagnosticSeverity.Information:return ie.DiagnosticSeverity.Information;case dt.DiagnosticSeverity.Hint:return ie.DiagnosticSeverity.Hint}}function cr(f){if(!f)return;let k=[];for(let B of f){let De=On(B);De!==void 0&&k.push(De)}return k.length>0?k:void 0}function On(f){switch(f){case dt.DiagnosticTag.Unnecessary:return ie.DiagnosticTag.Unnecessary;case dt.DiagnosticTag.Deprecated:return ie.DiagnosticTag.Deprecated;default:return}}function Ln(f){return{message:f.message,location:Ot(f.location)}}function Bn(f){return f.map(Ln)}function ur(f){if(f!=null)return Nr.number(f)||Nr.string(f)?f:{value:f.value,target:n(f.target)}}function Mn(f){let k=ie.Diagnostic.create(Ne(f.range),f.message),B=f instanceof mm.ProtocolDiagnostic?f:void 0;B!==void 0&&B.data!==void 0&&(k.data=B.data);let De=ur(f.code);return mm.DiagnosticCode.is(De)?B!==void 0&&B.hasDiagnosticCode?k.code=De:(k.code=De.value,k.codeDescription={href:De.target}):k.code=De,Nr.number(f.severity)&&(k.severity=wt(f.severity)),Array.isArray(f.tags)&&(k.tags=cr(f.tags)),f.relatedInformation&&(k.relatedInformation=Bn(f.relatedInformation)),f.source&&(k.source=f.source),k}function Rn(f,k){return f==null?f:pm.map(f,Mn,k)}function Sn(f){return f==null?f:f.map(Mn)}function Nn(f,k){switch(f){case"$string":return k;case ie.MarkupKind.PlainText:return{kind:f,value:k};case ie.MarkupKind.Markdown:return{kind:f,value:k.value};default:return`Unsupported Markup content received. Kind is: ${f}`}}function ct(f){switch(f){case dt.CompletionItemTag.Deprecated:return ie.CompletionItemTag.Deprecated}}function Gn(f){if(f===void 0)return f;let k=[];for(let B of f){let De=ct(B);De!==void 0&&k.push(De)}return k}function Dn(f,k){return k!==void 0?k:f+1}function ln(f,k=!1){let B,De;Nr.string(f.label)?B=f.label:(B=f.label.label,k&&(f.label.detail!==void 0||f.label.description!==void 0)&&(De={detail:f.label.detail,description:f.label.description}));let _={label:B};De!==void 0&&(_.labelDetails=De);let h=f instanceof tC.default?f:void 0;f.detail&&(_.detail=f.detail),f.documentation&&(!h||h.documentationFormat==="$string"?_.documentation=f.documentation:_.documentation=Nn(h.documentationFormat,f.documentation)),f.filterText&&(_.filterText=f.filterText),dr(_,f),Nr.number(f.kind)&&(_.kind=Dn(f.kind,h&&h.originalItemKind)),f.sortText&&(_.sortText=f.sortText),f.additionalTextEdits&&(_.additionalTextEdits=st(f.additionalTextEdits)),f.commitCharacters&&(_.commitCharacters=f.commitCharacters.slice()),f.command&&(_.command=K(f.command)),(f.preselect===!0||f.preselect===!1)&&(_.preselect=f.preselect);let C=Gn(f.tags);if(h){if(h.data!==void 0&&(_.data=h.data),h.deprecated===!0||h.deprecated===!1){if(h.deprecated===!0&&C!==void 0&&C.length>0){let R=C.indexOf(dt.CompletionItemTag.Deprecated);R!==-1&&C.splice(R,1)}_.deprecated=h.deprecated}h.insertTextMode!==void 0&&(_.insertTextMode=h.insertTextMode)}return C!==void 0&&C.length>0&&(_.tags=C),_.insertTextMode===void 0&&f.keepWhitespace===!0&&(_.insertTextMode=ie.InsertTextMode.adjustIndentation),_}function dr(f,k){let B=ie.InsertTextFormat.PlainText,De,_;k.textEdit?(De=k.textEdit.newText,_=k.textEdit.range):k.insertText instanceof dt.SnippetString?(B=ie.InsertTextFormat.Snippet,De=k.insertText.value):De=k.insertText,k.range&&(_=k.range),f.insertTextFormat=B,k.fromEdit&&De!==void 0&&_!==void 0?f.textEdit=fn(De,_):f.insertText=De}function fn(f,k){return ju.is(k)?ie.InsertReplaceEdit.create(f,Ne(k.inserting),Ne(k.replacing)):{newText:f,range:Ne(k)}}function An(f){return{range:Ne(f.range),newText:f.newText}}function st(f){return f==null?f:f.map(An)}function Dt(f){return f<=dt.SymbolKind.TypeParameter?f+1:ie.SymbolKind.Property}function Ct(f){return f}function Zt(f){return f.map(Ct)}function jt(f,k,B){return{textDocument:i(f),position:yt(k),context:{includeDeclaration:B.includeDeclaration}}}async function $n(f,k){let B=ie.CodeAction.create(f.title);if(f instanceof gm.default&&f.data!==void 0&&(B.data=f.data),f.kind!==void 0&&(B.kind=w(f.kind)),f.diagnostics!==void 0&&(B.diagnostics=await Rn(f.diagnostics,k)),f.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return f.command!==void 0&&(B.command=K(f.command)),f.isPreferred!==void 0&&(B.isPreferred=f.isPreferred),f.disabled!==void 0&&(B.disabled={reason:f.disabled.reason}),B}function Xn(f){let k=ie.CodeAction.create(f.title);if(f instanceof gm.default&&f.data!==void 0&&(k.data=f.data),f.kind!==void 0&&(k.kind=w(f.kind)),f.diagnostics!==void 0&&(k.diagnostics=Sn(f.diagnostics)),f.edit!==void 0)throw new Error("VS Code code actions can only be converted to a protocol code action without an edit.");return f.command!==void 0&&(k.command=K(f.command)),f.isPreferred!==void 0&&(k.isPreferred=f.isPreferred),f.disabled!==void 0&&(k.disabled={reason:f.disabled.reason}),k}async function _n(f,k){if(f==null)return f;let B;return f.only&&Nr.string(f.only.value)&&(B=[f.only.value]),ie.CodeActionContext.create(await Rn(f.diagnostics,k),B,Lt(f.triggerKind))}function Jn(f){if(f==null)return f;let k;return f.only&&Nr.string(f.only.value)&&(k=[f.only.value]),ie.CodeActionContext.create(Sn(f.diagnostics),k,Lt(f.triggerKind))}function Lt(f){switch(f){case dt.CodeActionTriggerKind.Invoke:return ie.CodeActionTriggerKind.Invoked;case dt.CodeActionTriggerKind.Automatic:return ie.CodeActionTriggerKind.Automatic;default:return}}function w(f){if(f!=null)return f.value}function q(f){return f==null?f:ie.InlineValueContext.create(f.frameId,Ne(f.stoppedLocation))}function U(f,k,B){return{context:ie.InlineCompletionContext.create(B.triggerKind,B.selectedCompletionInfo),textDocument:i(f),position:bt(k)}}function K(f){let k=ie.Command.create(f.title,f.command);return f.arguments&&(k.arguments=f.arguments),k}function Ce(f){let k=ie.CodeLens.create(Ne(f.range));return f.command&&(k.command=K(f.command)),f instanceof nC.default&&f.data&&(k.data=f.data),k}function be(f,k){let B={tabSize:f.tabSize,insertSpaces:f.insertSpaces};return k.trimTrailingWhitespace&&(B.trimTrailingWhitespace=!0),k.trimFinalNewlines&&(B.trimFinalNewlines=!0),k.insertFinalNewline&&(B.insertFinalNewline=!0),B}function Pe(f){return{textDocument:i(f)}}function qe(f){return{textDocument:i(f)}}function ce(f){let k=ie.DocumentLink.create(Ne(f.range));f.target&&(k.target=n(f.target)),f.tooltip!==void 0&&(k.tooltip=f.tooltip);let B=f instanceof rC.default?f:void 0;return B&&B.data&&(k.data=B.data),k}function Se(f){return{textDocument:i(f)}}function ge(f){let k={name:f.name,kind:Dt(f.kind),uri:n(f.uri),range:Ne(f.range),selectionRange:Ne(f.selectionRange)};return f.detail!==void 0&&f.detail.length>0&&(k.detail=f.detail),f.tags!==void 0&&(k.tags=Zt(f.tags)),f instanceof iC.default&&f.data!==void 0&&(k.data=f.data),k}function Fe(f){let k={name:f.name,kind:Dt(f.kind),uri:n(f.uri),range:Ne(f.range),selectionRange:Ne(f.selectionRange)};return f.detail!==void 0&&f.detail.length>0&&(k.detail=f.detail),f.tags!==void 0&&(k.tags=Zt(f.tags)),f instanceof sC.default&&f.data!==void 0&&(k.data=f.data),k}function Ze(f){let k=f instanceof oC.default?{name:f.name,kind:Dt(f.kind),location:f.hasRange?Ot(f.location):{uri:t(f.location.uri)},data:f.data}:{name:f.name,kind:Dt(f.kind),location:Ot(f.location)};return f.tags!==void 0&&(k.tags=Zt(f.tags)),f.containerName!==""&&(k.containerName=f.containerName),k}function ft(f){let k=typeof f.label=="string"?f.label:f.label.map(lr),B=ie.InlayHint.create(bt(f.position),k);return f.kind!==void 0&&(B.kind=f.kind),f.textEdits!==void 0&&(B.textEdits=st(f.textEdits)),f.tooltip!==void 0&&(B.tooltip=fr(f.tooltip)),f.paddingLeft!==void 0&&(B.paddingLeft=f.paddingLeft),f.paddingRight!==void 0&&(B.paddingRight=f.paddingRight),f instanceof aC.default&&f.data!==void 0&&(B.data=f.data),B}function lr(f){let k=ie.InlayHintLabelPart.create(f.value);return f.location!==void 0&&(k.location=Ot(f.location)),f.command!==void 0&&(k.command=K(f.command)),f.tooltip!==void 0&&(k.tooltip=fr(f.tooltip)),k}function fr(f){return typeof f=="string"?f:{kind:ie.MarkupKind.Markdown,value:f.value}}return{asUri:n,asTextDocumentIdentifier:i,asTextDocumentItem:s,asVersionedTextDocumentIdentifier:o,asOpenTextDocumentParams:a,asChangeTextDocumentParams:p,asCloseTextDocumentParams:m,asSaveTextDocumentParams:g,asWillSaveTextDocumentParams:y,asDidCreateFilesParams:P,asDidRenameFilesParams:E,asDidDeleteFilesParams:L,asWillCreateFilesParams:N,asWillRenameFilesParams:M,asWillDeleteFilesParams:H,asTextDocumentPositionParams:J,asCompletionParams:G,asSignatureHelpParams:Ft,asWorkerPosition:yt,asRange:Ne,asRanges:$t,asPosition:bt,asPositions:Cn,asPositionsSync:Fn,asLocation:Ot,asDiagnosticSeverity:wt,asDiagnosticTag:On,asDiagnostic:Mn,asDiagnostics:Rn,asDiagnosticsSync:Sn,asCompletionItem:ln,asTextEdit:An,asSymbolKind:Dt,asSymbolTag:Ct,asSymbolTags:Zt,asReferenceParams:jt,asCodeAction:$n,asCodeActionSync:Xn,asCodeActionContext:_n,asCodeActionContextSync:Jn,asInlineValueContext:q,asCommand:K,asCodeLens:Ce,asFormattingOptions:be,asDocumentSymbolParams:Pe,asCodeLensParams:qe,asDocumentLink:ce,asDocumentLinkParams:Se,asCallHierarchyItem:ge,asTypeHierarchyItem:Fe,asInlayHint:ft,asWorkspaceSymbol:Ze,asInlineCompletionParams:U}}fo.createConverter=cC});var wm=x(po=>{"use strict";Object.defineProperty(po,"__esModule",{value:!0});po.createConverter=void 0;var W=require("vscode"),Z=re(),mn=hn(),Re=uo(),uC=gu(),dC=yu(),lC=Cu(),fC=Du(),ym=Pu(),hC=xu(),pC=Fu(),gC=Mu(),mC=$u(),bm=re(),ho;(function(r){function e(t){let n=t;return n&&mn.string(n.language)&&mn.string(n.value)}r.is=e})(ho||(ho={}));function vC(r,e,t){let i=r||(c=>W.Uri.parse(c));function s(c){return i(c)}function o(c){let D=[];for(let O of c)if(typeof O=="string")D.push(O);else if(bm.NotebookCellTextDocumentFilter.is(O))if(typeof O.notebook=="string")D.push({notebookType:O.notebook,language:O.language});else{let X=O.notebook.notebookType??"*";D.push({notebookType:X,scheme:O.notebook.scheme,pattern:O.notebook.pattern,language:O.language})}else bm.TextDocumentFilter.is(O)&&D.push({language:O.language,scheme:O.scheme,pattern:O.pattern});return D}async function a(c,D){return Re.map(c,d,D)}function u(c){let D=new Array(c.length);for(let O=0;O<c.length;O++)D[O]=d(c[O]);return D}function d(c){let D=new ym.ProtocolDiagnostic(y(c.range),c.message,E(c.severity),c.data);if(c.code!==void 0){if(typeof c.code=="string"||typeof c.code=="number")Z.CodeDescription.is(c.codeDescription)?D.code={value:c.code,target:s(c.codeDescription.href)}:D.code=c.code;else if(ym.DiagnosticCode.is(c.code)){D.hasDiagnosticCode=!0;let O=c.code;D.code={value:O.value,target:s(O.target)}}}return c.source&&(D.source=c.source),c.relatedInformation&&(D.relatedInformation=p(c.relatedInformation)),Array.isArray(c.tags)&&(D.tags=m(c.tags)),D}function p(c){let D=new Array(c.length);for(let O=0;O<c.length;O++){let X=c[O];D[O]=new W.DiagnosticRelatedInformation(wt(X.location),X.message)}return D}function m(c){if(!c)return;let D=[];for(let O of c){let X=g(O);X!==void 0&&D.push(X)}return D.length>0?D:void 0}function g(c){switch(c){case Z.DiagnosticTag.Unnecessary:return W.DiagnosticTag.Unnecessary;case Z.DiagnosticTag.Deprecated:return W.DiagnosticTag.Deprecated;default:return}}function S(c){return c?new W.Position(c.line,c.character):void 0}function y(c){return c?new W.Range(c.start.line,c.start.character,c.end.line,c.end.character):void 0}async function P(c,D){return Re.map(c,O=>new W.Range(O.start.line,O.start.character,O.end.line,O.end.character),D)}function E(c){if(c==null)return W.DiagnosticSeverity.Error;switch(c){case Z.DiagnosticSeverity.Error:return W.DiagnosticSeverity.Error;case Z.DiagnosticSeverity.Warning:return W.DiagnosticSeverity.Warning;case Z.DiagnosticSeverity.Information:return W.DiagnosticSeverity.Information;case Z.DiagnosticSeverity.Hint:return W.DiagnosticSeverity.Hint}return W.DiagnosticSeverity.Error}function L(c){if(mn.string(c))return M(c);if(ho.is(c))return M().appendCodeblock(c.value,c.language);if(Array.isArray(c)){let D=[];for(let O of c){let X=M();ho.is(O)?X.appendCodeblock(O.value,O.language):X.appendMarkdown(O),D.push(X)}return D}else return M(c)}function N(c){if(mn.string(c))return c;switch(c.kind){case Z.MarkupKind.Markdown:return M(c.value);case Z.MarkupKind.PlainText:return c.value;default:return`Unsupported Markup content received. Kind is: ${c.kind}`}}function M(c){let D;if(c===void 0||typeof c=="string")D=new W.MarkdownString(c);else switch(c.kind){case Z.MarkupKind.Markdown:D=new W.MarkdownString(c.value);break;case Z.MarkupKind.PlainText:D=new W.MarkdownString,D.appendText(c.value);break;default:D=new W.MarkdownString,D.appendText(`Unsupported Markup content received. Kind is: ${c.kind}`);break}return D.isTrusted=e,D.supportHtml=t,D}function H(c){if(c)return new W.Hover(L(c.contents),y(c.range))}async function J(c,D,O){if(!c)return;if(Array.isArray(c))return Re.map(c,Un=>it(Un,D),O);let X=c,{defaultRange:ht,commitCharacters:Rt}=pe(X,D),xe=await Re.map(X.items,Un=>it(Un,Rt,ht,X.itemDefaults?.insertTextMode,X.itemDefaults?.insertTextFormat,X.itemDefaults?.data),O);return new W.CompletionList(xe,X.isIncomplete)}function pe(c,D){let O=c.itemDefaults?.editRange,X=c.itemDefaults?.commitCharacters??D;return Z.Range.is(O)?{defaultRange:y(O),commitCharacters:X}:O!==void 0?{defaultRange:{inserting:y(O.insert),replacing:y(O.replace)},commitCharacters:X}:{defaultRange:void 0,commitCharacters:X}}function G(c){return Z.CompletionItemKind.Text<=c&&c<=Z.CompletionItemKind.TypeParameter?[c-1,void 0]:[W.CompletionItemKind.Text,c]}function ee(c){switch(c){case Z.CompletionItemTag.Deprecated:return W.CompletionItemTag.Deprecated}}function de(c){if(c==null)return[];let D=[];for(let O of c){let X=ee(O);X!==void 0&&D.push(X)}return D}function it(c,D,O,X,ht,Rt){let xe=de(c.tags),Un=Ye(c),Le=new uC.default(Un);c.detail&&(Le.detail=c.detail),c.documentation&&(Le.documentation=N(c.documentation),Le.documentationFormat=mn.string(c.documentation)?"$string":c.documentation.kind),c.filterText&&(Le.filterText=c.filterText);let Cs=at(c,O,ht);if(Cs&&(Le.insertText=Cs.text,Le.range=Cs.range,Le.fromEdit=Cs.fromEdit),mn.number(c.kind)){let[_b,If]=G(c.kind);Le.kind=_b,If&&(Le.originalItemKind=If)}c.sortText&&(Le.sortText=c.sortText),c.additionalTextEdits&&(Le.additionalTextEdits=bt(c.additionalTextEdits));let Ef=c.commitCharacters!==void 0?mn.stringArray(c.commitCharacters)?c.commitCharacters:void 0:D;Ef&&(Le.commitCharacters=Ef.slice()),c.command&&(Le.command=st(c.command)),(c.deprecated===!0||c.deprecated===!1)&&(Le.deprecated=c.deprecated,c.deprecated===!0&&xe.push(W.CompletionItemTag.Deprecated)),(c.preselect===!0||c.preselect===!1)&&(Le.preselect=c.preselect);let xf=c.data??Rt;xf!==void 0&&(Le.data=xf),xe.length>0&&(Le.tags=xe);let Ma=c.insertTextMode??X;return Ma!==void 0&&(Le.insertTextMode=Ma,Ma===Z.InsertTextMode.asIs&&(Le.keepWhitespace=!0)),Le}function Ye(c){return Z.CompletionItemLabelDetails.is(c.labelDetails)?{label:c.label,detail:c.labelDetails.detail,description:c.labelDetails.description}:c.label}function at(c,D,O){let X=c.insertTextFormat??O;if(c.textEdit!==void 0||D!==void 0){let[ht,Rt]=c.textEdit!==void 0?dn(c.textEdit):[D,c.textEditText??c.label];return X===Z.InsertTextFormat.Snippet?{text:new W.SnippetString(Rt),range:ht,fromEdit:!0}:{text:Rt,range:ht,fromEdit:!0}}else return c.insertText?X===Z.InsertTextFormat.Snippet?{text:new W.SnippetString(c.insertText),fromEdit:!1}:{text:c.insertText,fromEdit:!1}:void 0}function dn(c){return Z.InsertReplaceEdit.is(c)?[{inserting:y(c.insert),replacing:y(c.replace)},c.newText]:[y(c.range),c.newText]}function Ft(c){if(c)return new W.TextEdit(y(c.range),c.newText)}async function yt(c,D){if(c)return Re.map(c,Ft,D)}function bt(c){if(!c)return;let D=new Array(c.length);for(let O=0;O<c.length;O++)D[O]=Ft(c[O]);return D}async function Cn(c,D){if(!c)return;let O=new W.SignatureHelp;return mn.number(c.activeSignature)?O.activeSignature=c.activeSignature:O.activeSignature=0,mn.number(c.activeParameter)?O.activeParameter=c.activeParameter:O.activeParameter=0,c.signatures&&(O.signatures=await Fn(c.signatures,D)),O}async function Fn(c,D){return Re.mapAsync(c,Ne,D)}async function Ne(c,D){let O=new W.SignatureInformation(c.label);return c.documentation!==void 0&&(O.documentation=N(c.documentation)),c.parameters!==void 0&&(O.parameters=await $t(c.parameters,D)),c.activeParameter!==void 0&&(O.activeParameter=c.activeParameter),O}function $t(c,D){return Re.map(c,Ot,D)}function Ot(c){let D=new W.ParameterInformation(c.label);return c.documentation&&(D.documentation=N(c.documentation)),D}function wt(c){return c?new W.Location(i(c.uri),y(c.range)):void 0}async function cr(c,D){if(c)return Bn(c,D)}async function On(c,D){if(c)return Bn(c,D)}function Ln(c){if(!c)return;let D={targetUri:i(c.targetUri),targetRange:y(c.targetRange),originSelectionRange:y(c.originSelectionRange),targetSelectionRange:y(c.targetSelectionRange)};if(!D.targetSelectionRange)throw new Error("targetSelectionRange must not be undefined or null");return D}async function Bn(c,D){if(c)if(mn.array(c)){if(c.length===0)return[];if(Z.LocationLink.is(c[0])){let O=c;return Re.map(O,Ln,D)}else{let O=c;return Re.map(O,wt,D)}}else return Z.LocationLink.is(c)?[Ln(c)]:wt(c)}async function ur(c,D){if(c)return Re.map(c,wt,D)}async function Mn(c,D){if(c)return Re.map(c,Rn,D)}function Rn(c){let D=new W.DocumentHighlight(y(c.range));return mn.number(c.kind)&&(D.kind=Sn(c.kind)),D}function Sn(c){switch(c){case Z.DocumentHighlightKind.Text:return W.DocumentHighlightKind.Text;case Z.DocumentHighlightKind.Read:return W.DocumentHighlightKind.Read;case Z.DocumentHighlightKind.Write:return W.DocumentHighlightKind.Write}return W.DocumentHighlightKind.Text}async function Nn(c,D){if(c)return Re.map(c,ln,D)}function ct(c){return c<=Z.SymbolKind.TypeParameter?c-1:W.SymbolKind.Property}function Gn(c){switch(c){case Z.SymbolTag.Deprecated:return W.SymbolTag.Deprecated;default:return}}function Dn(c){if(c==null)return;let D=[];for(let O of c){let X=Gn(O);X!==void 0&&D.push(X)}return D.length===0?void 0:D}function ln(c){let D=c.data,O=c.location,X=O.range===void 0||D!==void 0?new gC.default(c.name,ct(c.kind),c.containerName??"",O.range===void 0?i(O.uri):new W.Location(i(c.location.uri),y(O.range)),D):new W.SymbolInformation(c.name,ct(c.kind),c.containerName??"",new W.Location(i(c.location.uri),y(O.range)));return An(X,c),X}async function dr(c,D){if(c!=null)return Re.map(c,fn,D)}function fn(c){let D=new W.DocumentSymbol(c.name,c.detail||"",ct(c.kind),y(c.range),y(c.selectionRange));if(An(D,c),c.children!==void 0&&c.children.length>0){let O=[];for(let X of c.children)O.push(fn(X));D.children=O}return D}function An(c,D){c.tags=Dn(D.tags),D.deprecated&&(c.tags?c.tags.includes(W.SymbolTag.Deprecated)||(c.tags=c.tags.concat(W.SymbolTag.Deprecated)):c.tags=[W.SymbolTag.Deprecated])}function st(c){let D={title:c.title,command:c.command};return c.arguments&&(D.arguments=c.arguments),D}async function Dt(c,D){if(c)return Re.map(c,st,D)}let Ct=new Map;Ct.set(Z.CodeActionKind.Empty,W.CodeActionKind.Empty),Ct.set(Z.CodeActionKind.QuickFix,W.CodeActionKind.QuickFix),Ct.set(Z.CodeActionKind.Refactor,W.CodeActionKind.Refactor),Ct.set(Z.CodeActionKind.RefactorExtract,W.CodeActionKind.RefactorExtract),Ct.set(Z.CodeActionKind.RefactorInline,W.CodeActionKind.RefactorInline),Ct.set(Z.CodeActionKind.RefactorRewrite,W.CodeActionKind.RefactorRewrite),Ct.set(Z.CodeActionKind.Source,W.CodeActionKind.Source),Ct.set(Z.CodeActionKind.SourceOrganizeImports,W.CodeActionKind.SourceOrganizeImports);function Zt(c){if(c==null)return;let D=Ct.get(c);if(D)return D;let O=c.split(".");D=W.CodeActionKind.Empty;for(let X of O)D=D.append(X);return D}function jt(c){if(c!=null)return c.map(D=>Zt(D))}async function $n(c,D){if(c==null)return;let O=new fC.default(c.title,c.data);return c.kind!==void 0&&(O.kind=Zt(c.kind)),c.diagnostics!==void 0&&(O.diagnostics=u(c.diagnostics)),c.edit!==void 0&&(O.edit=await Lt(c.edit,D)),c.command!==void 0&&(O.command=st(c.command)),c.isPreferred!==void 0&&(O.isPreferred=c.isPreferred),c.disabled!==void 0&&(O.disabled={reason:c.disabled.reason}),O}function Xn(c,D){return Re.mapAsync(c,async O=>Z.Command.is(O)?st(O):$n(O,D),D)}function _n(c){if(!c)return;let D=new dC.default(y(c.range));return c.command&&(D.command=st(c.command)),c.data!==void 0&&c.data!==null&&(D.data=c.data),D}async function Jn(c,D){if(c)return Re.map(c,_n,D)}async function Lt(c,D){if(!c)return;let O=new Map;if(c.changeAnnotations!==void 0){let Rt=c.changeAnnotations;await Re.forEach(Object.keys(Rt),xe=>{let Un=w(Rt[xe]);O.set(xe,Un)},D)}let X=Rt=>{if(Rt!==void 0)return O.get(Rt)},ht=new W.WorkspaceEdit;if(c.documentChanges){let Rt=c.documentChanges;await Re.forEach(Rt,xe=>{if(Z.CreateFile.is(xe))ht.createFile(i(xe.uri),xe.options,X(xe.annotationId));else if(Z.RenameFile.is(xe))ht.renameFile(i(xe.oldUri),i(xe.newUri),xe.options,X(xe.annotationId));else if(Z.DeleteFile.is(xe))ht.deleteFile(i(xe.uri),xe.options,X(xe.annotationId));else if(Z.TextDocumentEdit.is(xe)){let Un=i(xe.textDocument.uri);for(let Le of xe.edits)Z.AnnotatedTextEdit.is(Le)?ht.replace(Un,y(Le.range),Le.newText,X(Le.annotationId)):ht.replace(Un,y(Le.range),Le.newText)}else throw new Error(`Unknown workspace edit change received:
${JSON.stringify(xe,void 0,4)}`)},D)}else if(c.changes){let Rt=c.changes;await Re.forEach(Object.keys(Rt),xe=>{ht.set(i(xe),bt(Rt[xe]))},D)}return ht}function w(c){if(c!==void 0)return{label:c.label,needsConfirmation:!!c.needsConfirmation,description:c.description}}function q(c){let D=y(c.range),O=c.target?s(c.target):void 0,X=new lC.default(D,O);return c.tooltip!==void 0&&(X.tooltip=c.tooltip),c.data!==void 0&&c.data!==null&&(X.data=c.data),X}async function U(c,D){if(c)return Re.map(c,q,D)}function K(c){return new W.Color(c.red,c.green,c.blue,c.alpha)}function Ce(c){return new W.ColorInformation(y(c.range),K(c.color))}async function be(c,D){if(c)return Re.map(c,Ce,D)}function Pe(c){let D=new W.ColorPresentation(c.label);return D.additionalTextEdits=bt(c.additionalTextEdits),c.textEdit&&(D.textEdit=Ft(c.textEdit)),D}async function qe(c,D){if(c)return Re.map(c,Pe,D)}function ce(c){if(c)switch(c){case Z.FoldingRangeKind.Comment:return W.FoldingRangeKind.Comment;case Z.FoldingRangeKind.Imports:return W.FoldingRangeKind.Imports;case Z.FoldingRangeKind.Region:return W.FoldingRangeKind.Region}}function Se(c){return new W.FoldingRange(c.startLine,c.endLine,ce(c.kind))}async function ge(c,D){if(c)return Re.map(c,Se,D)}function Fe(c){return new W.SelectionRange(y(c.range),c.parent?Fe(c.parent):void 0)}async function Ze(c,D){return Array.isArray(c)?Re.map(c,Fe,D):[]}function ft(c){return Z.InlineValueText.is(c)?new W.InlineValueText(y(c.range),c.text):Z.InlineValueVariableLookup.is(c)?new W.InlineValueVariableLookup(y(c.range),c.variableName,c.caseSensitiveLookup):new W.InlineValueEvaluatableExpression(y(c.range),c.expression)}async function lr(c,D){return Array.isArray(c)?Re.map(c,ft,D):[]}async function fr(c,D){let O=typeof c.label=="string"?c.label:await Re.map(c.label,f,D),X=new mC.default(S(c.position),O);return c.kind!==void 0&&(X.kind=c.kind),c.textEdits!==void 0&&(X.textEdits=await yt(c.textEdits,D)),c.tooltip!==void 0&&(X.tooltip=k(c.tooltip)),c.paddingLeft!==void 0&&(X.paddingLeft=c.paddingLeft),c.paddingRight!==void 0&&(X.paddingRight=c.paddingRight),c.data!==void 0&&(X.data=c.data),X}function f(c){let D=new W.InlayHintLabelPart(c.value);return c.location!==void 0&&(D.location=wt(c.location)),c.tooltip!==void 0&&(D.tooltip=k(c.tooltip)),c.command!==void 0&&(D.command=st(c.command)),D}function k(c){return typeof c=="string"?c:M(c)}async function B(c,D){if(Array.isArray(c))return Re.mapAsync(c,fr,D)}function De(c){if(c===null)return;let D=new hC.default(ct(c.kind),c.name,c.detail||"",s(c.uri),y(c.range),y(c.selectionRange),c.data);return c.tags!==void 0&&(D.tags=Dn(c.tags)),D}async function _(c,D){if(c!==null)return Re.map(c,De,D)}async function h(c,D){return new W.CallHierarchyIncomingCall(De(c.from),await P(c.fromRanges,D))}async function C(c,D){if(c!==null)return Re.mapAsync(c,h,D)}async function R(c,D){return new W.CallHierarchyOutgoingCall(De(c.to),await P(c.fromRanges,D))}async function v(c,D){if(c!==null)return Re.mapAsync(c,R,D)}async function l(c,D){if(c!=null)return new W.SemanticTokens(new Uint32Array(c.data),c.resultId)}function T(c){return new W.SemanticTokensEdit(c.start,c.deleteCount,c.data!==void 0?new Uint32Array(c.data):void 0)}async function F(c,D){if(c!=null)return new W.SemanticTokensEdits(c.edits.map(T),c.resultId)}function ne(c){return c}async function He(c,D){if(c!=null)return new W.LinkedEditingRanges(await P(c.ranges,D),Oe(c.wordPattern))}function Oe(c){if(c!=null)return new RegExp(c)}function Ut(c){if(c===null)return;let D=new pC.default(ct(c.kind),c.name,c.detail||"",s(c.uri),y(c.range),y(c.selectionRange),c.data);return c.tags!==void 0&&(D.tags=Dn(c.tags)),D}async function en(c,D){if(c!==null)return Re.map(c,Ut,D)}function Tn(c){if(mn.string(c))return c;if(Z.RelativePattern.is(c)){if(Z.URI.is(c.baseUri))return new W.RelativePattern(s(c.baseUri),c.pattern);if(Z.WorkspaceFolder.is(c.baseUri)){let D=W.workspace.getWorkspaceFolder(s(c.baseUri.uri));return D!==void 0?new W.RelativePattern(D,c.pattern):void 0}}}async function fe(c,D){if(!c)return;if(Array.isArray(c))return Re.map(c,ht=>jn(ht),D);let O=c,X=await Re.map(O.items,ht=>jn(ht),D);return new W.InlineCompletionList(X)}function jn(c){let D;typeof c.insertText=="string"?D=c.insertText:D=new W.SnippetString(c.insertText.value);let O;c.command&&(O=st(c.command));let X=new W.InlineCompletionItem(D,y(c.range),O);return c.filterText&&(X.filterText=c.filterText),X}return{asUri:s,asDocumentSelector:o,asDiagnostics:a,asDiagnostic:d,asRange:y,asRanges:P,asPosition:S,asDiagnosticSeverity:E,asDiagnosticTag:g,asHover:H,asCompletionResult:J,asCompletionItem:it,asTextEdit:Ft,asTextEdits:yt,asSignatureHelp:Cn,asSignatureInformations:Fn,asSignatureInformation:Ne,asParameterInformations:$t,asParameterInformation:Ot,asDeclarationResult:cr,asDefinitionResult:On,asLocation:wt,asReferences:ur,asDocumentHighlights:Mn,asDocumentHighlight:Rn,asDocumentHighlightKind:Sn,asSymbolKind:ct,asSymbolTag:Gn,asSymbolTags:Dn,asSymbolInformations:Nn,asSymbolInformation:ln,asDocumentSymbols:dr,asDocumentSymbol:fn,asCommand:st,asCommands:Dt,asCodeAction:$n,asCodeActionKind:Zt,asCodeActionKinds:jt,asCodeActionResult:Xn,asCodeLens:_n,asCodeLenses:Jn,asWorkspaceEdit:Lt,asDocumentLink:q,asDocumentLinks:U,asFoldingRangeKind:ce,asFoldingRange:Se,asFoldingRanges:ge,asColor:K,asColorInformation:Ce,asColorInformations:be,asColorPresentation:Pe,asColorPresentations:qe,asSelectionRange:Fe,asSelectionRanges:Ze,asInlineValue:ft,asInlineValues:lr,asInlayHint:fr,asInlayHints:B,asSemanticTokensLegend:ne,asSemanticTokens:l,asSemanticTokensEdit:T,asSemanticTokensEdits:F,asCallHierarchyItem:De,asCallHierarchyItems:_,asCallHierarchyIncomingCall:h,asCallHierarchyIncomingCalls:C,asCallHierarchyOutgoingCall:R,asCallHierarchyOutgoingCalls:v,asLinkedEditingRanges:He,asTypeHierarchyItem:Ut,asTypeHierarchyItems:en,asGlobPattern:Tn,asInlineCompletionResult:fe,asInlineCompletionItem:jn}}po.createConverter=vC});var Ke=x(vn=>{"use strict";Object.defineProperty(vn,"__esModule",{value:!0});vn.generateUuid=vn.parse=vn.isUUID=vn.v4=vn.empty=void 0;var Vi=class{constructor(e){this._value=e}asHex(){return this._value}equals(e){return this.asHex()===e.asHex()}},zi=class r extends Vi{static _oneOf(e){return e[Math.floor(e.length*Math.random())]}static _randomHex(){return r._oneOf(r._chars)}constructor(){super([r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),"-","4",r._randomHex(),r._randomHex(),r._randomHex(),"-",r._oneOf(r._timeHighBits),r._randomHex(),r._randomHex(),r._randomHex(),"-",r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex(),r._randomHex()].join(""))}};zi._chars=["0","1","2","3","4","5","6","6","7","8","9","a","b","c","d","e","f"];zi._timeHighBits=["8","9","a","b"];vn.empty=new Vi("00000000-0000-0000-0000-000000000000");function Cm(){return new zi}vn.v4=Cm;var yC=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;function Rm(r){return yC.test(r)}vn.isUUID=Rm;function bC(r){if(!Rm(r))throw new Error("invalid uuid");return new Vi(r)}vn.parse=bC;function wC(){return Cm().asHex()}vn.generateUuid=wC});var Hu=x(go=>{"use strict";Object.defineProperty(go,"__esModule",{value:!0});go.ProgressPart=void 0;var Sm=require("vscode"),Dm=re(),_m=hn(),Uu=class{constructor(e,t,n){this._client=e,this._token=t,this._reported=0,this._infinite=!1,this._lspProgressDisposable=this._client.onProgress(Dm.WorkDoneProgress.type,this._token,i=>{switch(i.kind){case"begin":this.begin(i);break;case"report":this.report(i);break;case"end":this.done(),n&&n(this);break}})}begin(e){this._infinite=e.percentage===void 0,this._lspProgressDisposable!==void 0&&Sm.window.withProgress({location:Sm.ProgressLocation.Window,cancellable:e.cancellable,title:e.title},async(t,n)=>{if(this._lspProgressDisposable!==void 0)return this._progress=t,this._cancellationToken=n,this._tokenDisposable=this._cancellationToken.onCancellationRequested(()=>{this._client.sendNotification(Dm.WorkDoneProgressCancelNotification.type,{token:this._token})}),this.report(e),new Promise((i,s)=>{this._resolve=i,this._reject=s})})}report(e){if(this._infinite&&_m.string(e.message))this._progress!==void 0&&this._progress.report({message:e.message});else if(_m.number(e.percentage)){let t=Math.max(0,Math.min(e.percentage,100)),n=Math.max(0,t-this._reported);this._reported+=n,this._progress!==void 0&&this._progress.report({message:e.message,increment:n})}}cancel(){this.cleanup(),this._reject!==void 0&&(this._reject(),this._resolve=void 0,this._reject=void 0)}done(){this.cleanup(),this._resolve!==void 0&&(this._resolve(),this._resolve=void 0,this._reject=void 0)}cleanup(){this._lspProgressDisposable!==void 0&&(this._lspProgressDisposable.dispose(),this._lspProgressDisposable=void 0),this._tokenDisposable!==void 0&&(this._tokenDisposable.dispose(),this._tokenDisposable=void 0),this._progress=void 0,this._cancellationToken=void 0}};go.ProgressPart=Uu});var we=x(gt=>{"use strict";Object.defineProperty(gt,"__esModule",{value:!0});gt.WorkspaceFeature=gt.TextDocumentLanguageFeature=gt.TextDocumentEventFeature=gt.DynamicDocumentFeature=gt.DynamicFeature=gt.StaticFeature=gt.ensure=gt.LSPCancellationError=void 0;var Ar=require("vscode"),Wu=re(),Mt=hn(),Tm=Ke(),Ku=class extends Ar.CancellationError{constructor(e){super(),this.data=e}};gt.LSPCancellationError=Ku;function CC(r,e){return r[e]===void 0&&(r[e]={}),r[e]}gt.ensure=CC;var Pm;(function(r){function e(t){let n=t;return n!=null&&Mt.func(n.fillClientCapabilities)&&Mt.func(n.initialize)&&Mt.func(n.getState)&&Mt.func(n.clear)&&(n.fillInitializeParams===void 0||Mt.func(n.fillInitializeParams))}r.is=e})(Pm||(gt.StaticFeature=Pm={}));var km;(function(r){function e(t){let n=t;return n!=null&&Mt.func(n.fillClientCapabilities)&&Mt.func(n.initialize)&&Mt.func(n.getState)&&Mt.func(n.clear)&&(n.fillInitializeParams===void 0||Mt.func(n.fillInitializeParams))&&Mt.func(n.register)&&Mt.func(n.unregister)&&n.registrationType!==void 0}r.is=e})(km||(gt.DynamicFeature=km={}));var Bi=class{constructor(e){this._client=e}getState(){let e=this.getDocumentSelectors(),t=0;for(let i of e){t++;for(let s of Ar.workspace.textDocuments)if(Ar.languages.match(i,s)>0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}let n=t>0;return{kind:"document",id:this.registrationType.method,registrations:n,matches:!1}}};gt.DynamicDocumentFeature=Bi;var Vu=class extends Bi{static textDocumentFilter(e,t){for(let n of e)if(Ar.languages.match(n,t)>0)return!0;return!1}constructor(e,t,n,i,s,o,a){super(e),this._event=t,this._type=n,this._middleware=i,this._createParams=s,this._textDocument=o,this._selectorFilter=a,this._selectors=new Map,this._onNotificationSent=new Ar.EventEmitter}getStateInfo(){return[this._selectors.values(),!1]}getDocumentSelectors(){return this._selectors.values()}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=this._event(t=>{this.callback(t).catch(n=>{this._client.error(`Sending document notification ${this._type.method} failed.`,n)})})),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}async callback(e){let t=async n=>{let i=this._createParams(n);await this._client.sendNotification(this._type,i),this.notificationSent(this.getTextDocument(n),this._type,i)};if(this.matches(e)){let n=this._middleware();return n?n(e,i=>t(i)):t(e)}}matches(e){return this._client.hasDedicatedTextSynchronizationFeature(this._textDocument(e))?!1:!this._selectorFilter||this._selectorFilter(this._selectors.values(),e)}get onNotificationSent(){return this._onNotificationSent.event}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._onNotificationSent.dispose(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getProvider(e){for(let t of this._selectors.values())if(Ar.languages.match(t,e)>0)return{send:n=>this.callback(n)}}};gt.TextDocumentEventFeature=Vu;var zu=class extends Bi{constructor(e,t){super(e),this._registrationType=t,this._registrations=new Map}*getDocumentSelectors(){for(let e of this._registrations.values()){let t=e.data.registerOptions.documentSelector;t!==null&&(yield this._client.protocol2CodeConverter.asDocumentSelector(t))}}get registrationType(){return this._registrationType}register(e){if(!e.registerOptions.documentSelector)return;let t=this.registerLanguageProvider(e.registerOptions,e.id);this._registrations.set(e.id,{disposable:t[0],data:e,provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getRegistration(e,t){if(t){if(Wu.TextDocumentRegistrationOptions.is(t)){let n=Wu.StaticRegistrationOptions.hasId(t)?t.id:Tm.generateUuid(),i=t.documentSelector??e;if(i)return[n,Object.assign({},t,{documentSelector:i})]}else if(Mt.boolean(t)&&t===!0||Wu.WorkDoneProgressOptions.is(t)){if(!e)return[void 0,void 0];let n=Mt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e});return[Tm.generateUuid(),n]}}else return[void 0,void 0];return[void 0,void 0]}getRegistrationOptions(e,t){if(!(!e||!t))return Mt.boolean(t)&&t===!0?{documentSelector:e}:Object.assign({},t,{documentSelector:e})}getProvider(e){for(let t of this._registrations.values()){let n=t.data.registerOptions.documentSelector;if(n!==null&&Ar.languages.match(this._client.protocol2CodeConverter.asDocumentSelector(n),e)>0)return t.provider}}getAllProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};gt.TextDocumentLanguageFeature=zu;var Bu=class{constructor(e,t){this._client=e,this._registrationType=t,this._registrations=new Map}getState(){let e=this._registrations.size>0;return{kind:"workspace",id:this._registrationType.method,registrations:e}}get registrationType(){return this._registrationType}register(e){let t=this.registerLanguageProvider(e.registerOptions);this._registrations.set(e.id,{disposable:t[0],provider:t[1]})}unregister(e){let t=this._registrations.get(e);t!==void 0&&t.disposable.dispose()}clear(){this._registrations.forEach(e=>{e.disposable.dispose()}),this._registrations.clear()}getProviders(){let e=[];for(let t of this._registrations.values())e.push(t.provider);return e}};gt.WorkspaceFeature=Bu});var xm=x((Z_,Em)=>{var RC=typeof process=="object"&&process&&process.platform==="win32";Em.exports=RC?{sep:"\\"}:{sep:"/"}});var Lm=x((eT,Om)=>{"use strict";Om.exports=qm;function qm(r,e,t){r instanceof RegExp&&(r=Im(r,t)),e instanceof RegExp&&(e=Im(e,t));var n=Fm(r,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+r.length,n[1]),post:t.slice(n[1]+e.length)}}function Im(r,e){var t=e.match(r);return t?t[0]:null}qm.range=Fm;function Fm(r,e,t){var n,i,s,o,a,u=t.indexOf(r),d=t.indexOf(e,u+1),p=u;if(u>=0&&d>0){if(r===e)return[u,d];for(n=[],s=t.length;p>=0&&!a;)p==u?(n.push(p),u=t.indexOf(r,p+1)):n.length==1?a=[n.pop(),d]:(i=n.pop(),i<s&&(s=i,o=d),d=t.indexOf(e,p+1)),p=u<d&&u>=0?u:d;n.length&&(a=[s,o])}return a}});var Wm=x((tT,Hm)=>{var Mm=Lm();Hm.exports=_C;var Nm="\0SLASH"+Math.random()+"\0",Am="\0OPEN"+Math.random()+"\0",Xu="\0CLOSE"+Math.random()+"\0",$m="\0COMMA"+Math.random()+"\0",jm="\0PERIOD"+Math.random()+"\0";function Gu(r){return parseInt(r,10)==r?parseInt(r,10):r.charCodeAt(0)}function SC(r){return r.split("\\\\").join(Nm).split("\\{").join(Am).split("\\}").join(Xu).split("\\,").join($m).split("\\.").join(jm)}function DC(r){return r.split(Nm).join("\\").split(Am).join("{").split(Xu).join("}").split($m).join(",").split(jm).join(".")}function Um(r){if(!r)return[""];var e=[],t=Mm("{","}",r);if(!t)return r.split(",");var n=t.pre,i=t.body,s=t.post,o=n.split(",");o[o.length-1]+="{"+i+"}";var a=Um(s);return s.length&&(o[o.length-1]+=a.shift(),o.push.apply(o,a)),e.push.apply(e,o),e}function _C(r){return r?(r.substr(0,2)==="{}"&&(r="\\{\\}"+r.substr(2)),Gi(SC(r),!0).map(DC)):[]}function TC(r){return"{"+r+"}"}function PC(r){return/^-?0\d/.test(r)}function kC(r,e){return r<=e}function EC(r,e){return r>=e}function Gi(r,e){var t=[],n=Mm("{","}",r);if(!n)return[r];var i=n.pre,s=n.post.length?Gi(n.post,!1):[""];if(/\$$/.test(n.pre))for(var o=0;o<s.length;o++){var a=i+"{"+n.body+"}"+s[o];t.push(a)}else{var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(n.body),d=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(n.body),p=u||d,m=n.body.indexOf(",")>=0;if(!p&&!m)return n.post.match(/,.*\}/)?(r=n.pre+"{"+n.body+Xu+n.post,Gi(r)):[r];var g;if(p)g=n.body.split(/\.\./);else if(g=Um(n.body),g.length===1&&(g=Gi(g[0],!1).map(TC),g.length===1))return s.map(function(it){return n.pre+g[0]+it});var S;if(p){var y=Gu(g[0]),P=Gu(g[1]),E=Math.max(g[0].length,g[1].length),L=g.length==3?Math.abs(Gu(g[2])):1,N=kC,M=P<y;M&&(L*=-1,N=EC);var H=g.some(PC);S=[];for(var J=y;N(J,P);J+=L){var pe;if(d)pe=String.fromCharCode(J),pe==="\\"&&(pe="");else if(pe=String(J),H){var G=E-pe.length;if(G>0){var ee=new Array(G+1).join("0");J<0?pe="-"+ee+pe.slice(1):pe=ee+pe}}S.push(pe)}}else{S=[];for(var de=0;de<g.length;de++)S.push.apply(S,Gi(g[de],!1))}for(var de=0;de<S.length;de++)for(var o=0;o<s.length;o++){var a=i+S[de]+s[o];(!e||p||a)&&t.push(a)}}return t}});var vo=x((rT,ed)=>{var rn=ed.exports=(r,e,t={})=>(mo(e),!t.nocomment&&e.charAt(0)==="#"?!1:new yi(e,t).match(r));ed.exports=rn;var Yu=xm();rn.sep=Yu.sep;var En=Symbol("globstar **");rn.GLOBSTAR=En;var xC=Wm(),Km={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},Zu="[^/]",Ju=Zu+"*?",IC="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",qC="(?:(?!(?:\\/|^)\\.).)*?",Bm=r=>r.split("").reduce((e,t)=>(e[t]=!0,e),{}),Vm=Bm("().*{}+?[]^$\\!"),FC=Bm("[.("),zm=/\/+/;rn.filter=(r,e={})=>(t,n,i)=>rn(t,r,e);var Rr=(r,e={})=>{let t={};return Object.keys(r).forEach(n=>t[n]=r[n]),Object.keys(e).forEach(n=>t[n]=e[n]),t};rn.defaults=r=>{if(!r||typeof r!="object"||!Object.keys(r).length)return rn;let e=rn,t=(n,i,s)=>e(n,i,Rr(r,s));return t.Minimatch=class extends e.Minimatch{constructor(i,s){super(i,Rr(r,s))}},t.Minimatch.defaults=n=>e.defaults(Rr(r,n)).Minimatch,t.filter=(n,i)=>e.filter(n,Rr(r,i)),t.defaults=n=>e.defaults(Rr(r,n)),t.makeRe=(n,i)=>e.makeRe(n,Rr(r,i)),t.braceExpand=(n,i)=>e.braceExpand(n,Rr(r,i)),t.match=(n,i,s)=>e.match(n,i,Rr(r,s)),t};rn.braceExpand=(r,e)=>Gm(r,e);var Gm=(r,e={})=>(mo(r),e.nobrace||!/\{(?:(?!\{).)*\}/.test(r)?[r]:xC(r)),OC=1024*64,mo=r=>{if(typeof r!="string")throw new TypeError("invalid pattern");if(r.length>OC)throw new TypeError("pattern is too long")},Qu=Symbol("subparse");rn.makeRe=(r,e)=>new yi(r,e||{}).makeRe();rn.match=(r,e,t={})=>{let n=new yi(e,t);return r=r.filter(i=>n.match(i)),n.options.nonull&&!r.length&&r.push(e),r};var LC=r=>r.replace(/\\(.)/g,"$1"),MC=r=>r.replace(/\\([^-\]])/g,"$1"),NC=r=>r.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),AC=r=>r.replace(/[[\]\\]/g,"\\$&"),yi=class{constructor(e,t){mo(e),t||(t={}),this.options=t,this.set=[],this.pattern=e,this.windowsPathsNoEscape=!!t.windowsPathsNoEscape||t.allowWindowsEscape===!1,this.windowsPathsNoEscape&&(this.pattern=this.pattern.replace(/\\/g,"/")),this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.partial=!!t.partial,this.make()}debug(){}make(){let e=this.pattern,t=this.options;if(!t.nocomment&&e.charAt(0)==="#"){this.comment=!0;return}if(!e){this.empty=!0;return}this.parseNegate();let n=this.globSet=this.braceExpand();t.debug&&(this.debug=(...i)=>console.error(...i)),this.debug(this.pattern,n),n=this.globParts=n.map(i=>i.split(zm)),this.debug(this.pattern,n),n=n.map((i,s,o)=>i.map(this.parse,this)),this.debug(this.pattern,n),n=n.filter(i=>i.indexOf(!1)===-1),this.debug(this.pattern,n),this.set=n}parseNegate(){if(this.options.nonegate)return;let e=this.pattern,t=!1,n=0;for(let i=0;i<e.length&&e.charAt(i)==="!";i++)t=!t,n++;n&&(this.pattern=e.slice(n)),this.negate=t}matchOne(e,t,n){var i=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var s=0,o=0,a=e.length,u=t.length;s<a&&o<u;s++,o++){this.debug("matchOne loop");var d=t[o],p=e[s];if(this.debug(t,d,p),d===!1)return!1;if(d===En){this.debug("GLOBSTAR",[t,d,p]);var m=s,g=o+1;if(g===u){for(this.debug("** at the end");s<a;s++)if(e[s]==="."||e[s]===".."||!i.dot&&e[s].charAt(0)===".")return!1;return!0}for(;m<a;){var S=e[m];if(this.debug(`
globstar while`,e,m,t,g,S),this.matchOne(e.slice(m),t.slice(g),n))return this.debug("globstar found match!",m,a,S),!0;if(S==="."||S===".."||!i.dot&&S.charAt(0)==="."){this.debug("dot detected!",e,m,t,g);break}this.debug("globstar swallow a segment, and continue"),m++}return!!(n&&(this.debug(`
>>> no match, partial?`,e,m,t,g),m===a))}var y;if(typeof d=="string"?(y=p===d,this.debug("string match",d,p,y)):(y=p.match(d),this.debug("pattern match",d,p,y)),!y)return!1}if(s===a&&o===u)return!0;if(s===a)return n;if(o===u)return s===a-1&&e[s]==="";throw new Error("wtf?")}braceExpand(){return Gm(this.pattern,this.options)}parse(e,t){mo(e);let n=this.options;if(e==="**")if(n.noglobstar)e="*";else return En;if(e==="")return"";let i="",s=!1,o=!1,a=[],u=[],d,p=!1,m=-1,g=-1,S,y,P,E=e.charAt(0)===".",L=n.dot||E,N=()=>E?"":L?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",M=G=>G.charAt(0)==="."?"":n.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",H=()=>{if(d){switch(d){case"*":i+=Ju,s=!0;break;case"?":i+=Zu,s=!0;break;default:i+="\\"+d;break}this.debug("clearStateChar %j %j",d,i),d=!1}};for(let G=0,ee;G<e.length&&(ee=e.charAt(G));G++){if(this.debug("%s	%s %s %j",e,G,i,ee),o){if(ee==="/")return!1;Vm[ee]&&(i+="\\"),i+=ee,o=!1;continue}switch(ee){case"/":return!1;case"\\":if(p&&e.charAt(G+1)==="-"){i+=ee;continue}H(),o=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s	%s %s %j <-- stateChar",e,G,i,ee),p){this.debug("  in class"),ee==="!"&&G===g+1&&(ee="^"),i+=ee;continue}this.debug("call clearStateChar %j",d),H(),d=ee,n.noext&&H();continue;case"(":{if(p){i+="(";continue}if(!d){i+="\\(";continue}let de={type:d,start:G-1,reStart:i.length,open:Km[d].open,close:Km[d].close};this.debug(this.pattern,"	",de),a.push(de),i+=de.open,de.start===0&&de.type!=="!"&&(E=!0,i+=M(e.slice(G+1))),this.debug("plType %j %j",d,i),d=!1;continue}case")":{let de=a[a.length-1];if(p||!de){i+="\\)";continue}a.pop(),H(),s=!0,y=de,i+=y.close,y.type==="!"&&u.push(Object.assign(y,{reEnd:i.length}));continue}case"|":{let de=a[a.length-1];if(p||!de){i+="\\|";continue}H(),i+="|",de.start===0&&de.type!=="!"&&(E=!0,i+=M(e.slice(G+1)));continue}case"[":if(H(),p){i+="\\"+ee;continue}p=!0,g=G,m=i.length,i+=ee;continue;case"]":if(G===g+1||!p){i+="\\"+ee;continue}S=e.substring(g+1,G);try{RegExp("["+AC(MC(S))+"]"),i+=ee}catch{i=i.substring(0,m)+"(?:$.)"}s=!0,p=!1;continue;default:H(),Vm[ee]&&!(ee==="^"&&p)&&(i+="\\"),i+=ee;break}}for(p&&(S=e.slice(g+1),P=this.parse(S,Qu),i=i.substring(0,m)+"\\["+P[0],s=s||P[1]),y=a.pop();y;y=a.pop()){let G;G=i.slice(y.reStart+y.open.length),this.debug("setting tail",i,y),G=G.replace(/((?:\\{2}){0,64})(\\?)\|/g,(de,it,Ye)=>(Ye||(Ye="\\"),it+it+Ye+"|")),this.debug(`tail=%j
   %s`,G,G,y,i);let ee=y.type==="*"?Ju:y.type==="?"?Zu:"\\"+y.type;s=!0,i=i.slice(0,y.reStart)+ee+"\\("+G}H(),o&&(i+="\\\\");let J=FC[i.charAt(0)];for(let G=u.length-1;G>-1;G--){let ee=u[G],de=i.slice(0,ee.reStart),it=i.slice(ee.reStart,ee.reEnd-8),Ye=i.slice(ee.reEnd),at=i.slice(ee.reEnd-8,ee.reEnd)+Ye,dn=de.split(")").length,Ft=de.split("(").length-dn,yt=Ye;for(let Cn=0;Cn<Ft;Cn++)yt=yt.replace(/\)[+*?]?/,"");Ye=yt;let bt=Ye===""&&t!==Qu?"(?:$|\\/)":"";i=de+it+Ye+bt+at}if(i!==""&&s&&(i="(?=.)"+i),J&&(i=N()+i),t===Qu)return[i,s];if(n.nocase&&!s&&(s=e.toUpperCase()!==e.toLowerCase()),!s)return LC(e);let pe=n.nocase?"i":"";try{return Object.assign(new RegExp("^"+i+"$",pe),{_glob:e,_src:i})}catch{return new RegExp("$.")}}makeRe(){if(this.regexp||this.regexp===!1)return this.regexp;let e=this.set;if(!e.length)return this.regexp=!1,this.regexp;let t=this.options,n=t.noglobstar?Ju:t.dot?IC:qC,i=t.nocase?"i":"",s=e.map(o=>(o=o.map(a=>typeof a=="string"?NC(a):a===En?En:a._src).reduce((a,u)=>(a[a.length-1]===En&&u===En||a.push(u),a),[]),o.forEach((a,u)=>{a!==En||o[u-1]===En||(u===0?o.length>1?o[u+1]="(?:\\/|"+n+"\\/)?"+o[u+1]:o[u]=n:u===o.length-1?o[u-1]+="(?:\\/|"+n+")?":(o[u-1]+="(?:\\/|\\/"+n+"\\/)"+o[u+1],o[u+1]=En))}),o.filter(a=>a!==En).join("/"))).join("|");s="^(?:"+s+")$",this.negate&&(s="^(?!"+s+").*$");try{this.regexp=new RegExp(s,i)}catch{this.regexp=!1}return this.regexp}match(e,t=this.partial){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return e==="";if(e==="/"&&t)return!0;let n=this.options;Yu.sep!=="/"&&(e=e.split(Yu.sep).join("/")),e=e.split(zm),this.debug(this.pattern,"split",e);let i=this.set;this.debug(this.pattern,"set",i);let s;for(let o=e.length-1;o>=0&&(s=e[o],!s);o--);for(let o=0;o<i.length;o++){let a=i[o],u=e;if(n.matchBase&&a.length===1&&(u=[s]),this.matchOne(u,a,t))return n.flipNegate?!0:!this.negate}return n.flipNegate?!1:this.negate}static defaults(e){return rn.defaults(e).Minimatch}};rn.Minimatch=yi});var cd=x(Sr=>{"use strict";Object.defineProperty(Sr,"__esModule",{value:!0});Sr.DiagnosticFeature=Sr.DiagnosticPullMode=Sr.vsdiag=void 0;var $C=vo(),me=require("vscode"),nt=re(),jC=Ke(),td=we();function yo(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var yn;(function(r){let e;(function(t){t.full="full",t.unChanged="unChanged"})(e=r.DocumentDiagnosticReportKind||(r.DocumentDiagnosticReportKind={}))})(yn||(Sr.vsdiag=yn={}));var bo;(function(r){r.onType="onType",r.onSave="onSave"})(bo||(Sr.DiagnosticPullMode=bo={}));var Et;(function(r){r.active="open",r.reschedule="reschedule",r.outDated="drop"})(Et||(Et={}));var nd=class r{constructor(){this.open=new Set,this._onOpen=new me.EventEmitter,this._onClose=new me.EventEmitter,r.fillTabResources(this.open);let e=t=>{if(t.closed.length===0&&t.opened.length===0)return;let n=this.open,i=new Set;r.fillTabResources(i);let s=new Set,o=new Set(i);for(let a of n.values())i.has(a)?o.delete(a):s.add(a);if(this.open=i,s.size>0){let a=new Set;for(let u of s)a.add(me.Uri.parse(u));this._onClose.fire(a)}if(o.size>0){let a=new Set;for(let u of o)a.add(me.Uri.parse(u));this._onOpen.fire(a)}};me.window.tabGroups.onDidChangeTabs!==void 0?this.disposable=me.window.tabGroups.onDidChangeTabs(e):this.disposable={dispose:()=>{}}}get onClose(){return this._onClose.event}get onOpen(){return this._onOpen.event}dispose(){this.disposable.dispose()}isActive(e){return e instanceof me.Uri?me.window.activeTextEditor?.document.uri===e:me.window.activeTextEditor?.document===e}isVisible(e){let t=e instanceof me.Uri?e:e.uri;return this.open.has(t.toString())}getTabResources(){let e=new Set;return r.fillTabResources(new Set,e),e}static fillTabResources(e,t){let n=e??new Set;for(let i of me.window.tabGroups.all)for(let s of i.tabs){let o=s.input,a;o instanceof me.TabInputText?a=o.uri:o instanceof me.TabInputTextDiff?a=o.modified:o instanceof me.TabInputCustom&&(a=o.uri),a!==void 0&&!n.has(a.toString())&&(n.add(a.toString()),t!==void 0&&t.add(a))}}},lt;(function(r){r[r.document=1]="document",r[r.workspace=2]="workspace"})(lt||(lt={}));var Zn;(function(r){function e(t){return t instanceof me.Uri?t.toString():t.uri.toString()}r.asKey=e})(Zn||(Zn={}));var rd=class{constructor(){this.documentPullStates=new Map,this.workspacePullStates=new Map}track(e,t,n){let i=e===lt.document?this.documentPullStates:this.workspacePullStates,[s,o,a]=t instanceof me.Uri?[t.toString(),t,n]:[t.uri.toString(),t.uri,t.version],u=i.get(s);return u===void 0&&(u={document:o,pulledVersion:a,resultId:void 0},i.set(s,u)),u}update(e,t,n,i){let s=e===lt.document?this.documentPullStates:this.workspacePullStates,[o,a,u,d]=t instanceof me.Uri?[t.toString(),t,n,i]:[t.uri.toString(),t.uri,t.version,n],p=s.get(o);p===void 0?(p={document:a,pulledVersion:u,resultId:d},s.set(o,p)):(p.pulledVersion=u,p.resultId=d)}unTrack(e,t){let n=Zn.asKey(t);(e===lt.document?this.documentPullStates:this.workspacePullStates).delete(n)}tracks(e,t){let n=Zn.asKey(t);return(e===lt.document?this.documentPullStates:this.workspacePullStates).has(n)}getResultId(e,t){let n=Zn.asKey(t);return(e===lt.document?this.documentPullStates:this.workspacePullStates).get(n)?.resultId}getAllResultIds(){let e=[];for(let[t,n]of this.workspacePullStates)this.documentPullStates.has(t)&&(n=this.documentPullStates.get(t)),n.resultId!==void 0&&e.push({uri:t,value:n.resultId});return e}},id=class{constructor(e,t,n){this.client=e,this.tabs=t,this.options=n,this.isDisposed=!1,this.onDidChangeDiagnosticsEmitter=new me.EventEmitter,this.provider=this.createProvider(),this.diagnostics=me.languages.createDiagnosticCollection(n.identifier),this.openRequests=new Map,this.documentStates=new rd,this.workspaceErrorCounter=0}knows(e,t){let n=t instanceof me.Uri?t:t.uri;return this.documentStates.tracks(e,t)||this.openRequests.has(n.toString())}forget(e,t){this.documentStates.unTrack(e,t)}pull(e,t){if(this.isDisposed)return;let n=e instanceof me.Uri?e:e.uri;this.pullAsync(e).then(()=>{t&&t()},i=>{this.client.error(`Document pull failed for text document ${n.toString()}`,i,!1)})}async pullAsync(e,t){if(this.isDisposed)return;let n=e instanceof me.Uri,i=n?e:e.uri,s=i.toString();t=n?t:e.version;let o=this.openRequests.get(s),a=n?this.documentStates.track(lt.document,e,t):this.documentStates.track(lt.document,e);if(o===void 0){let u=new me.CancellationTokenSource;this.openRequests.set(s,{state:Et.active,document:e,version:t,tokenSource:u});let d,p;try{d=await this.provider.provideDiagnostics(e,a.resultId,u.token)??{kind:yn.DocumentDiagnosticReportKind.full,items:[]}}catch(m){if(m instanceof td.LSPCancellationError&&nt.DiagnosticServerCancellationData.is(m.data)&&m.data.retriggerRequest===!1&&(p={state:Et.outDated,document:e}),p===void 0&&m instanceof me.CancellationError)p={state:Et.reschedule,document:e};else throw m}if(p=p??this.openRequests.get(s),p===void 0){this.client.error(`Lost request state in diagnostic pull model. Clearing diagnostics for ${s}`),this.diagnostics.delete(i);return}if(this.openRequests.delete(s),!this.tabs.isVisible(e)){this.documentStates.unTrack(lt.document,e);return}if(p.state===Et.outDated)return;d!==void 0&&(d.kind===yn.DocumentDiagnosticReportKind.full&&this.diagnostics.set(i,d.items),a.pulledVersion=t,a.resultId=d.resultId),p.state===Et.reschedule&&this.pull(e)}else o.state===Et.active?(o.tokenSource.cancel(),this.openRequests.set(s,{state:Et.reschedule,document:o.document})):o.state===Et.outDated&&this.openRequests.set(s,{state:Et.reschedule,document:o.document})}forgetDocument(e){let t=e instanceof me.Uri?e:e.uri,n=t.toString(),i=this.openRequests.get(n);this.options.workspaceDiagnostics?i!==void 0?this.openRequests.set(n,{state:Et.reschedule,document:e}):this.pull(e,()=>{this.forget(lt.document,e)}):(i!==void 0&&(i.state===Et.active&&i.tokenSource.cancel(),this.openRequests.set(n,{state:Et.outDated,document:e})),this.diagnostics.delete(t),this.forget(lt.document,e))}pullWorkspace(){this.isDisposed||this.pullWorkspaceAsync().then(()=>{this.workspaceTimeout=(0,nt.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3)},e=>{!(e instanceof td.LSPCancellationError)&&!nt.DiagnosticServerCancellationData.is(e.data)&&(this.client.error("Workspace diagnostic pull failed.",e,!1),this.workspaceErrorCounter++),this.workspaceErrorCounter<=5&&(this.workspaceTimeout=(0,nt.RAL)().timer.setTimeout(()=>{this.pullWorkspace()},2e3))})}async pullWorkspaceAsync(){if(!this.provider.provideWorkspaceDiagnostics||this.isDisposed)return;this.workspaceCancellation!==void 0&&(this.workspaceCancellation.cancel(),this.workspaceCancellation=void 0),this.workspaceCancellation=new me.CancellationTokenSource;let e=this.documentStates.getAllResultIds().map(t=>({uri:this.client.protocol2CodeConverter.asUri(t.uri),value:t.value}));await this.provider.provideWorkspaceDiagnostics(e,this.workspaceCancellation.token,t=>{if(!(!t||this.isDisposed))for(let n of t.items)n.kind===yn.DocumentDiagnosticReportKind.full&&(this.documentStates.tracks(lt.document,n.uri)||this.diagnostics.set(n.uri,n.items)),this.documentStates.update(lt.workspace,n.uri,n.version??void 0,n.resultId)})}createProvider(){let e={onDidChangeDiagnostics:this.onDidChangeDiagnosticsEmitter.event,provideDiagnostics:(t,n,i)=>{let s=(a,u,d)=>{let p={identifier:this.options.identifier,textDocument:{uri:this.client.code2ProtocolConverter.asUri(a instanceof me.Uri?a:a.uri)},previousResultId:u};return this.isDisposed===!0||!this.client.isRunning()?{kind:yn.DocumentDiagnosticReportKind.full,items:[]}:this.client.sendRequest(nt.DocumentDiagnosticRequest.type,p,d).then(async m=>m==null||this.isDisposed||d.isCancellationRequested?{kind:yn.DocumentDiagnosticReportKind.full,items:[]}:m.kind===nt.DocumentDiagnosticReportKind.Full?{kind:yn.DocumentDiagnosticReportKind.full,resultId:m.resultId,items:await this.client.protocol2CodeConverter.asDiagnostics(m.items,d)}:{kind:yn.DocumentDiagnosticReportKind.unChanged,resultId:m.resultId},m=>this.client.handleFailedRequest(nt.DocumentDiagnosticRequest.type,d,m,{kind:yn.DocumentDiagnosticReportKind.full,items:[]}))},o=this.client.middleware;return o.provideDiagnostics?o.provideDiagnostics(t,n,i,s):s(t,n,i)}};return this.options.workspaceDiagnostics&&(e.provideWorkspaceDiagnostics=(t,n,i)=>{let s=async d=>d.kind===nt.DocumentDiagnosticReportKind.Full?{kind:yn.DocumentDiagnosticReportKind.full,uri:this.client.protocol2CodeConverter.asUri(d.uri),resultId:d.resultId,version:d.version,items:await this.client.protocol2CodeConverter.asDiagnostics(d.items,n)}:{kind:yn.DocumentDiagnosticReportKind.unChanged,uri:this.client.protocol2CodeConverter.asUri(d.uri),resultId:d.resultId,version:d.version},o=d=>{let p=[];for(let m of d)p.push({uri:this.client.code2ProtocolConverter.asUri(m.uri),value:m.value});return p},a=(d,p)=>{let m=(0,jC.generateUuid)(),g=this.client.onProgress(nt.WorkspaceDiagnosticRequest.partialResult,m,async y=>{if(y==null){i(null);return}let P={items:[]};for(let E of y.items)try{P.items.push(await s(E))}catch(L){this.client.error("Converting workspace diagnostics failed.",L)}i(P)}),S={identifier:this.options.identifier,previousResultIds:o(d),partialResultToken:m};return this.isDisposed===!0||!this.client.isRunning()?{items:[]}:this.client.sendRequest(nt.WorkspaceDiagnosticRequest.type,S,p).then(async y=>{if(p.isCancellationRequested)return{items:[]};let P={items:[]};for(let E of y.items)P.items.push(await s(E));return g.dispose(),i(P),{items:[]}},y=>(g.dispose(),this.client.handleFailedRequest(nt.DocumentDiagnosticRequest.type,p,y,{items:[]})))},u=this.client.middleware;return u.provideWorkspaceDiagnostics?u.provideWorkspaceDiagnostics(t,n,i,a):a(t,n,i)}),e}dispose(){this.isDisposed=!0,this.workspaceCancellation?.cancel(),this.workspaceTimeout?.dispose();for(let[e,t]of this.openRequests)t.state===Et.active&&t.tokenSource.cancel(),this.openRequests.set(e,{state:Et.outDated,document:t.document});this.diagnostics.dispose()}},sd=class{constructor(e){this.diagnosticRequestor=e,this.documents=new nt.LinkedMap,this.isDisposed=!1}add(e){if(this.isDisposed===!0)return;let t=Zn.asKey(e);this.documents.has(t)||(this.documents.set(t,e,nt.Touch.Last),this.trigger())}remove(e){let t=Zn.asKey(e);this.documents.delete(t),this.documents.size===0?this.stop():t===this.endDocumentKey()&&(this.endDocument=this.documents.last)}trigger(){if(this.isDisposed!==!0){if(this.intervalHandle!==void 0){this.endDocument=this.documents.last;return}this.endDocument=this.documents.last,this.intervalHandle=(0,nt.RAL)().timer.setInterval(()=>{let e=this.documents.first;if(e!==void 0){let t=Zn.asKey(e);this.diagnosticRequestor.pull(e),this.documents.set(t,e,nt.Touch.Last),t===this.endDocumentKey()&&this.stop()}},200)}}dispose(){this.isDisposed=!0,this.stop(),this.documents.clear()}stop(){this.intervalHandle?.dispose(),this.intervalHandle=void 0,this.endDocument=void 0}endDocumentKey(){return this.endDocument!==void 0?Zn.asKey(this.endDocument):void 0}},od=class{constructor(e,t,n){let i=e.clientOptions.diagnosticPullOptions??{onChange:!0,onSave:!1},s=e.protocol2CodeConverter.asDocumentSelector(n.documentSelector),o=[],a=y=>{let P=n.documentSelector;if(i.match!==void 0)return i.match(P,y);for(let E of P)if(nt.TextDocumentFilter.is(E)){if(typeof E=="string"||E.language!==void 0&&E.language!=="*"||E.scheme!==void 0&&E.scheme!=="*"&&E.scheme!==y.scheme)return!1;if(E.pattern!==void 0){let L=new $C.Minimatch(E.pattern,{noext:!0});if(!L.makeRe()||!L.match(y.fsPath))return!1}}return!0},u=y=>y instanceof me.Uri?a(y):me.languages.match(s,y)>0&&t.isVisible(y),d=y=>y instanceof me.Uri?this.activeTextDocument?.uri.toString()===y.toString():this.activeTextDocument===y;this.diagnosticRequestor=new id(e,t,n),this.backgroundScheduler=new sd(this.diagnosticRequestor);let p=y=>{!u(y)||!n.interFileDependencies||d(y)||this.backgroundScheduler.add(y)};this.activeTextDocument=me.window.activeTextEditor?.document,me.window.onDidChangeActiveTextEditor(y=>{let P=this.activeTextDocument;this.activeTextDocument=y?.document,P!==void 0&&p(P),this.activeTextDocument!==void 0&&this.backgroundScheduler.remove(this.activeTextDocument)});let m=e.getFeature(nt.DidOpenTextDocumentNotification.method);o.push(m.onNotificationSent(y=>{let P=y.textDocument;this.diagnosticRequestor.knows(lt.document,P)||u(P)&&this.diagnosticRequestor.pull(P,()=>{p(P)})})),o.push(t.onOpen(y=>{for(let P of y){if(this.diagnosticRequestor.knows(lt.document,P))continue;let E=P.toString(),L;for(let N of me.workspace.textDocuments)if(E===N.uri.toString()){L=N;break}L!==void 0&&u(L)&&this.diagnosticRequestor.pull(L,()=>{p(L)})}}));let g=new Set;for(let y of me.workspace.textDocuments)u(y)&&(this.diagnosticRequestor.pull(y,()=>{p(y)}),g.add(y.uri.toString()));if(i.onTabs===!0)for(let y of t.getTabResources())!g.has(y.toString())&&u(y)&&this.diagnosticRequestor.pull(y,()=>{p(y)});if(i.onChange===!0){let y=e.getFeature(nt.DidChangeTextDocumentNotification.method);o.push(y.onNotificationSent(async P=>{let E=P.textDocument;(i.filter===void 0||!i.filter(E,bo.onType))&&this.diagnosticRequestor.knows(lt.document,E)&&this.diagnosticRequestor.pull(E,()=>{this.backgroundScheduler.trigger()})}))}if(i.onSave===!0){let y=e.getFeature(nt.DidSaveTextDocumentNotification.method);o.push(y.onNotificationSent(P=>{let E=P.textDocument;(i.filter===void 0||!i.filter(E,bo.onSave))&&this.diagnosticRequestor.knows(lt.document,E)&&this.diagnosticRequestor.pull(P.textDocument,()=>{this.backgroundScheduler.trigger()})}))}let S=e.getFeature(nt.DidCloseTextDocumentNotification.method);o.push(S.onNotificationSent(y=>{this.cleanUpDocument(y.textDocument)})),t.onClose(y=>{for(let P of y)this.cleanUpDocument(P)}),this.diagnosticRequestor.onDidChangeDiagnosticsEmitter.event(()=>{for(let y of me.workspace.textDocuments)u(y)&&this.diagnosticRequestor.pull(y)}),n.workspaceDiagnostics===!0&&n.identifier!=="da348dc5-c30a-4515-9d98-31ff3be38d14"&&this.diagnosticRequestor.pullWorkspace(),this.disposable=me.Disposable.from(...o,this.backgroundScheduler,this.diagnosticRequestor)}get onDidChangeDiagnosticsEmitter(){return this.diagnosticRequestor.onDidChangeDiagnosticsEmitter}get diagnostics(){return this.diagnosticRequestor.provider}cleanUpDocument(e){this.diagnosticRequestor.knows(lt.document,e)&&(this.diagnosticRequestor.forgetDocument(e),this.backgroundScheduler.remove(e))}},ad=class extends td.TextDocumentLanguageFeature{constructor(e){super(e,nt.DocumentDiagnosticRequest.type)}fillClientCapabilities(e){let t=yo(yo(e,"textDocument"),"diagnostic");t.dynamicRegistration=!0,t.relatedDocumentSupport=!1,yo(yo(e,"workspace"),"diagnostics").refreshSupport=!0}initialize(e,t){this._client.onRequest(nt.DiagnosticRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeDiagnosticsEmitter.fire()});let[i,s]=this.getRegistration(t,e.diagnosticProvider);!i||!s||this.register({id:i,registerOptions:s})}clear(){this.tabs!==void 0&&(this.tabs.dispose(),this.tabs=void 0),super.clear()}registerLanguageProvider(e){this.tabs===void 0&&(this.tabs=new nd);let t=new od(this._client,this.tabs,e);return[t.disposable,t]}};Sr.DiagnosticFeature=ad});var Qm=x(So=>{"use strict";Object.defineProperty(So,"__esModule",{value:!0});So.NotebookDocumentSyncFeature=void 0;var xt=require("vscode"),UC=vo(),er=re(),HC=Ke(),Xm=hn();function Jm(r,e){return r[e]===void 0&&(r[e]={}),r[e]}var bi;(function(r){let e;(function(t){function n(g,S){return{version:g.version,uri:S.asUri(g.uri)}}t.asVersionedNotebookDocumentIdentifier=n;function i(g,S,y){let P=er.NotebookDocument.create(y.asUri(g.uri),g.notebookType,g.version,s(S,y));return Object.keys(g.metadata).length>0&&(P.metadata=o(g.metadata)),P}t.asNotebookDocument=i;function s(g,S){return g.map(y=>a(y,S))}t.asNotebookCells=s;function o(g){return d(new Set,g)}t.asMetadata=o;function a(g,S){let y=er.NotebookCell.create(u(g.kind),S.asUri(g.document.uri));return Object.keys(g.metadata).length>0&&(y.metadata=o(g.metadata)),g.executionSummary!==void 0&&Xm.number(g.executionSummary.executionOrder)&&Xm.boolean(g.executionSummary.success)&&(y.executionSummary={executionOrder:g.executionSummary.executionOrder,success:g.executionSummary.success}),y}t.asNotebookCell=a;function u(g){switch(g){case xt.NotebookCellKind.Markup:return er.NotebookCellKind.Markup;case xt.NotebookCellKind.Code:return er.NotebookCellKind.Code}}function d(g,S){if(g.has(S))throw new Error("Can't deep copy cyclic structures.");if(Array.isArray(S)){let y=[];for(let P of S)if(P!==null&&typeof P=="object"||Array.isArray(P))y.push(d(g,P));else{if(P instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");y.push(P)}return y}else{let y=Object.keys(S),P=Object.create(null);for(let E of y){let L=S[E];if(L!==null&&typeof L=="object"||Array.isArray(L))P[E]=d(g,L);else{if(L instanceof RegExp)throw new Error("Can't transfer regular expressions to the server");P[E]=L}}return P}}function p(g,S){let y=S.asChangeTextDocumentParams(g,g.document.uri,g.document.version);return{document:y.textDocument,changes:y.contentChanges}}t.asTextContentChange=p;function m(g,S){let y=Object.create(null);if(g.metadata&&(y.metadata=r.c2p.asMetadata(g.metadata)),g.cells!==void 0){let P=Object.create(null),E=g.cells;E.structure&&(P.structure={array:{start:E.structure.array.start,deleteCount:E.structure.array.deleteCount,cells:E.structure.array.cells!==void 0?E.structure.array.cells.map(L=>r.c2p.asNotebookCell(L,S)):void 0},didOpen:E.structure.didOpen!==void 0?E.structure.didOpen.map(L=>S.asOpenTextDocumentParams(L.document).textDocument):void 0,didClose:E.structure.didClose!==void 0?E.structure.didClose.map(L=>S.asCloseTextDocumentParams(L.document).textDocument):void 0}),E.data!==void 0&&(P.data=E.data.map(L=>r.c2p.asNotebookCell(L,S))),E.textContent!==void 0&&(P.textContent=E.textContent.map(L=>r.c2p.asTextContentChange(L,S))),Object.keys(P).length>0&&(y.cells=P)}return y}t.asNotebookDocumentChangeEvent=m})(e=r.c2p||(r.c2p={}))})(bi||(bi={}));var ud;(function(r){function e(a,u,d){let p=a.length,m=u.length,g=0;for(;g<m&&g<p&&t(a[g],u[g],d);)g++;if(g<m&&g<p){let S=p-1,y=m-1;for(;S>=0&&y>=0&&t(a[S],u[y],d);)S--,y--;let P=S+1-g,E=g===y+1?void 0:u.slice(g,y+1);return E!==void 0?{start:g,deleteCount:P,cells:E}:{start:g,deleteCount:P}}else return g<m?{start:g,deleteCount:0,cells:u.slice(g)}:g<p?{start:g,deleteCount:p-g}:void 0}r.computeDiff=e;function t(a,u,d=!0){return a.kind!==u.kind||a.document.uri.toString()!==u.document.uri.toString()||a.document.languageId!==u.document.languageId||!n(a.executionSummary,u.executionSummary)?!1:!d||d&&s(a.metadata,u.metadata)}function n(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.executionOrder===u.executionOrder&&a.success===u.success&&i(a.timing,u.timing)}function i(a,u){return a===u?!0:a===void 0||u===void 0?!1:a.startTime===u.startTime&&a.endTime===u.endTime}function s(a,u){if(a===u)return!0;if(a==null||u===null||u===void 0||typeof a!=typeof u||typeof a!="object")return!1;let d=Array.isArray(a),p=Array.isArray(u);if(d!==p)return!1;if(d&&p){if(a.length!==u.length)return!1;for(let m=0;m<a.length;m++)if(!s(a[m],u[m]))return!1}if(o(a)&&o(u)){let m=Object.keys(a),g=Object.keys(u);if(m.length!==g.length||(m.sort(),g.sort(),!s(m,g)))return!1;for(let S=0;S<m.length;S++){let y=m[S];if(!s(a[y],u[y]))return!1}return!0}return!1}function o(a){return a!==null&&typeof a=="object"}r.isObjectLiteral=o})(ud||(ud={}));var dd;(function(r){function e(t,n){if(typeof t=="string")return t==="*"||n.notebookType===t;if(t.notebookType!==void 0&&t.notebookType!=="*"&&n.notebookType!==t.notebookType)return!1;let i=n.uri;if(t.scheme!==void 0&&t.scheme!=="*"&&i.scheme!==t.scheme)return!1;if(t.pattern!==void 0){let s=new UC.Minimatch(t.pattern,{noext:!0});if(!s.makeRe()||!s.match(i.fsPath))return!1}return!0}r.matchNotebook=e})(dd||(dd={}));var wo;(function(r){function e(n){let i=n.notebookSelector,s=[];for(let o of i){let a=(typeof o.notebook=="string"?o.notebook:o.notebook?.notebookType)??"*",u=typeof o.notebook=="string"?void 0:o.notebook?.scheme,d=typeof o.notebook=="string"?void 0:o.notebook?.pattern;if(o.cells!==void 0)for(let p of o.cells)s.push(t(a,u,d,p.language));else s.push(t(a,u,d,void 0))}return s}r.asDocumentSelector=e;function t(n,i,s,o){return i===void 0&&s===void 0?{notebook:n,language:o}:{notebook:{notebookType:n,scheme:i,pattern:s},language:o}}})(wo||(wo={}));var Co;(function(r){function e(t){return{cells:t,uris:new Set(t.map(n=>n.document.uri.toString()))}}r.create=e})(Co||(Co={}));var wi=class{constructor(e,t){this.client=e,this.options=t,this.notebookSyncInfo=new Map,this.notebookDidOpen=new Set,this.disposables=[],this.selector=e.protocol2CodeConverter.asDocumentSelector(wo.asDocumentSelector(t)),xt.workspace.onDidOpenNotebookDocument(n=>{this.notebookDidOpen.add(n.uri.toString()),this.didOpen(n)},void 0,this.disposables);for(let n of xt.workspace.notebookDocuments)this.notebookDidOpen.add(n.uri.toString()),this.didOpen(n);xt.workspace.onDidChangeNotebookDocument(n=>this.didChangeNotebookDocument(n),void 0,this.disposables),this.options.save===!0&&xt.workspace.onDidSaveNotebookDocument(n=>this.didSave(n),void 0,this.disposables),xt.workspace.onDidCloseNotebookDocument(n=>{this.didClose(n),this.notebookDidOpen.delete(n.uri.toString())},void 0,this.disposables)}getState(){for(let e of xt.workspace.notebookDocuments)if(this.getMatchingCells(e)!==void 0)return{kind:"document",id:"$internal",registrations:!0,matches:!0};return{kind:"document",id:"$internal",registrations:!0,matches:!1}}get mode(){return"notebook"}handles(e){return xt.languages.match(this.selector,e)>0}didOpenNotebookCellTextDocument(e,t){if(xt.languages.match(this.selector,t.document)===0||!this.notebookDidOpen.has(e.uri.toString()))return;let n=this.notebookSyncInfo.get(e.uri.toString()),i=this.cellMatches(e,t);if(n!==void 0){let s=n.uris.has(t.document.uri.toString());if(i&&s||!i&&!s)return;if(i){let o=this.getMatchingCells(e);if(o!==void 0){let a=this.asNotebookDocumentChangeEvent(e,void 0,n,o);a!==void 0&&this.doSendChange(a,o).catch(()=>{})}}}else i&&this.doSendOpen(e,[t]).catch(()=>{})}didChangeNotebookCellTextDocument(e,t){xt.languages.match(this.selector,t.document)!==0&&this.doSendChange({notebook:e,cells:{textContent:[t]}},void 0).catch(()=>{})}didCloseNotebookCellTextDocument(e,t){let n=this.notebookSyncInfo.get(e.uri.toString());if(n===void 0)return;let i=t.document.uri,s=n.cells.findIndex(o=>o.document.uri.toString()===i.toString());if(s!==-1)if(s===0&&n.cells.length===1)this.doSendClose(e,n.cells).catch(()=>{});else{let o=n.cells.slice(),a=o.splice(s,1);this.doSendChange({notebook:e,cells:{structure:{array:{start:s,deleteCount:1},didClose:a}}},o).catch(()=>{})}}dispose(){for(let e of this.disposables)e.dispose()}didOpen(e,t=this.getMatchingCells(e),n=this.notebookSyncInfo.get(e.uri.toString())){if(n!==void 0)if(t!==void 0){let i=this.asNotebookDocumentChangeEvent(e,void 0,n,t);i!==void 0&&this.doSendChange(i,t).catch(()=>{})}else this.doSendClose(e,[]).catch(()=>{});else{if(t===void 0)return;this.doSendOpen(e,t).catch(()=>{})}}didChangeNotebookDocument(e){let t=e.notebook,n=this.notebookSyncInfo.get(t.uri.toString());if(n===void 0){if(e.contentChanges.length===0)return;let i=this.getMatchingCells(t);if(i===void 0)return;this.didOpen(t,i,n)}else{let i=this.getMatchingCells(t);if(i===void 0){this.didClose(t,n);return}let s=this.asNotebookDocumentChangeEvent(e.notebook,e,n,i);s!==void 0&&this.doSendChange(s,i).catch(()=>{})}}didSave(e){this.notebookSyncInfo.get(e.uri.toString())!==void 0&&this.doSendSave(e).catch(()=>{})}didClose(e,t=this.notebookSyncInfo.get(e.uri.toString())){if(t===void 0)return;let n=e.getCells().filter(i=>t.uris.has(i.document.uri.toString()));this.doSendClose(e,n).catch(()=>{})}async sendDidOpenNotebookDocument(e){let t=this.getMatchingCells(e);if(t!==void 0)return this.doSendOpen(e,t)}async doSendOpen(e,t){let n=async(s,o)=>{let a=bi.c2p.asNotebookDocument(s,o,this.client.code2ProtocolConverter),u=o.map(d=>this.client.code2ProtocolConverter.asTextDocumentItem(d.document));try{await this.client.sendNotification(er.DidOpenNotebookDocumentNotification.type,{notebookDocument:a,cellTextDocuments:u})}catch(d){throw this.client.error("Sending DidOpenNotebookDocumentNotification failed",d),d}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.set(e.uri.toString(),Co.create(t)),i?.didOpen!==void 0?i.didOpen(e,t,n):n(e,t)}async sendDidChangeNotebookDocument(e){return this.doSendChange(e,void 0)}async doSendChange(e,t=this.getMatchingCells(e.notebook)){let n=async s=>{try{await this.client.sendNotification(er.DidChangeNotebookDocumentNotification.type,{notebookDocument:bi.c2p.asVersionedNotebookDocumentIdentifier(s.notebook,this.client.code2ProtocolConverter),change:bi.c2p.asNotebookDocumentChangeEvent(s,this.client.code2ProtocolConverter)})}catch(o){throw this.client.error("Sending DidChangeNotebookDocumentNotification failed",o),o}},i=this.client.middleware?.notebooks;return e.cells?.structure!==void 0&&this.notebookSyncInfo.set(e.notebook.uri.toString(),Co.create(t??[])),i?.didChange!==void 0?i?.didChange(e,n):n(e)}async sendDidSaveNotebookDocument(e){return this.doSendSave(e)}async doSendSave(e){let t=async i=>{try{await this.client.sendNotification(er.DidSaveNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(i.uri)}})}catch(s){throw this.client.error("Sending DidSaveNotebookDocumentNotification failed",s),s}},n=this.client.middleware?.notebooks;return n?.didSave!==void 0?n.didSave(e,t):t(e)}async sendDidCloseNotebookDocument(e){return this.doSendClose(e,this.getMatchingCells(e)??[])}async doSendClose(e,t){let n=async(s,o)=>{try{await this.client.sendNotification(er.DidCloseNotebookDocumentNotification.type,{notebookDocument:{uri:this.client.code2ProtocolConverter.asUri(s.uri)},cellTextDocuments:o.map(a=>this.client.code2ProtocolConverter.asTextDocumentIdentifier(a.document))})}catch(a){throw this.client.error("Sending DidCloseNotebookDocumentNotification failed",a),a}},i=this.client.middleware?.notebooks;return this.notebookSyncInfo.delete(e.uri.toString()),i?.didClose!==void 0?i.didClose(e,t,n):n(e,t)}asNotebookDocumentChangeEvent(e,t,n,i){if(t!==void 0&&t.notebook!==e)throw new Error("Notebook must be identical");let s={notebook:e};t?.metadata!==void 0&&(s.metadata=bi.c2p.asMetadata(t.metadata));let o;if(t?.cellChanges!==void 0&&t.cellChanges.length>0){let a=[];o=new Set(i.map(u=>u.document.uri.toString()));for(let u of t.cellChanges)o.has(u.cell.document.uri.toString())&&(u.executionSummary!==void 0||u.metadata!==void 0)&&a.push(u.cell);a.length>0&&(s.cells=s.cells??{},s.cells.data=a)}if((t?.contentChanges!==void 0&&t.contentChanges.length>0||t===void 0)&&n!==void 0&&i!==void 0){let a=n.cells,u=i,d=ud.computeDiff(a,u,!1),p,m;if(d!==void 0){p=d.cells===void 0?new Map:new Map(d.cells.map(y=>[y.document.uri.toString(),y])),m=d.deleteCount===0?new Map:new Map(a.slice(d.start,d.start+d.deleteCount).map(y=>[y.document.uri.toString(),y]));for(let y of Array.from(m.keys()))p.has(y)&&(m.delete(y),p.delete(y));s.cells=s.cells??{};let g=[],S=[];if(p.size>0||m.size>0){for(let y of p.values())g.push(y);for(let y of m.values())S.push(y)}s.cells.structure={array:d,didOpen:g,didClose:S}}}return Object.keys(s).length>1?s:void 0}getMatchingCells(e,t=e.getCells()){if(this.options.notebookSelector!==void 0){for(let n of this.options.notebookSelector)if(n.notebook===void 0||dd.matchNotebook(n.notebook,e)){let i=this.filterCells(e,t,n.cells);return i.length===0?void 0:i}}}cellMatches(e,t){let n=this.getMatchingCells(e,[t]);return n!==void 0&&n[0]===t}filterCells(e,t,n){let i=n!==void 0?t.filter(s=>{let o=s.document.languageId;return n.some(a=>a.language==="*"||o===a.language)}):t;return typeof this.client.clientOptions.notebookDocumentOptions?.filterCells=="function"?this.client.clientOptions.notebookDocumentOptions.filterCells(e,i):i}},Ro=class r{constructor(e){this.client=e,this.registrations=new Map,this.registrationType=er.NotebookDocumentSyncRegistrationType.type,xt.workspace.onDidOpenTextDocument(t=>{if(t.uri.scheme!==r.CellScheme)return;let[n,i]=this.findNotebookDocumentAndCell(t);if(!(n===void 0||i===void 0))for(let s of this.registrations.values())s instanceof wi&&s.didOpenNotebookCellTextDocument(n,i)}),xt.workspace.onDidChangeTextDocument(t=>{if(t.contentChanges.length===0)return;let n=t.document;if(n.uri.scheme!==r.CellScheme)return;let[i]=this.findNotebookDocumentAndCell(n);if(i!==void 0)for(let s of this.registrations.values())s instanceof wi&&s.didChangeNotebookCellTextDocument(i,t)}),xt.workspace.onDidCloseTextDocument(t=>{if(t.uri.scheme!==r.CellScheme)return;let[n,i]=this.findNotebookDocumentAndCell(t);if(!(n===void 0||i===void 0))for(let s of this.registrations.values())s instanceof wi&&s.didCloseNotebookCellTextDocument(n,i)})}getState(){if(this.registrations.size===0)return{kind:"document",id:this.registrationType.method,registrations:!1,matches:!1};for(let e of this.registrations.values()){let t=e.getState();if(t.kind==="document"&&t.registrations===!0&&t.matches===!0)return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!0}}return{kind:"document",id:this.registrationType.method,registrations:!0,matches:!1}}fillClientCapabilities(e){let t=Jm(Jm(e,"notebookDocument"),"synchronization");t.dynamicRegistration=!0,t.executionSummarySupport=!0}preInitialize(e){let t=e.notebookDocumentSync;t!==void 0&&(this.dedicatedChannel=this.client.protocol2CodeConverter.asDocumentSelector(wo.asDocumentSelector(t)))}initialize(e){let t=e.notebookDocumentSync;if(t===void 0)return;let n=t.id??HC.generateUuid();this.register({id:n,registerOptions:t})}register(e){let t=new wi(this.client,e.registerOptions);this.registrations.set(e.id,t)}unregister(e){let t=this.registrations.get(e);t&&t.dispose()}clear(){for(let e of this.registrations.values())e.dispose();this.registrations.clear()}handles(e){if(e.uri.scheme!==r.CellScheme)return!1;if(this.dedicatedChannel!==void 0&&xt.languages.match(this.dedicatedChannel,e)>0)return!0;for(let t of this.registrations.values())if(t.handles(e))return!0;return!1}getProvider(e){for(let t of this.registrations.values())if(t.handles(e.document))return t}findNotebookDocumentAndCell(e){let t=e.uri.toString();for(let n of xt.workspace.notebookDocuments)for(let i of n.getCells())if(i.document.uri.toString()===t)return[n,i];return[void 0,void 0]}};So.NotebookDocumentSyncFeature=Ro;Ro.CellScheme="vscode-notebook-cell"});var Zm=x(Dr=>{"use strict";Object.defineProperty(Dr,"__esModule",{value:!0});Dr.SyncConfigurationFeature=Dr.toJSONObject=Dr.ConfigurationFeature=void 0;var Ci=require("vscode"),Xi=re(),WC=hn(),KC=Ke(),Ym=we(),ld=class{constructor(e){this._client=e}getState(){return{kind:"static"}}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.configuration=!0}initialize(){let e=this._client;e.onRequest(Xi.ConfigurationRequest.type,(t,n)=>{let i=o=>{let a=[];for(let u of o.items){let d=u.scopeUri!==void 0&&u.scopeUri!==null?this._client.protocol2CodeConverter.asUri(u.scopeUri):void 0;a.push(this.getConfiguration(d,u.section!==null?u.section:void 0))}return a},s=e.middleware.workspace;return s&&s.configuration?s.configuration(t,n,i):i(t,n)})}getConfiguration(e,t){let n=null;if(t){let i=t.lastIndexOf(".");if(i===-1)n=$r(Ci.workspace.getConfiguration(void 0,e).get(t));else{let s=Ci.workspace.getConfiguration(t.substr(0,i),e);s&&(n=$r(s.get(t.substr(i+1))))}}else{let i=Ci.workspace.getConfiguration(void 0,e);n={};for(let s of Object.keys(i))i.has(s)&&(n[s]=$r(i.get(s)))}return n===void 0&&(n=null),n}clear(){}};Dr.ConfigurationFeature=ld;function $r(r){if(r){if(Array.isArray(r))return r.map($r);if(typeof r=="object"){let e=Object.create(null);for(let t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=$r(r[t]));return e}}return r}Dr.toJSONObject=$r;var fd=class{constructor(e){this._client=e,this.isCleared=!1,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return Xi.DidChangeConfigurationNotification.type}fillClientCapabilities(e){(0,Ym.ensure)((0,Ym.ensure)(e,"workspace"),"didChangeConfiguration").dynamicRegistration=!0}initialize(){this.isCleared=!1;let e=this._client.clientOptions.synchronize?.configurationSection;e!==void 0&&this.register({id:KC.generateUuid(),registerOptions:{section:e}})}register(e){let t=Ci.workspace.onDidChangeConfiguration(n=>{this.onDidChangeConfiguration(e.registerOptions.section,n)});this._listeners.set(e.id,t),e.registerOptions.section!==void 0&&this.onDidChangeConfiguration(e.registerOptions.section,void 0)}unregister(e){let t=this._listeners.get(e);t&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear(),this.isCleared=!0}onDidChangeConfiguration(e,t){if(this.isCleared)return;let n;if(WC.string(e)?n=[e]:n=e,n!==void 0&&t!==void 0&&!n.some(a=>t.affectsConfiguration(a)))return;let i=async o=>o===void 0?this._client.sendNotification(Xi.DidChangeConfigurationNotification.type,{settings:null}):this._client.sendNotification(Xi.DidChangeConfigurationNotification.type,{settings:this.extractSettingsInformation(o)}),s=this._client.middleware.workspace?.didChangeConfiguration;(s?s(n,i):i(n)).catch(o=>{this._client.error(`Sending notification ${Xi.DidChangeConfigurationNotification.type.method} failed`,o)})}extractSettingsInformation(e){function t(s,o){let a=s;for(let u=0;u<o.length-1;u++){let d=a[o[u]];d||(d=Object.create(null),a[o[u]]=d),a=d}return a}let n=this._client.clientOptions.workspaceFolder?this._client.clientOptions.workspaceFolder.uri:void 0,i=Object.create(null);for(let s=0;s<e.length;s++){let o=e[s],a=o.indexOf("."),u=null;if(a>=0?u=Ci.workspace.getConfiguration(o.substr(0,a),n).get(o.substr(a+1)):u=Ci.workspace.getConfiguration(void 0,n).get(o),u){let d=e[s].split(".");t(i,d)[d[d.length-1]]=$r(u)}}return i}};Dr.SyncConfigurationFeature=fd});var ev=x(zt=>{"use strict";Object.defineProperty(zt,"__esModule",{value:!0});zt.DidSaveTextDocumentFeature=zt.WillSaveWaitUntilFeature=zt.WillSaveFeature=zt.DidChangeTextDocumentFeature=zt.DidCloseTextDocumentFeature=zt.DidOpenTextDocumentFeature=void 0;var sn=require("vscode"),Me=re(),Ge=we(),Ri=Ke(),hd=class extends Ge.TextDocumentEventFeature{constructor(e,t){super(e,sn.workspace.onDidOpenTextDocument,Me.DidOpenTextDocumentNotification.type,()=>e.middleware.didOpen,n=>e.code2ProtocolConverter.asOpenTextDocumentParams(n),n=>n,Ge.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t}get openDocuments(){return this._syncedDocuments.values()}fillClientCapabilities(e){(0,Ge.ensure)((0,Ge.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:Ri.generateUuid(),registerOptions:{documentSelector:t}})}get registrationType(){return Me.DidOpenTextDocumentNotification.type}register(e){if(super.register(e),!e.registerOptions.documentSelector)return;let t=this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector);sn.workspace.textDocuments.forEach(n=>{let i=n.uri.toString();if(!this._syncedDocuments.has(i)&&sn.languages.match(t,n)>0&&!this._client.hasDedicatedTextSynchronizationFeature(n)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));(s.didOpen?s.didOpen(n,o):o(n)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)}),this._syncedDocuments.set(i,n)}})}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.set(e.uri.toString(),e),super.notificationSent(e,t,n)}};zt.DidOpenTextDocumentFeature=hd;var pd=class extends Ge.TextDocumentEventFeature{constructor(e,t,n){super(e,sn.workspace.onDidCloseTextDocument,Me.DidCloseTextDocumentNotification.type,()=>e.middleware.didClose,i=>e.code2ProtocolConverter.asCloseTextDocumentParams(i),i=>i,Ge.TextDocumentEventFeature.textDocumentFilter),this._syncedDocuments=t,this._pendingTextDocumentChanges=n}get registrationType(){return Me.DidCloseTextDocumentNotification.type}fillClientCapabilities(e){(0,Ge.ensure)((0,Ge.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.openClose&&this.register({id:Ri.generateUuid(),registerOptions:{documentSelector:t}})}async callback(e){await super.callback(e),this._pendingTextDocumentChanges.delete(e.uri.toString())}getTextDocument(e){return e}notificationSent(e,t,n){this._syncedDocuments.delete(e.uri.toString()),super.notificationSent(e,t,n)}unregister(e){let t=this._selectors.get(e);super.unregister(e);let n=this._selectors.values();this._syncedDocuments.forEach(i=>{if(sn.languages.match(t,i)>0&&!this._selectorFilter(n,i)&&!this._client.hasDedicatedTextSynchronizationFeature(i)){let s=this._client.middleware,o=a=>this._client.sendNotification(this._type,this._createParams(a));this._syncedDocuments.delete(i.uri.toString()),(s.didClose?s.didClose(i,o):o(i)).catch(a=>{this._client.error(`Sending document notification ${this._type.method} failed`,a)})}})}};zt.DidCloseTextDocumentFeature=pd;var gd=class extends Ge.DynamicDocumentFeature{constructor(e,t){super(e),this._changeData=new Map,this._onNotificationSent=new sn.EventEmitter,this._onPendingChangeAdded=new sn.EventEmitter,this._pendingTextDocumentChanges=t,this._syncKind=Me.TextDocumentSyncKind.None}get onNotificationSent(){return this._onNotificationSent.event}get onPendingChangeAdded(){return this._onPendingChangeAdded.event}get syncKind(){return this._syncKind}get registrationType(){return Me.DidChangeTextDocumentNotification.type}fillClientCapabilities(e){(0,Ge.ensure)((0,Ge.ensure)(e,"textDocument"),"synchronization").dynamicRegistration=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.change!==void 0&&n.change!==Me.TextDocumentSyncKind.None&&this.register({id:Ri.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},{syncKind:n.change})})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=sn.workspace.onDidChangeTextDocument(this.callback,this)),this._changeData.set(e.id,{syncKind:e.registerOptions.syncKind,documentSelector:this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)}),this.updateSyncKind(e.registerOptions.syncKind))}*getDocumentSelectors(){for(let e of this._changeData.values())yield e.documentSelector}async callback(e){if(e.contentChanges.length===0)return;let t=e.document.uri,n=e.document.version,i=[];for(let s of this._changeData.values())if(sn.languages.match(s.documentSelector,e.document)>0&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let o=this._client.middleware;if(s.syncKind===Me.TextDocumentSyncKind.Incremental){let a=async u=>{let d=this._client.code2ProtocolConverter.asChangeTextDocumentParams(u,t,n);await this._client.sendNotification(Me.DidChangeTextDocumentNotification.type,d),this.notificationSent(u.document,Me.DidChangeTextDocumentNotification.type,d)};i.push(o.didChange?o.didChange(e,u=>a(u)):a(e))}else if(s.syncKind===Me.TextDocumentSyncKind.Full){let a=async u=>{let d=u.document.uri.toString();this._pendingTextDocumentChanges.set(d,u.document),this._onPendingChangeAdded.fire()};i.push(o.didChange?o.didChange(e,u=>a(u)):a(e))}}return Promise.all(i).then(void 0,s=>{throw this._client.error(`Sending document notification ${Me.DidChangeTextDocumentNotification.type.method} failed`,s),s})}notificationSent(e,t,n){this._onNotificationSent.fire({textDocument:e,type:t,params:n})}unregister(e){if(this._changeData.delete(e),this._changeData.size===0)this._listener&&(this._listener.dispose(),this._listener=void 0),this._syncKind=Me.TextDocumentSyncKind.None;else{this._syncKind=Me.TextDocumentSyncKind.None;for(let t of this._changeData.values())if(this.updateSyncKind(t.syncKind),this._syncKind===Me.TextDocumentSyncKind.Full)break}}clear(){this._pendingTextDocumentChanges.clear(),this._changeData.clear(),this._syncKind=Me.TextDocumentSyncKind.None,this._listener&&(this._listener.dispose(),this._listener=void 0)}getPendingDocumentChanges(e){if(this._pendingTextDocumentChanges.size===0)return[];let t;if(e.size===0)t=Array.from(this._pendingTextDocumentChanges.values()),this._pendingTextDocumentChanges.clear();else{t=[];for(let n of this._pendingTextDocumentChanges)e.has(n[0])||(t.push(n[1]),this._pendingTextDocumentChanges.delete(n[0]))}return t}getProvider(e){for(let t of this._changeData.values())if(sn.languages.match(t.documentSelector,e)>0)return{send:n=>this.callback(n)}}updateSyncKind(e){if(this._syncKind!==Me.TextDocumentSyncKind.Full)switch(e){case Me.TextDocumentSyncKind.Full:this._syncKind=e;break;case Me.TextDocumentSyncKind.Incremental:this._syncKind===Me.TextDocumentSyncKind.None&&(this._syncKind=Me.TextDocumentSyncKind.Incremental);break}}};zt.DidChangeTextDocumentFeature=gd;var md=class extends Ge.TextDocumentEventFeature{constructor(e){super(e,sn.workspace.onWillSaveTextDocument,Me.WillSaveTextDocumentNotification.type,()=>e.middleware.willSave,t=>e.code2ProtocolConverter.asWillSaveTextDocumentParams(t),t=>t.document,(t,n)=>Ge.TextDocumentEventFeature.textDocumentFilter(t,n.document))}get registrationType(){return Me.WillSaveTextDocumentNotification.type}fillClientCapabilities(e){let t=(0,Ge.ensure)((0,Ge.ensure)(e,"textDocument"),"synchronization");t.willSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSave&&this.register({id:Ri.generateUuid(),registerOptions:{documentSelector:t}})}getTextDocument(e){return e.document}};zt.WillSaveFeature=md;var vd=class extends Ge.DynamicDocumentFeature{constructor(e){super(e),this._selectors=new Map}getDocumentSelectors(){return this._selectors.values()}get registrationType(){return Me.WillSaveTextDocumentWaitUntilRequest.type}fillClientCapabilities(e){let t=(0,Ge.ensure)((0,Ge.ensure)(e,"textDocument"),"synchronization");t.willSaveWaitUntil=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;t&&n&&n.willSaveWaitUntil&&this.register({id:Ri.generateUuid(),registerOptions:{documentSelector:t}})}register(e){e.registerOptions.documentSelector&&(this._listener||(this._listener=sn.workspace.onWillSaveTextDocument(this.callback,this)),this._selectors.set(e.id,this._client.protocol2CodeConverter.asDocumentSelector(e.registerOptions.documentSelector)))}callback(e){if(Ge.TextDocumentEventFeature.textDocumentFilter(this._selectors.values(),e.document)&&!this._client.hasDedicatedTextSynchronizationFeature(e.document)){let t=this._client.middleware,n=i=>this._client.sendRequest(Me.WillSaveTextDocumentWaitUntilRequest.type,this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(i)).then(async s=>{let o=await this._client.protocol2CodeConverter.asTextEdits(s);return o===void 0?[]:o});e.waitUntil(t.willSaveWaitUntil?t.willSaveWaitUntil(e,n):n(e))}}unregister(e){this._selectors.delete(e),this._selectors.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._selectors.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}};zt.WillSaveWaitUntilFeature=vd;var yd=class extends Ge.TextDocumentEventFeature{constructor(e){super(e,sn.workspace.onDidSaveTextDocument,Me.DidSaveTextDocumentNotification.type,()=>e.middleware.didSave,t=>e.code2ProtocolConverter.asSaveTextDocumentParams(t,this._includeText),t=>t,Ge.TextDocumentEventFeature.textDocumentFilter),this._includeText=!1}get registrationType(){return Me.DidSaveTextDocumentNotification.type}fillClientCapabilities(e){(0,Ge.ensure)((0,Ge.ensure)(e,"textDocument"),"synchronization").didSave=!0}initialize(e,t){let n=e.resolvedTextDocumentSync;if(t&&n&&n.save){let i=typeof n.save=="boolean"?{includeText:!1}:{includeText:!!n.save.includeText};this.register({id:Ri.generateUuid(),registerOptions:Object.assign({},{documentSelector:t},i)})}}register(e){this._includeText=!!e.registerOptions.includeText,super.register(e)}getTextDocument(e){return e}};zt.DidSaveTextDocumentFeature=yd});var tv=x(Do=>{"use strict";Object.defineProperty(Do,"__esModule",{value:!0});Do.CompletionItemFeature=void 0;var VC=require("vscode"),ve=re(),bd=we(),zC=Ke(),BC=[ve.CompletionItemKind.Text,ve.CompletionItemKind.Method,ve.CompletionItemKind.Function,ve.CompletionItemKind.Constructor,ve.CompletionItemKind.Field,ve.CompletionItemKind.Variable,ve.CompletionItemKind.Class,ve.CompletionItemKind.Interface,ve.CompletionItemKind.Module,ve.CompletionItemKind.Property,ve.CompletionItemKind.Unit,ve.CompletionItemKind.Value,ve.CompletionItemKind.Enum,ve.CompletionItemKind.Keyword,ve.CompletionItemKind.Snippet,ve.CompletionItemKind.Color,ve.CompletionItemKind.File,ve.CompletionItemKind.Reference,ve.CompletionItemKind.Folder,ve.CompletionItemKind.EnumMember,ve.CompletionItemKind.Constant,ve.CompletionItemKind.Struct,ve.CompletionItemKind.Event,ve.CompletionItemKind.Operator,ve.CompletionItemKind.TypeParameter],wd=class extends bd.TextDocumentLanguageFeature{constructor(e){super(e,ve.CompletionRequest.type),this.labelDetailsSupport=new Map}fillClientCapabilities(e){let t=(0,bd.ensure)((0,bd.ensure)(e,"textDocument"),"completion");t.dynamicRegistration=!0,t.contextSupport=!0,t.completionItem={snippetSupport:!0,commitCharactersSupport:!0,documentationFormat:[ve.MarkupKind.Markdown,ve.MarkupKind.PlainText],deprecatedSupport:!0,preselectSupport:!0,tagSupport:{valueSet:[ve.CompletionItemTag.Deprecated]},insertReplaceSupport:!0,resolveSupport:{properties:["documentation","detail","additionalTextEdits"]},insertTextModeSupport:{valueSet:[ve.InsertTextMode.asIs,ve.InsertTextMode.adjustIndentation]},labelDetailsSupport:!0},t.insertTextMode=ve.InsertTextMode.adjustIndentation,t.completionItemKind={valueSet:BC},t.completionList={itemDefaults:["commitCharacters","editRange","insertTextFormat","insertTextMode","data"]}}initialize(e,t){let n=this.getRegistrationOptions(t,e.completionProvider);n&&this.register({id:zC.generateUuid(),registerOptions:n})}registerLanguageProvider(e,t){this.labelDetailsSupport.set(t,!!e.completionItem?.labelDetailsSupport);let n=e.triggerCharacters??[],i=e.allCommitCharacters,s=e.documentSelector,o={provideCompletionItems:(a,u,d,p)=>{let m=this._client,g=this._client.middleware,S=(y,P,E,L)=>m.sendRequest(ve.CompletionRequest.type,m.code2ProtocolConverter.asCompletionParams(y,P,E),L).then(N=>L.isCancellationRequested?null:m.protocol2CodeConverter.asCompletionResult(N,i,L),N=>m.handleFailedRequest(ve.CompletionRequest.type,L,N,null));return g.provideCompletionItem?g.provideCompletionItem(a,u,p,d,S):S(a,u,p,d)},resolveCompletionItem:e.resolveProvider?(a,u)=>{let d=this._client,p=this._client.middleware,m=(g,S)=>d.sendRequest(ve.CompletionResolveRequest.type,d.code2ProtocolConverter.asCompletionItem(g,!!this.labelDetailsSupport.get(t)),S).then(y=>S.isCancellationRequested?null:d.protocol2CodeConverter.asCompletionItem(y),y=>d.handleFailedRequest(ve.CompletionResolveRequest.type,S,y,g));return p.resolveCompletionItem?p.resolveCompletionItem(a,u,m):m(a,u)}:void 0};return[VC.languages.registerCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(s),o,...n),o]}};Do.CompletionItemFeature=wd});var nv=x(_o=>{"use strict";Object.defineProperty(_o,"__esModule",{value:!0});_o.HoverFeature=void 0;var GC=require("vscode"),Ji=re(),Cd=we(),XC=Ke(),Rd=class extends Cd.TextDocumentLanguageFeature{constructor(e){super(e,Ji.HoverRequest.type)}fillClientCapabilities(e){let t=(0,Cd.ensure)((0,Cd.ensure)(e,"textDocument"),"hover");t.dynamicRegistration=!0,t.contentFormat=[Ji.MarkupKind.Markdown,Ji.MarkupKind.PlainText]}initialize(e,t){let n=this.getRegistrationOptions(t,e.hoverProvider);n&&this.register({id:XC.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideHover:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(Ji.HoverRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asHover(S),S=>a.handleFailedRequest(Ji.HoverRequest.type,g,S,null)),d=a.middleware;return d.provideHover?d.provideHover(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return GC.languages.registerHoverProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};_o.HoverFeature=Rd});var rv=x(To=>{"use strict";Object.defineProperty(To,"__esModule",{value:!0});To.DefinitionFeature=void 0;var JC=require("vscode"),Sd=re(),Dd=we(),QC=Ke(),_d=class extends Dd.TextDocumentLanguageFeature{constructor(e){super(e,Sd.DefinitionRequest.type)}fillClientCapabilities(e){let t=(0,Dd.ensure)((0,Dd.ensure)(e,"textDocument"),"definition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.definitionProvider);n&&this.register({id:QC.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDefinition:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(Sd.DefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(S,g),S=>a.handleFailedRequest(Sd.DefinitionRequest.type,g,S,null)),d=a.middleware;return d.provideDefinition?d.provideDefinition(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return JC.languages.registerDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};To.DefinitionFeature=_d});var sv=x(Po=>{"use strict";Object.defineProperty(Po,"__esModule",{value:!0});Po.SignatureHelpFeature=void 0;var iv=require("vscode"),Qi=re(),Td=we(),YC=Ke(),Pd=class extends Td.TextDocumentLanguageFeature{constructor(e){super(e,Qi.SignatureHelpRequest.type)}fillClientCapabilities(e){let t=(0,Td.ensure)((0,Td.ensure)(e,"textDocument"),"signatureHelp");t.dynamicRegistration=!0,t.signatureInformation={documentationFormat:[Qi.MarkupKind.Markdown,Qi.MarkupKind.PlainText]},t.signatureInformation.parameterInformation={labelOffsetSupport:!0},t.signatureInformation.activeParameterSupport=!0,t.contextSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.signatureHelpProvider);n&&this.register({id:YC.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t={provideSignatureHelp:(n,i,s,o)=>{let a=this._client,u=(p,m,g,S)=>a.sendRequest(Qi.SignatureHelpRequest.type,a.code2ProtocolConverter.asSignatureHelpParams(p,m,g),S).then(y=>S.isCancellationRequested?null:a.protocol2CodeConverter.asSignatureHelp(y,S),y=>a.handleFailedRequest(Qi.SignatureHelpRequest.type,S,y,null)),d=a.middleware;return d.provideSignatureHelp?d.provideSignatureHelp(n,i,o,s,u):u(n,i,o,s)}};return[this.registerProvider(e,t),t]}registerProvider(e,t){let n=this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector);if(e.retriggerCharacters===void 0){let i=e.triggerCharacters||[];return iv.languages.registerSignatureHelpProvider(n,t,...i)}else{let i={triggerCharacters:e.triggerCharacters||[],retriggerCharacters:e.retriggerCharacters||[]};return iv.languages.registerSignatureHelpProvider(n,t,i)}}};Po.SignatureHelpFeature=Pd});var ov=x(ko=>{"use strict";Object.defineProperty(ko,"__esModule",{value:!0});ko.DocumentHighlightFeature=void 0;var ZC=require("vscode"),kd=re(),Ed=we(),eR=Ke(),xd=class extends Ed.TextDocumentLanguageFeature{constructor(e){super(e,kd.DocumentHighlightRequest.type)}fillClientCapabilities(e){(0,Ed.ensure)((0,Ed.ensure)(e,"textDocument"),"documentHighlight").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentHighlightProvider);n&&this.register({id:eR.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentHighlights:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(kd.DocumentHighlightRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asDocumentHighlights(S,g),S=>a.handleFailedRequest(kd.DocumentHighlightRequest.type,g,S,null)),d=a.middleware;return d.provideDocumentHighlights?d.provideDocumentHighlights(i,s,o,u):u(i,s,o)}};return[ZC.languages.registerDocumentHighlightProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};ko.DocumentHighlightFeature=xd});var Fd=x(Vn=>{"use strict";Object.defineProperty(Vn,"__esModule",{value:!0});Vn.DocumentSymbolFeature=Vn.SupportedSymbolTags=Vn.SupportedSymbolKinds=void 0;var tR=require("vscode"),Te=re(),Id=we(),nR=Ke();Vn.SupportedSymbolKinds=[Te.SymbolKind.File,Te.SymbolKind.Module,Te.SymbolKind.Namespace,Te.SymbolKind.Package,Te.SymbolKind.Class,Te.SymbolKind.Method,Te.SymbolKind.Property,Te.SymbolKind.Field,Te.SymbolKind.Constructor,Te.SymbolKind.Enum,Te.SymbolKind.Interface,Te.SymbolKind.Function,Te.SymbolKind.Variable,Te.SymbolKind.Constant,Te.SymbolKind.String,Te.SymbolKind.Number,Te.SymbolKind.Boolean,Te.SymbolKind.Array,Te.SymbolKind.Object,Te.SymbolKind.Key,Te.SymbolKind.Null,Te.SymbolKind.EnumMember,Te.SymbolKind.Struct,Te.SymbolKind.Event,Te.SymbolKind.Operator,Te.SymbolKind.TypeParameter];Vn.SupportedSymbolTags=[Te.SymbolTag.Deprecated];var qd=class extends Id.TextDocumentLanguageFeature{constructor(e){super(e,Te.DocumentSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Id.ensure)((0,Id.ensure)(e,"textDocument"),"documentSymbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:Vn.SupportedSymbolKinds},t.hierarchicalDocumentSymbolSupport=!0,t.tagSupport={valueSet:Vn.SupportedSymbolTags},t.labelSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentSymbolProvider);n&&this.register({id:nR.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentSymbols:(s,o)=>{let a=this._client,u=async(p,m)=>{try{let g=await a.sendRequest(Te.DocumentSymbolRequest.type,a.code2ProtocolConverter.asDocumentSymbolParams(p),m);if(m.isCancellationRequested||g===void 0||g===null)return null;if(g.length===0)return[];{let S=g[0];return Te.DocumentSymbol.is(S)?await a.protocol2CodeConverter.asDocumentSymbols(g,m):await a.protocol2CodeConverter.asSymbolInformations(g,m)}}catch(g){return a.handleFailedRequest(Te.DocumentSymbolRequest.type,m,g,null)}},d=a.middleware;return d.provideDocumentSymbols?d.provideDocumentSymbols(s,o,u):u(s,o)}},i=e.label!==void 0?{label:e.label}:void 0;return[tR.languages.registerDocumentSymbolProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,i),n]}};Vn.DocumentSymbolFeature=qd});var cv=x(Eo=>{"use strict";Object.defineProperty(Eo,"__esModule",{value:!0});Eo.WorkspaceSymbolFeature=void 0;var rR=require("vscode"),Yi=re(),Od=we(),av=Fd(),iR=Ke(),Ld=class extends Od.WorkspaceFeature{constructor(e){super(e,Yi.WorkspaceSymbolRequest.type)}fillClientCapabilities(e){let t=(0,Od.ensure)((0,Od.ensure)(e,"workspace"),"symbol");t.dynamicRegistration=!0,t.symbolKind={valueSet:av.SupportedSymbolKinds},t.tagSupport={valueSet:av.SupportedSymbolTags},t.resolveSupport={properties:["location.range"]}}initialize(e){e.workspaceSymbolProvider&&this.register({id:iR.generateUuid(),registerOptions:e.workspaceSymbolProvider===!0?{workDoneProgress:!1}:e.workspaceSymbolProvider})}registerLanguageProvider(e){let t={provideWorkspaceSymbols:(n,i)=>{let s=this._client,o=(u,d)=>s.sendRequest(Yi.WorkspaceSymbolRequest.type,{query:u},d).then(p=>d.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformations(p,d),p=>s.handleFailedRequest(Yi.WorkspaceSymbolRequest.type,d,p,null)),a=s.middleware;return a.provideWorkspaceSymbols?a.provideWorkspaceSymbols(n,i,o):o(n,i)},resolveWorkspaceSymbol:e.resolveProvider===!0?(n,i)=>{let s=this._client,o=(u,d)=>s.sendRequest(Yi.WorkspaceSymbolResolveRequest.type,s.code2ProtocolConverter.asWorkspaceSymbol(u),d).then(p=>d.isCancellationRequested?null:s.protocol2CodeConverter.asSymbolInformation(p),p=>s.handleFailedRequest(Yi.WorkspaceSymbolResolveRequest.type,d,p,null)),a=s.middleware;return a.resolveWorkspaceSymbol?a.resolveWorkspaceSymbol(n,i,o):o(n,i)}:void 0};return[rR.languages.registerWorkspaceSymbolProvider(t),t]}};Eo.WorkspaceSymbolFeature=Ld});var uv=x(xo=>{"use strict";Object.defineProperty(xo,"__esModule",{value:!0});xo.ReferencesFeature=void 0;var sR=require("vscode"),Md=re(),Nd=we(),oR=Ke(),Ad=class extends Nd.TextDocumentLanguageFeature{constructor(e){super(e,Md.ReferencesRequest.type)}fillClientCapabilities(e){(0,Nd.ensure)((0,Nd.ensure)(e,"textDocument"),"references").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.referencesProvider);n&&this.register({id:oR.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideReferences:(i,s,o,a)=>{let u=this._client,d=(m,g,S,y)=>u.sendRequest(Md.ReferencesRequest.type,u.code2ProtocolConverter.asReferenceParams(m,g,S),y).then(P=>y.isCancellationRequested?null:u.protocol2CodeConverter.asReferences(P,y),P=>u.handleFailedRequest(Md.ReferencesRequest.type,y,P,null)),p=u.middleware;return p.provideReferences?p.provideReferences(i,s,o,a,d):d(i,s,o,a)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return sR.languages.registerReferenceProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};xo.ReferencesFeature=Ad});var dv=x(Io=>{"use strict";Object.defineProperty(Io,"__esModule",{value:!0});Io.CodeActionFeature=void 0;var aR=require("vscode"),on=re(),cR=Ke(),$d=we(),jd=class extends $d.TextDocumentLanguageFeature{constructor(e){super(e,on.CodeActionRequest.type)}fillClientCapabilities(e){let t=(0,$d.ensure)((0,$d.ensure)(e,"textDocument"),"codeAction");t.dynamicRegistration=!0,t.isPreferredSupport=!0,t.disabledSupport=!0,t.dataSupport=!0,t.resolveSupport={properties:["edit"]},t.codeActionLiteralSupport={codeActionKind:{valueSet:[on.CodeActionKind.Empty,on.CodeActionKind.QuickFix,on.CodeActionKind.Refactor,on.CodeActionKind.RefactorExtract,on.CodeActionKind.RefactorInline,on.CodeActionKind.RefactorRewrite,on.CodeActionKind.Source,on.CodeActionKind.SourceOrganizeImports]}},t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.codeActionProvider);n&&this.register({id:cR.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideCodeActions:(i,s,o,a)=>{let u=this._client,d=async(m,g,S,y)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),range:u.code2ProtocolConverter.asRange(g),context:u.code2ProtocolConverter.asCodeActionContextSync(S)};return u.sendRequest(on.CodeActionRequest.type,P,y).then(E=>y.isCancellationRequested||E===null||E===void 0?null:u.protocol2CodeConverter.asCodeActionResult(E,y),E=>u.handleFailedRequest(on.CodeActionRequest.type,y,E,null))},p=u.middleware;return p.provideCodeActions?p.provideCodeActions(i,s,o,a,d):d(i,s,o,a)},resolveCodeAction:e.resolveProvider?(i,s)=>{let o=this._client,a=this._client.middleware,u=async(d,p)=>o.sendRequest(on.CodeActionResolveRequest.type,o.code2ProtocolConverter.asCodeActionSync(d),p).then(m=>p.isCancellationRequested?d:o.protocol2CodeConverter.asCodeAction(m,p),m=>o.handleFailedRequest(on.CodeActionResolveRequest.type,p,m,d));return a.resolveCodeAction?a.resolveCodeAction(i,s,u):u(i,s)}:void 0};return[aR.languages.registerCodeActionsProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,e.codeActionKinds?{providedCodeActionKinds:this._client.protocol2CodeConverter.asCodeActionKinds(e.codeActionKinds)}:void 0),n]}};Io.CodeActionFeature=jd});var fv=x(qo=>{"use strict";Object.defineProperty(qo,"__esModule",{value:!0});qo.CodeLensFeature=void 0;var lv=require("vscode"),Si=re(),uR=Ke(),Zi=we(),Ud=class extends Zi.TextDocumentLanguageFeature{constructor(e){super(e,Si.CodeLensRequest.type)}fillClientCapabilities(e){(0,Zi.ensure)((0,Zi.ensure)(e,"textDocument"),"codeLens").dynamicRegistration=!0,(0,Zi.ensure)((0,Zi.ensure)(e,"workspace"),"codeLens").refreshSupport=!0}initialize(e,t){this._client.onRequest(Si.CodeLensRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeCodeLensEmitter.fire()});let i=this.getRegistrationOptions(t,e.codeLensProvider);i&&this.register({id:uR.generateUuid(),registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new lv.EventEmitter,i={onDidChangeCodeLenses:n.event,provideCodeLenses:(s,o)=>{let a=this._client,u=(p,m)=>a.sendRequest(Si.CodeLensRequest.type,a.code2ProtocolConverter.asCodeLensParams(p),m).then(g=>m.isCancellationRequested?null:a.protocol2CodeConverter.asCodeLenses(g,m),g=>a.handleFailedRequest(Si.CodeLensRequest.type,m,g,null)),d=a.middleware;return d.provideCodeLenses?d.provideCodeLenses(s,o,u):u(s,o)},resolveCodeLens:e.resolveProvider?(s,o)=>{let a=this._client,u=(p,m)=>a.sendRequest(Si.CodeLensResolveRequest.type,a.code2ProtocolConverter.asCodeLens(p),m).then(g=>m.isCancellationRequested?p:a.protocol2CodeConverter.asCodeLens(g),g=>a.handleFailedRequest(Si.CodeLensResolveRequest.type,m,g,p)),d=a.middleware;return d.resolveCodeLens?d.resolveCodeLens(s,o,u):u(s,o)}:void 0};return[lv.languages.registerCodeLensProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeCodeLensEmitter:n}]}};qo.CodeLensFeature=Ud});var hv=x(_r=>{"use strict";Object.defineProperty(_r,"__esModule",{value:!0});_r.DocumentOnTypeFormattingFeature=_r.DocumentRangeFormattingFeature=_r.DocumentFormattingFeature=void 0;var Fo=require("vscode"),xn=re(),Vd=Ke(),tr=we(),Di;(function(r){function e(t){let n=Fo.workspace.getConfiguration("files",t);return{trimTrailingWhitespace:n.get("trimTrailingWhitespace"),trimFinalNewlines:n.get("trimFinalNewlines"),insertFinalNewline:n.get("insertFinalNewline")}}r.fromConfiguration=e})(Di||(Di={}));var Hd=class extends tr.TextDocumentLanguageFeature{constructor(e){super(e,xn.DocumentFormattingRequest.type)}fillClientCapabilities(e){(0,tr.ensure)((0,tr.ensure)(e,"textDocument"),"formatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentFormattingProvider);n&&this.register({id:Vd.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentFormattingEdits:(i,s,o)=>{let a=this._client,u=(p,m,g)=>{let S={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),options:a.code2ProtocolConverter.asFormattingOptions(m,Di.fromConfiguration(p))};return a.sendRequest(xn.DocumentFormattingRequest.type,S,g).then(y=>g.isCancellationRequested?null:a.protocol2CodeConverter.asTextEdits(y,g),y=>a.handleFailedRequest(xn.DocumentFormattingRequest.type,g,y,null))},d=a.middleware;return d.provideDocumentFormattingEdits?d.provideDocumentFormattingEdits(i,s,o,u):u(i,s,o)}};return[Fo.languages.registerDocumentFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};_r.DocumentFormattingFeature=Hd;var Wd=class extends tr.TextDocumentLanguageFeature{constructor(e){super(e,xn.DocumentRangeFormattingRequest.type)}fillClientCapabilities(e){let t=(0,tr.ensure)((0,tr.ensure)(e,"textDocument"),"rangeFormatting");t.dynamicRegistration=!0,t.rangesSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentRangeFormattingProvider);n&&this.register({id:Vd.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentRangeFormattingEdits:(i,s,o,a)=>{let u=this._client,d=(m,g,S,y)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),range:u.code2ProtocolConverter.asRange(g),options:u.code2ProtocolConverter.asFormattingOptions(S,Di.fromConfiguration(m))};return u.sendRequest(xn.DocumentRangeFormattingRequest.type,P,y).then(E=>y.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(E,y),E=>u.handleFailedRequest(xn.DocumentRangeFormattingRequest.type,y,E,null))},p=u.middleware;return p.provideDocumentRangeFormattingEdits?p.provideDocumentRangeFormattingEdits(i,s,o,a,d):d(i,s,o,a)}};return e.rangesSupport&&(n.provideDocumentRangesFormattingEdits=(i,s,o,a)=>{let u=this._client,d=(m,g,S,y)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),ranges:u.code2ProtocolConverter.asRanges(g),options:u.code2ProtocolConverter.asFormattingOptions(S,Di.fromConfiguration(m))};return u.sendRequest(xn.DocumentRangesFormattingRequest.type,P,y).then(E=>y.isCancellationRequested?null:u.protocol2CodeConverter.asTextEdits(E,y),E=>u.handleFailedRequest(xn.DocumentRangesFormattingRequest.type,y,E,null))},p=u.middleware;return p.provideDocumentRangesFormattingEdits?p.provideDocumentRangesFormattingEdits(i,s,o,a,d):d(i,s,o,a)}),[Fo.languages.registerDocumentRangeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};_r.DocumentRangeFormattingFeature=Wd;var Kd=class extends tr.TextDocumentLanguageFeature{constructor(e){super(e,xn.DocumentOnTypeFormattingRequest.type)}fillClientCapabilities(e){(0,tr.ensure)((0,tr.ensure)(e,"textDocument"),"onTypeFormatting").dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentOnTypeFormattingProvider);n&&this.register({id:Vd.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideOnTypeFormattingEdits:(s,o,a,u,d)=>{let p=this._client,m=(S,y,P,E,L)=>{let N={textDocument:p.code2ProtocolConverter.asTextDocumentIdentifier(S),position:p.code2ProtocolConverter.asPosition(y),ch:P,options:p.code2ProtocolConverter.asFormattingOptions(E,Di.fromConfiguration(S))};return p.sendRequest(xn.DocumentOnTypeFormattingRequest.type,N,L).then(M=>L.isCancellationRequested?null:p.protocol2CodeConverter.asTextEdits(M,L),M=>p.handleFailedRequest(xn.DocumentOnTypeFormattingRequest.type,L,M,null))},g=p.middleware;return g.provideOnTypeFormattingEdits?g.provideOnTypeFormattingEdits(s,o,a,u,d,m):m(s,o,a,u,d)}},i=e.moreTriggerCharacter||[];return[Fo.languages.registerOnTypeFormattingEditProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n,e.firstTriggerCharacter,...i),n]}};_r.DocumentOnTypeFormattingFeature=Kd});var gv=x(Oo=>{"use strict";Object.defineProperty(Oo,"__esModule",{value:!0});Oo.RenameFeature=void 0;var dR=require("vscode"),jr=re(),lR=Ke(),pv=hn(),zd=we(),Bd=class extends zd.TextDocumentLanguageFeature{constructor(e){super(e,jr.RenameRequest.type)}fillClientCapabilities(e){let t=(0,zd.ensure)((0,zd.ensure)(e,"textDocument"),"rename");t.dynamicRegistration=!0,t.prepareSupport=!0,t.prepareSupportDefaultBehavior=jr.PrepareSupportDefaultBehavior.Identifier,t.honorsChangeAnnotations=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.renameProvider);n&&(pv.boolean(e.renameProvider)&&(n.prepareProvider=!1),this.register({id:lR.generateUuid(),registerOptions:n}))}registerLanguageProvider(e){let t=e.documentSelector,n={provideRenameEdits:(i,s,o,a)=>{let u=this._client,d=(m,g,S,y)=>{let P={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),position:u.code2ProtocolConverter.asPosition(g),newName:S};return u.sendRequest(jr.RenameRequest.type,P,y).then(E=>y.isCancellationRequested?null:u.protocol2CodeConverter.asWorkspaceEdit(E,y),E=>u.handleFailedRequest(jr.RenameRequest.type,y,E,null,!1))},p=u.middleware;return p.provideRenameEdits?p.provideRenameEdits(i,s,o,a,d):d(i,s,o,a)},prepareRename:e.prepareProvider?(i,s,o)=>{let a=this._client,u=(p,m,g)=>{let S={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),position:a.code2ProtocolConverter.asPosition(m)};return a.sendRequest(jr.PrepareRenameRequest.type,S,g).then(y=>g.isCancellationRequested?null:jr.Range.is(y)?a.protocol2CodeConverter.asRange(y):this.isDefaultBehavior(y)?y.defaultBehavior===!0?null:Promise.reject(new Error("The element can't be renamed.")):y&&jr.Range.is(y.range)?{range:a.protocol2CodeConverter.asRange(y.range),placeholder:y.placeholder}:Promise.reject(new Error("The element can't be renamed.")),y=>{throw typeof y.message=="string"?new Error(y.message):new Error("The element can't be renamed.")})},d=a.middleware;return d.prepareRename?d.prepareRename(i,s,o,u):u(i,s,o)}:void 0};return[this.registerProvider(t,n),n]}registerProvider(e,t){return dR.languages.registerRenameProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}isDefaultBehavior(e){let t=e;return t&&pv.boolean(t.defaultBehavior)}};Oo.RenameFeature=Bd});var mv=x(Lo=>{"use strict";Object.defineProperty(Lo,"__esModule",{value:!0});Lo.DocumentLinkFeature=void 0;var fR=require("vscode"),es=re(),Gd=we(),hR=Ke(),Xd=class extends Gd.TextDocumentLanguageFeature{constructor(e){super(e,es.DocumentLinkRequest.type)}fillClientCapabilities(e){let t=(0,Gd.ensure)((0,Gd.ensure)(e,"textDocument"),"documentLink");t.dynamicRegistration=!0,t.tooltipSupport=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.documentLinkProvider);n&&this.register({id:hR.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDocumentLinks:(i,s)=>{let o=this._client,a=(d,p)=>o.sendRequest(es.DocumentLinkRequest.type,o.code2ProtocolConverter.asDocumentLinkParams(d),p).then(m=>p.isCancellationRequested?null:o.protocol2CodeConverter.asDocumentLinks(m,p),m=>o.handleFailedRequest(es.DocumentLinkRequest.type,p,m,null)),u=o.middleware;return u.provideDocumentLinks?u.provideDocumentLinks(i,s,a):a(i,s)},resolveDocumentLink:e.resolveProvider?(i,s)=>{let o=this._client,a=(d,p)=>o.sendRequest(es.DocumentLinkResolveRequest.type,o.code2ProtocolConverter.asDocumentLink(d),p).then(m=>p.isCancellationRequested?d:o.protocol2CodeConverter.asDocumentLink(m),m=>o.handleFailedRequest(es.DocumentLinkResolveRequest.type,p,m,d)),u=o.middleware;return u.resolveDocumentLink?u.resolveDocumentLink(i,s,a):a(i,s)}:void 0};return[fR.languages.registerDocumentLinkProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};Lo.DocumentLinkFeature=Xd});var yv=x(Mo=>{"use strict";Object.defineProperty(Mo,"__esModule",{value:!0});Mo.ExecuteCommandFeature=void 0;var pR=require("vscode"),Jd=re(),gR=Ke(),vv=we(),Qd=class{constructor(e){this._client=e,this._commands=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._commands.size>0}}get registrationType(){return Jd.ExecuteCommandRequest.type}fillClientCapabilities(e){(0,vv.ensure)((0,vv.ensure)(e,"workspace"),"executeCommand").dynamicRegistration=!0}initialize(e){e.executeCommandProvider&&this.register({id:gR.generateUuid(),registerOptions:Object.assign({},e.executeCommandProvider)})}register(e){let t=this._client,n=t.middleware,i=(s,o)=>{let a={command:s,arguments:o};return t.sendRequest(Jd.ExecuteCommandRequest.type,a).then(void 0,u=>t.handleFailedRequest(Jd.ExecuteCommandRequest.type,void 0,u,void 0))};if(e.registerOptions.commands){let s=[];for(let o of e.registerOptions.commands)s.push(pR.commands.registerCommand(o,(...a)=>n.executeCommand?n.executeCommand(o,a,i):i(o,a)));this._commands.set(e.id,s)}}unregister(e){let t=this._commands.get(e);t&&t.forEach(n=>n.dispose())}clear(){this._commands.forEach(e=>{e.forEach(t=>t.dispose())}),this._commands.clear()}};Mo.ExecuteCommandFeature=Qd});var bv=x(Ao=>{"use strict";Object.defineProperty(Ao,"__esModule",{value:!0});Ao.FileSystemWatcherFeature=void 0;var mR=require("vscode"),Ur=re(),No=we(),Yd=class{constructor(e,t){this._client=e,this._notifyFileEvent=t,this._watchers=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._watchers.size>0}}get registrationType(){return Ur.DidChangeWatchedFilesNotification.type}fillClientCapabilities(e){(0,No.ensure)((0,No.ensure)(e,"workspace"),"didChangeWatchedFiles").dynamicRegistration=!0,(0,No.ensure)((0,No.ensure)(e,"workspace"),"didChangeWatchedFiles").relativePatternSupport=!0}initialize(e,t){}register(e){if(!Array.isArray(e.registerOptions.watchers))return;let t=[];for(let n of e.registerOptions.watchers){let i=this._client.protocol2CodeConverter.asGlobPattern(n.globPattern);if(i===void 0)continue;let s=!0,o=!0,a=!0;n.kind!==void 0&&n.kind!==null&&(s=(n.kind&Ur.WatchKind.Create)!==0,o=(n.kind&Ur.WatchKind.Change)!==0,a=(n.kind&Ur.WatchKind.Delete)!==0);let u=mR.workspace.createFileSystemWatcher(i,!s,!o,!a);this.hookListeners(u,s,o,a,t),t.push(u)}this._watchers.set(e.id,t)}registerRaw(e,t){let n=[];for(let i of t)this.hookListeners(i,!0,!0,!0,n);this._watchers.set(e,n)}hookListeners(e,t,n,i,s){t&&e.onDidCreate(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Ur.FileChangeType.Created}),null,s),n&&e.onDidChange(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Ur.FileChangeType.Changed}),null,s),i&&e.onDidDelete(o=>this._notifyFileEvent({uri:this._client.code2ProtocolConverter.asUri(o),type:Ur.FileChangeType.Deleted}),null,s)}unregister(e){let t=this._watchers.get(e);if(t)for(let n of t)n.dispose()}clear(){this._watchers.forEach(e=>{for(let t of e)t.dispose()}),this._watchers.clear()}};Ao.FileSystemWatcherFeature=Yd});var wv=x($o=>{"use strict";Object.defineProperty($o,"__esModule",{value:!0});$o.ColorProviderFeature=void 0;var vR=require("vscode"),ts=re(),Zd=we(),el=class extends Zd.TextDocumentLanguageFeature{constructor(e){super(e,ts.DocumentColorRequest.type)}fillClientCapabilities(e){(0,Zd.ensure)((0,Zd.ensure)(e,"textDocument"),"colorProvider").dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.colorProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideColorPresentations:(i,s,o)=>{let a=this._client,u=(p,m,g)=>{let S={color:p,textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(m.document),range:a.code2ProtocolConverter.asRange(m.range)};return a.sendRequest(ts.ColorPresentationRequest.type,S,g).then(y=>g.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorPresentations(y,g),y=>a.handleFailedRequest(ts.ColorPresentationRequest.type,g,y,null))},d=a.middleware;return d.provideColorPresentations?d.provideColorPresentations(i,s,o,u):u(i,s,o)},provideDocumentColors:(i,s)=>{let o=this._client,a=(d,p)=>{let m={textDocument:o.code2ProtocolConverter.asTextDocumentIdentifier(d)};return o.sendRequest(ts.DocumentColorRequest.type,m,p).then(g=>p.isCancellationRequested?null:this._client.protocol2CodeConverter.asColorInformations(g,p),g=>o.handleFailedRequest(ts.DocumentColorRequest.type,p,g,null))},u=o.middleware;return u.provideDocumentColors?u.provideDocumentColors(i,s,a):a(i,s)}};return[vR.languages.registerColorProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};$o.ColorProviderFeature=el});var Cv=x(jo=>{"use strict";Object.defineProperty(jo,"__esModule",{value:!0});jo.ImplementationFeature=void 0;var yR=require("vscode"),tl=re(),nl=we(),rl=class extends nl.TextDocumentLanguageFeature{constructor(e){super(e,tl.ImplementationRequest.type)}fillClientCapabilities(e){let t=(0,nl.ensure)((0,nl.ensure)(e,"textDocument"),"implementation");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.implementationProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideImplementation:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(tl.ImplementationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(S,g),S=>a.handleFailedRequest(tl.ImplementationRequest.type,g,S,null)),d=a.middleware;return d.provideImplementation?d.provideImplementation(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return yR.languages.registerImplementationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};jo.ImplementationFeature=rl});var Rv=x(Uo=>{"use strict";Object.defineProperty(Uo,"__esModule",{value:!0});Uo.TypeDefinitionFeature=void 0;var bR=require("vscode"),il=re(),ns=we(),sl=class extends ns.TextDocumentLanguageFeature{constructor(e){super(e,il.TypeDefinitionRequest.type)}fillClientCapabilities(e){(0,ns.ensure)((0,ns.ensure)(e,"textDocument"),"typeDefinition").dynamicRegistration=!0;let t=(0,ns.ensure)((0,ns.ensure)(e,"textDocument"),"typeDefinition");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.typeDefinitionProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideTypeDefinition:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(il.TypeDefinitionRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asDefinitionResult(S,g),S=>a.handleFailedRequest(il.TypeDefinitionRequest.type,g,S,null)),d=a.middleware;return d.provideTypeDefinition?d.provideTypeDefinition(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return bR.languages.registerTypeDefinitionProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Uo.TypeDefinitionFeature=sl});var Sv=x(_i=>{"use strict";Object.defineProperty(_i,"__esModule",{value:!0});_i.WorkspaceFoldersFeature=_i.arrayDiff=void 0;var wR=Ke(),Ho=require("vscode"),rs=re();function ol(r,e){if(r!=null)return r[e]}function al(r,e){return r.filter(t=>e.indexOf(t)<0)}_i.arrayDiff=al;var cl=class{constructor(e){this._client=e,this._listeners=new Map}getState(){return{kind:"workspace",id:this.registrationType.method,registrations:this._listeners.size>0}}get registrationType(){return rs.DidChangeWorkspaceFoldersNotification.type}fillInitializeParams(e){let t=Ho.workspace.workspaceFolders;this.initializeWithFolders(t),t===void 0?e.workspaceFolders=null:e.workspaceFolders=t.map(n=>this.asProtocol(n))}initializeWithFolders(e){this._initialFolders=e}fillClientCapabilities(e){e.workspace=e.workspace||{},e.workspace.workspaceFolders=!0}initialize(e){let t=this._client;t.onRequest(rs.WorkspaceFoldersRequest.type,s=>{let o=()=>{let u=Ho.workspace.workspaceFolders;return u===void 0?null:u.map(p=>this.asProtocol(p))},a=t.middleware.workspace;return a&&a.workspaceFolders?a.workspaceFolders(s,o):o(s)});let n=ol(ol(ol(e,"workspace"),"workspaceFolders"),"changeNotifications"),i;typeof n=="string"?i=n:n===!0&&(i=wR.generateUuid()),i&&this.register({id:i,registerOptions:void 0})}sendInitialEvent(e){let t;if(this._initialFolders&&e){let n=al(this._initialFolders,e),i=al(e,this._initialFolders);(i.length>0||n.length>0)&&(t=this.doSendEvent(i,n))}else this._initialFolders?t=this.doSendEvent([],this._initialFolders):e&&(t=this.doSendEvent(e,[]));t!==void 0&&t.catch(n=>{this._client.error(`Sending notification ${rs.DidChangeWorkspaceFoldersNotification.type.method} failed`,n)})}doSendEvent(e,t){let n={event:{added:e.map(i=>this.asProtocol(i)),removed:t.map(i=>this.asProtocol(i))}};return this._client.sendNotification(rs.DidChangeWorkspaceFoldersNotification.type,n)}register(e){let t=e.id,n=this._client,i=Ho.workspace.onDidChangeWorkspaceFolders(s=>{let o=d=>this.doSendEvent(d.added,d.removed),a=n.middleware.workspace;(a&&a.didChangeWorkspaceFolders?a.didChangeWorkspaceFolders(s,o):o(s)).catch(d=>{this._client.error(`Sending notification ${rs.DidChangeWorkspaceFoldersNotification.type.method} failed`,d)})});this._listeners.set(t,i),this.sendInitialEvent(Ho.workspace.workspaceFolders)}unregister(e){let t=this._listeners.get(e);t!==void 0&&(this._listeners.delete(e),t.dispose())}clear(){for(let e of this._listeners.values())e.dispose();this._listeners.clear()}asProtocol(e){return e===void 0?null:{uri:this._client.code2ProtocolConverter.asUri(e.uri),name:e.name}}};_i.WorkspaceFoldersFeature=cl});var _v=x(Wo=>{"use strict";Object.defineProperty(Wo,"__esModule",{value:!0});Wo.FoldingRangeFeature=void 0;var Dv=require("vscode"),Hr=re(),is=we(),ul=class extends is.TextDocumentLanguageFeature{constructor(e){super(e,Hr.FoldingRangeRequest.type)}fillClientCapabilities(e){let t=(0,is.ensure)((0,is.ensure)(e,"textDocument"),"foldingRange");t.dynamicRegistration=!0,t.rangeLimit=5e3,t.lineFoldingOnly=!0,t.foldingRangeKind={valueSet:[Hr.FoldingRangeKind.Comment,Hr.FoldingRangeKind.Imports,Hr.FoldingRangeKind.Region]},t.foldingRange={collapsedText:!1},(0,is.ensure)((0,is.ensure)(e,"workspace"),"foldingRange").refreshSupport=!0}initialize(e,t){this._client.onRequest(Hr.FoldingRangeRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeFoldingRange.fire()});let[n,i]=this.getRegistration(t,e.foldingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new Dv.EventEmitter,i={onDidChangeFoldingRanges:n.event,provideFoldingRanges:(s,o,a)=>{let u=this._client,d=(m,g,S)=>{let y={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m)};return u.sendRequest(Hr.FoldingRangeRequest.type,y,S).then(P=>S.isCancellationRequested?null:u.protocol2CodeConverter.asFoldingRanges(P,S),P=>u.handleFailedRequest(Hr.FoldingRangeRequest.type,S,P,null))},p=u.middleware;return p.provideFoldingRanges?p.provideFoldingRanges(s,o,a,d):d(s,o,a)}};return[Dv.languages.registerFoldingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),i),{provider:i,onDidChangeFoldingRange:n}]}};Wo.FoldingRangeFeature=ul});var Tv=x(Ko=>{"use strict";Object.defineProperty(Ko,"__esModule",{value:!0});Ko.DeclarationFeature=void 0;var CR=require("vscode"),dl=re(),ll=we(),fl=class extends ll.TextDocumentLanguageFeature{constructor(e){super(e,dl.DeclarationRequest.type)}fillClientCapabilities(e){let t=(0,ll.ensure)((0,ll.ensure)(e,"textDocument"),"declaration");t.dynamicRegistration=!0,t.linkSupport=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.declarationProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideDeclaration:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(dl.DeclarationRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asDeclarationResult(S,g),S=>a.handleFailedRequest(dl.DeclarationRequest.type,g,S,null)),d=a.middleware;return d.provideDeclaration?d.provideDeclaration(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return CR.languages.registerDeclarationProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Ko.DeclarationFeature=fl});var Pv=x(Vo=>{"use strict";Object.defineProperty(Vo,"__esModule",{value:!0});Vo.SelectionRangeFeature=void 0;var RR=require("vscode"),hl=re(),pl=we(),gl=class extends pl.TextDocumentLanguageFeature{constructor(e){super(e,hl.SelectionRangeRequest.type)}fillClientCapabilities(e){let t=(0,pl.ensure)((0,pl.ensure)(e,"textDocument"),"selectionRange");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.selectionRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideSelectionRanges:(i,s,o)=>{let a=this._client,u=async(p,m,g)=>{let S={textDocument:a.code2ProtocolConverter.asTextDocumentIdentifier(p),positions:a.code2ProtocolConverter.asPositionsSync(m,g)};return a.sendRequest(hl.SelectionRangeRequest.type,S,g).then(y=>g.isCancellationRequested?null:a.protocol2CodeConverter.asSelectionRanges(y,g),y=>a.handleFailedRequest(hl.SelectionRangeRequest.type,g,y,null))},d=a.middleware;return d.provideSelectionRanges?d.provideSelectionRanges(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return RR.languages.registerSelectionRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Vo.SelectionRangeFeature=gl});var Ev=x(zo=>{"use strict";Object.defineProperty(zo,"__esModule",{value:!0});zo.ProgressFeature=void 0;var kv=re(),SR=Hu();function DR(r,e){return r[e]===void 0&&(r[e]=Object.create(null)),r[e]}var ml=class{constructor(e){this._client=e,this.activeParts=new Set}getState(){return{kind:"window",id:kv.WorkDoneProgressCreateRequest.method,registrations:this.activeParts.size>0}}fillClientCapabilities(e){DR(e,"window").workDoneProgress=!0}initialize(){let e=this._client,t=i=>{this.activeParts.delete(i)},n=i=>{this.activeParts.add(new SR.ProgressPart(this._client,i.token,t))};e.onRequest(kv.WorkDoneProgressCreateRequest.type,n)}clear(){for(let e of this.activeParts)e.done();this.activeParts.clear()}};zo.ProgressFeature=ml});var xv=x(Bo=>{"use strict";Object.defineProperty(Bo,"__esModule",{value:!0});Bo.CallHierarchyFeature=void 0;var _R=require("vscode"),Wr=re(),vl=we(),yl=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareCallHierarchy(e,t,n){let i=this.client,s=this.middleware,o=(a,u,d)=>{let p=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(Wr.CallHierarchyPrepareRequest.type,p,d).then(m=>d.isCancellationRequested?null:i.protocol2CodeConverter.asCallHierarchyItems(m,d),m=>i.handleFailedRequest(Wr.CallHierarchyPrepareRequest.type,d,m,null))};return s.prepareCallHierarchy?s.prepareCallHierarchy(e,t,n,o):o(e,t,n)}provideCallHierarchyIncomingCalls(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asCallHierarchyItem(o)};return n.sendRequest(Wr.CallHierarchyIncomingCallsRequest.type,u,a).then(d=>a.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyIncomingCalls(d,a),d=>n.handleFailedRequest(Wr.CallHierarchyIncomingCallsRequest.type,a,d,null))};return i.provideCallHierarchyIncomingCalls?i.provideCallHierarchyIncomingCalls(e,t,s):s(e,t)}provideCallHierarchyOutgoingCalls(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asCallHierarchyItem(o)};return n.sendRequest(Wr.CallHierarchyOutgoingCallsRequest.type,u,a).then(d=>a.isCancellationRequested?null:n.protocol2CodeConverter.asCallHierarchyOutgoingCalls(d,a),d=>n.handleFailedRequest(Wr.CallHierarchyOutgoingCallsRequest.type,a,d,null))};return i.provideCallHierarchyOutgoingCalls?i.provideCallHierarchyOutgoingCalls(e,t,s):s(e,t)}},bl=class extends vl.TextDocumentLanguageFeature{constructor(e){super(e,Wr.CallHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=e,n=(0,vl.ensure)((0,vl.ensure)(t,"textDocument"),"callHierarchy");n.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.callHierarchyProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=this._client,n=new yl(t);return[_R.languages.registerCallHierarchyProvider(this._client.protocol2CodeConverter.asDocumentSelector(e.documentSelector),n),n]}};Bo.CallHierarchyFeature=bl});var Iv=x(Xo=>{"use strict";Object.defineProperty(Xo,"__esModule",{value:!0});Xo.SemanticTokensFeature=void 0;var Go=require("vscode"),oe=re(),ss=we(),TR=hn(),wl=class extends ss.TextDocumentLanguageFeature{constructor(e){super(e,oe.SemanticTokensRegistrationType.type)}fillClientCapabilities(e){let t=(0,ss.ensure)((0,ss.ensure)(e,"textDocument"),"semanticTokens");t.dynamicRegistration=!0,t.tokenTypes=[oe.SemanticTokenTypes.namespace,oe.SemanticTokenTypes.type,oe.SemanticTokenTypes.class,oe.SemanticTokenTypes.enum,oe.SemanticTokenTypes.interface,oe.SemanticTokenTypes.struct,oe.SemanticTokenTypes.typeParameter,oe.SemanticTokenTypes.parameter,oe.SemanticTokenTypes.variable,oe.SemanticTokenTypes.property,oe.SemanticTokenTypes.enumMember,oe.SemanticTokenTypes.event,oe.SemanticTokenTypes.function,oe.SemanticTokenTypes.method,oe.SemanticTokenTypes.macro,oe.SemanticTokenTypes.keyword,oe.SemanticTokenTypes.modifier,oe.SemanticTokenTypes.comment,oe.SemanticTokenTypes.string,oe.SemanticTokenTypes.number,oe.SemanticTokenTypes.regexp,oe.SemanticTokenTypes.operator,oe.SemanticTokenTypes.decorator],t.tokenModifiers=[oe.SemanticTokenModifiers.declaration,oe.SemanticTokenModifiers.definition,oe.SemanticTokenModifiers.readonly,oe.SemanticTokenModifiers.static,oe.SemanticTokenModifiers.deprecated,oe.SemanticTokenModifiers.abstract,oe.SemanticTokenModifiers.async,oe.SemanticTokenModifiers.modification,oe.SemanticTokenModifiers.documentation,oe.SemanticTokenModifiers.defaultLibrary],t.formats=[oe.TokenFormat.Relative],t.requests={range:!0,full:{delta:!0}},t.multilineTokenSupport=!1,t.overlappingTokenSupport=!1,t.serverCancelSupport=!0,t.augmentsSyntaxTokens=!0,(0,ss.ensure)((0,ss.ensure)(e,"workspace"),"semanticTokens").refreshSupport=!0}initialize(e,t){this._client.onRequest(oe.SemanticTokensRefreshRequest.type,async()=>{for(let o of this.getAllProviders())o.onDidChangeSemanticTokensEmitter.fire()});let[i,s]=this.getRegistration(t,e.semanticTokensProvider);!i||!s||this.register({id:i,registerOptions:s})}registerLanguageProvider(e){let t=e.documentSelector,n=TR.boolean(e.full)?e.full:e.full!==void 0,i=e.full!==void 0&&typeof e.full!="boolean"&&e.full.delta===!0,s=new Go.EventEmitter,o=n?{onDidChangeSemanticTokens:s.event,provideDocumentSemanticTokens:(S,y)=>{let P=this._client,E=P.middleware,L=(N,M)=>{let H={textDocument:P.code2ProtocolConverter.asTextDocumentIdentifier(N)};return P.sendRequest(oe.SemanticTokensRequest.type,H,M).then(J=>M.isCancellationRequested?null:P.protocol2CodeConverter.asSemanticTokens(J,M),J=>P.handleFailedRequest(oe.SemanticTokensRequest.type,M,J,null))};return E.provideDocumentSemanticTokens?E.provideDocumentSemanticTokens(S,y,L):L(S,y)},provideDocumentSemanticTokensEdits:i?(S,y,P)=>{let E=this._client,L=E.middleware,N=(M,H,J)=>{let pe={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(M),previousResultId:H};return E.sendRequest(oe.SemanticTokensDeltaRequest.type,pe,J).then(async G=>J.isCancellationRequested?null:oe.SemanticTokens.is(G)?await E.protocol2CodeConverter.asSemanticTokens(G,J):await E.protocol2CodeConverter.asSemanticTokensEdits(G,J),G=>E.handleFailedRequest(oe.SemanticTokensDeltaRequest.type,J,G,null))};return L.provideDocumentSemanticTokensEdits?L.provideDocumentSemanticTokensEdits(S,y,P,N):N(S,y,P)}:void 0}:void 0,u=e.range===!0?{provideDocumentRangeSemanticTokens:(S,y,P)=>{let E=this._client,L=E.middleware,N=(M,H,J)=>{let pe={textDocument:E.code2ProtocolConverter.asTextDocumentIdentifier(M),range:E.code2ProtocolConverter.asRange(H)};return E.sendRequest(oe.SemanticTokensRangeRequest.type,pe,J).then(G=>J.isCancellationRequested?null:E.protocol2CodeConverter.asSemanticTokens(G,J),G=>E.handleFailedRequest(oe.SemanticTokensRangeRequest.type,J,G,null))};return L.provideDocumentRangeSemanticTokens?L.provideDocumentRangeSemanticTokens(S,y,P,N):N(S,y,P)}}:void 0,d=[],p=this._client,m=p.protocol2CodeConverter.asSemanticTokensLegend(e.legend),g=p.protocol2CodeConverter.asDocumentSelector(t);return o!==void 0&&d.push(Go.languages.registerDocumentSemanticTokensProvider(g,o,m)),u!==void 0&&d.push(Go.languages.registerDocumentRangeSemanticTokensProvider(g,u,m)),[new Go.Disposable(()=>d.forEach(S=>S.dispose())),{range:u,full:o,onDidChangeSemanticTokensEmitter:s}]}};Xo.SemanticTokensFeature=wl});var Ov=x(Bt=>{"use strict";Object.defineProperty(Bt,"__esModule",{value:!0});Bt.WillDeleteFilesFeature=Bt.WillRenameFilesFeature=Bt.WillCreateFilesFeature=Bt.DidDeleteFilesFeature=Bt.DidRenameFilesFeature=Bt.DidCreateFilesFeature=void 0;var bn=require("vscode"),PR=vo(),nr=re(),kR=Ke();function qv(r,e){return r[e]===void 0&&(r[e]={}),r[e]}function ER(r,e){return r[e]}function Fv(r,e,t){r[e]=t}var os=class r{constructor(e,t,n,i,s){this._client=e,this._event=t,this._registrationType=n,this._clientCapability=i,this._serverCapability=s,this._filters=new Map}getState(){return{kind:"workspace",id:this._registrationType.method,registrations:this._filters.size>0}}filterSize(){return this._filters.size}get registrationType(){return this._registrationType}fillClientCapabilities(e){let t=qv(qv(e,"workspace"),"fileOperations");Fv(t,"dynamicRegistration",!0),Fv(t,this._clientCapability,!0)}initialize(e){let t=e.workspace?.fileOperations,n=t!==void 0?ER(t,this._serverCapability):void 0;if(n?.filters!==void 0)try{this.register({id:kR.generateUuid(),registerOptions:{filters:n.filters}})}catch(i){this._client.warn(`Ignoring invalid glob pattern for ${this._serverCapability} registration: ${i}`)}}register(e){this._listener||(this._listener=this._event(this.send,this));let t=e.registerOptions.filters.map(n=>{let i=new PR.Minimatch(n.pattern.glob,r.asMinimatchOptions(n.pattern.options));if(!i.makeRe())throw new Error(`Invalid pattern ${n.pattern.glob}!`);return{scheme:n.scheme,matcher:i,kind:n.pattern.matches}});this._filters.set(e.id,t)}unregister(e){this._filters.delete(e),this._filters.size===0&&this._listener&&(this._listener.dispose(),this._listener=void 0)}clear(){this._filters.clear(),this._listener&&(this._listener.dispose(),this._listener=void 0)}getFileType(e){return r.getFileType(e)}async filter(e,t){let n=await Promise.all(e.files.map(async s=>{let o=t(s),a=o.fsPath.replace(/\\/g,"/");for(let u of this._filters.values())for(let d of u)if(!(d.scheme!==void 0&&d.scheme!==o.scheme)){if(d.matcher.match(a)){if(d.kind===void 0)return!0;let p=await this.getFileType(o);if(p===void 0)return this._client.error(`Failed to determine file type for ${o.toString()}.`),!0;if(p===bn.FileType.File&&d.kind===nr.FileOperationPatternKind.file||p===bn.FileType.Directory&&d.kind===nr.FileOperationPatternKind.folder)return!0}else if(d.kind===nr.FileOperationPatternKind.folder&&await r.getFileType(o)===bn.FileType.Directory&&d.matcher.match(`${a}/`))return!0}return!1})),i=e.files.filter((s,o)=>n[o]);return{...e,files:i}}static async getFileType(e){try{return(await bn.workspace.fs.stat(e)).type}catch{return}}static asMinimatchOptions(e){let t={dot:!0};return e?.ignoreCase===!0&&(t.nocase=!0),t}},Jo=class extends os{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s),this._notificationType=n,this._accessUri=o,this._createParams=a}async send(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let n=async i=>this._client.sendNotification(this._notificationType,this._createParams(i));return this.doSend(t,n)}}},Qo=class extends Jo{constructor(){super(...arguments),this._fsPathFileTypes=new Map}async getFileType(e){let t=e.fsPath;if(this._fsPathFileTypes.has(t))return this._fsPathFileTypes.get(t);let n=await os.getFileType(e);return n&&this._fsPathFileTypes.set(t,n),n}async cacheFileTypes(e,t){await this.filter(e,t)}clearFileTypeCache(){this._fsPathFileTypes.clear()}unregister(e){super.unregister(e),this.filterSize()===0&&this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}clear(){super.clear(),this._willListener&&(this._willListener.dispose(),this._willListener=void 0)}},Cl=class extends Jo{constructor(e){super(e,bn.workspace.onDidCreateFiles,nr.DidCreateFilesNotification.type,"didCreate","didCreate",t=>t,e.code2ProtocolConverter.asDidCreateFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.didCreateFiles?n.didCreateFiles(e,t):t(e)}};Bt.DidCreateFilesFeature=Cl;var Rl=class extends Qo{constructor(e){super(e,bn.workspace.onDidRenameFiles,nr.DidRenameFilesNotification.type,"didRename","didRename",t=>t.oldUri,e.code2ProtocolConverter.asDidRenameFilesParams)}register(e){this._willListener||(this._willListener=bn.workspace.onWillRenameFiles(this.willRename,this)),super.register(e)}willRename(e){e.waitUntil(this.cacheFileTypes(e,t=>t.oldUri))}doSend(e,t){this.clearFileTypeCache();let n=this._client.middleware.workspace;return n?.didRenameFiles?n.didRenameFiles(e,t):t(e)}};Bt.DidRenameFilesFeature=Rl;var Sl=class extends Qo{constructor(e){super(e,bn.workspace.onDidDeleteFiles,nr.DidDeleteFilesNotification.type,"didDelete","didDelete",t=>t,e.code2ProtocolConverter.asDidDeleteFilesParams)}register(e){this._willListener||(this._willListener=bn.workspace.onWillDeleteFiles(this.willDelete,this)),super.register(e)}willDelete(e){e.waitUntil(this.cacheFileTypes(e,t=>t))}doSend(e,t){this.clearFileTypeCache();let n=this._client.middleware.workspace;return n?.didDeleteFiles?n.didDeleteFiles(e,t):t(e)}};Bt.DidDeleteFilesFeature=Sl;var as=class extends os{constructor(e,t,n,i,s,o,a){super(e,t,n,i,s),this._requestType=n,this._accessUri=o,this._createParams=a}async send(e){let t=this.waitUntil(e);e.waitUntil(t)}async waitUntil(e){let t=await this.filter(e,this._accessUri);if(t.files.length){let n=i=>this._client.sendRequest(this._requestType,this._createParams(i),i.token).then(this._client.protocol2CodeConverter.asWorkspaceEdit);return this.doSend(t,n)}else return}},Dl=class extends as{constructor(e){super(e,bn.workspace.onWillCreateFiles,nr.WillCreateFilesRequest.type,"willCreate","willCreate",t=>t,e.code2ProtocolConverter.asWillCreateFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willCreateFiles?n.willCreateFiles(e,t):t(e)}};Bt.WillCreateFilesFeature=Dl;var _l=class extends as{constructor(e){super(e,bn.workspace.onWillRenameFiles,nr.WillRenameFilesRequest.type,"willRename","willRename",t=>t.oldUri,e.code2ProtocolConverter.asWillRenameFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willRenameFiles?n.willRenameFiles(e,t):t(e)}};Bt.WillRenameFilesFeature=_l;var Tl=class extends as{constructor(e){super(e,bn.workspace.onWillDeleteFiles,nr.WillDeleteFilesRequest.type,"willDelete","willDelete",t=>t,e.code2ProtocolConverter.asWillDeleteFilesParams)}doSend(e,t){let n=this._client.middleware.workspace;return n?.willDeleteFiles?n.willDeleteFiles(e,t):t(e)}};Bt.WillDeleteFilesFeature=Tl});var Lv=x(Yo=>{"use strict";Object.defineProperty(Yo,"__esModule",{value:!0});Yo.LinkedEditingFeature=void 0;var xR=require("vscode"),Pl=re(),kl=we(),El=class extends kl.TextDocumentLanguageFeature{constructor(e){super(e,Pl.LinkedEditingRangeRequest.type)}fillClientCapabilities(e){let t=(0,kl.ensure)((0,kl.ensure)(e,"textDocument"),"linkedEditingRange");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.linkedEditingRangeProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n={provideLinkedEditingRanges:(i,s,o)=>{let a=this._client,u=(p,m,g)=>a.sendRequest(Pl.LinkedEditingRangeRequest.type,a.code2ProtocolConverter.asTextDocumentPositionParams(p,m),g).then(S=>g.isCancellationRequested?null:a.protocol2CodeConverter.asLinkedEditingRanges(S,g),S=>a.handleFailedRequest(Pl.LinkedEditingRangeRequest.type,g,S,null)),d=a.middleware;return d.provideLinkedEditingRange?d.provideLinkedEditingRange(i,s,o,u):u(i,s,o)}};return[this.registerProvider(t,n),n]}registerProvider(e,t){return xR.languages.registerLinkedEditingRangeProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};Yo.LinkedEditingFeature=El});var Mv=x(Zo=>{"use strict";Object.defineProperty(Zo,"__esModule",{value:!0});Zo.TypeHierarchyFeature=void 0;var IR=require("vscode"),Kr=re(),xl=we(),Il=class{constructor(e){this.client=e,this.middleware=e.middleware}prepareTypeHierarchy(e,t,n){let i=this.client,s=this.middleware,o=(a,u,d)=>{let p=i.code2ProtocolConverter.asTextDocumentPositionParams(a,u);return i.sendRequest(Kr.TypeHierarchyPrepareRequest.type,p,d).then(m=>d.isCancellationRequested?null:i.protocol2CodeConverter.asTypeHierarchyItems(m,d),m=>i.handleFailedRequest(Kr.TypeHierarchyPrepareRequest.type,d,m,null))};return s.prepareTypeHierarchy?s.prepareTypeHierarchy(e,t,n,o):o(e,t,n)}provideTypeHierarchySupertypes(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asTypeHierarchyItem(o)};return n.sendRequest(Kr.TypeHierarchySupertypesRequest.type,u,a).then(d=>a.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(d,a),d=>n.handleFailedRequest(Kr.TypeHierarchySupertypesRequest.type,a,d,null))};return i.provideTypeHierarchySupertypes?i.provideTypeHierarchySupertypes(e,t,s):s(e,t)}provideTypeHierarchySubtypes(e,t){let n=this.client,i=this.middleware,s=(o,a)=>{let u={item:n.code2ProtocolConverter.asTypeHierarchyItem(o)};return n.sendRequest(Kr.TypeHierarchySubtypesRequest.type,u,a).then(d=>a.isCancellationRequested?null:n.protocol2CodeConverter.asTypeHierarchyItems(d,a),d=>n.handleFailedRequest(Kr.TypeHierarchySubtypesRequest.type,a,d,null))};return i.provideTypeHierarchySubtypes?i.provideTypeHierarchySubtypes(e,t,s):s(e,t)}},ql=class extends xl.TextDocumentLanguageFeature{constructor(e){super(e,Kr.TypeHierarchyPrepareRequest.type)}fillClientCapabilities(e){let t=(0,xl.ensure)((0,xl.ensure)(e,"textDocument"),"typeHierarchy");t.dynamicRegistration=!0}initialize(e,t){let[n,i]=this.getRegistration(t,e.typeHierarchyProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=this._client,n=new Il(t);return[IR.languages.registerTypeHierarchyProvider(t.protocol2CodeConverter.asDocumentSelector(e.documentSelector),n),n]}};Zo.TypeHierarchyFeature=ql});var Av=x(ta=>{"use strict";Object.defineProperty(ta,"__esModule",{value:!0});ta.InlineValueFeature=void 0;var Nv=require("vscode"),ea=re(),cs=we(),Fl=class extends cs.TextDocumentLanguageFeature{constructor(e){super(e,ea.InlineValueRequest.type)}fillClientCapabilities(e){(0,cs.ensure)((0,cs.ensure)(e,"textDocument"),"inlineValue").dynamicRegistration=!0,(0,cs.ensure)((0,cs.ensure)(e,"workspace"),"inlineValue").refreshSupport=!0}initialize(e,t){this._client.onRequest(ea.InlineValueRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlineValues.fire()});let[n,i]=this.getRegistration(t,e.inlineValueProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new Nv.EventEmitter,i={onDidChangeInlineValues:n.event,provideInlineValues:(s,o,a,u)=>{let d=this._client,p=(g,S,y,P)=>{let E={textDocument:d.code2ProtocolConverter.asTextDocumentIdentifier(g),range:d.code2ProtocolConverter.asRange(S),context:d.code2ProtocolConverter.asInlineValueContext(y)};return d.sendRequest(ea.InlineValueRequest.type,E,P).then(L=>P.isCancellationRequested?null:d.protocol2CodeConverter.asInlineValues(L,P),L=>d.handleFailedRequest(ea.InlineValueRequest.type,P,L,null))},m=d.middleware;return m.provideInlineValues?m.provideInlineValues(s,o,a,u,p):p(s,o,a,u)}};return[this.registerProvider(t,i),{provider:i,onDidChangeInlineValues:n}]}registerProvider(e,t){return Nv.languages.registerInlineValuesProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};ta.InlineValueFeature=Fl});var jv=x(na=>{"use strict";Object.defineProperty(na,"__esModule",{value:!0});na.InlayHintsFeature=void 0;var $v=require("vscode"),Ti=re(),us=we(),Ol=class extends us.TextDocumentLanguageFeature{constructor(e){super(e,Ti.InlayHintRequest.type)}fillClientCapabilities(e){let t=(0,us.ensure)((0,us.ensure)(e,"textDocument"),"inlayHint");t.dynamicRegistration=!0,t.resolveSupport={properties:["tooltip","textEdits","label.tooltip","label.location","label.command"]},(0,us.ensure)((0,us.ensure)(e,"workspace"),"inlayHint").refreshSupport=!0}initialize(e,t){this._client.onRequest(Ti.InlayHintRefreshRequest.type,async()=>{for(let s of this.getAllProviders())s.onDidChangeInlayHints.fire()});let[n,i]=this.getRegistration(t,e.inlayHintProvider);!n||!i||this.register({id:n,registerOptions:i})}registerLanguageProvider(e){let t=e.documentSelector,n=new $v.EventEmitter,i={onDidChangeInlayHints:n.event,provideInlayHints:(s,o,a)=>{let u=this._client,d=async(m,g,S)=>{let y={textDocument:u.code2ProtocolConverter.asTextDocumentIdentifier(m),range:u.code2ProtocolConverter.asRange(g)};try{let P=await u.sendRequest(Ti.InlayHintRequest.type,y,S);return S.isCancellationRequested?null:u.protocol2CodeConverter.asInlayHints(P,S)}catch(P){return u.handleFailedRequest(Ti.InlayHintRequest.type,S,P,null)}},p=u.middleware;return p.provideInlayHints?p.provideInlayHints(s,o,a,d):d(s,o,a)}};return i.resolveInlayHint=e.resolveProvider===!0?(s,o)=>{let a=this._client,u=async(p,m)=>{try{let g=await a.sendRequest(Ti.InlayHintResolveRequest.type,a.code2ProtocolConverter.asInlayHint(p),m);if(m.isCancellationRequested)return null;let S=a.protocol2CodeConverter.asInlayHint(g,m);return m.isCancellationRequested?null:S}catch(g){return a.handleFailedRequest(Ti.InlayHintResolveRequest.type,m,g,null)}},d=a.middleware;return d.resolveInlayHint?d.resolveInlayHint(s,o,u):u(s,o)}:void 0,[this.registerProvider(t,i),{provider:i,onDidChangeInlayHints:n}]}registerProvider(e,t){return $v.languages.registerInlayHintsProvider(this._client.protocol2CodeConverter.asDocumentSelector(e),t)}};na.InlayHintsFeature=Ol});var Uv=x(ra=>{"use strict";Object.defineProperty(ra,"__esModule",{value:!0});ra.InlineCompletionItemFeature=void 0;var qR=require("vscode"),Ll=re(),Ml=we(),FR=Ke(),Nl=class extends Ml.TextDocumentLanguageFeature{constructor(e){super(e,Ll.InlineCompletionRequest.type)}fillClientCapabilities(e){let t=(0,Ml.ensure)((0,Ml.ensure)(e,"textDocument"),"inlineCompletion");t.dynamicRegistration=!0}initialize(e,t){let n=this.getRegistrationOptions(t,e.inlineCompletionProvider);n&&this.register({id:FR.generateUuid(),registerOptions:n})}registerLanguageProvider(e){let t=e.documentSelector,n={provideInlineCompletionItems:(i,s,o,a)=>{let u=this._client,d=this._client.middleware,p=(m,g,S,y)=>u.sendRequest(Ll.InlineCompletionRequest.type,u.code2ProtocolConverter.asInlineCompletionParams(m,g,S),y).then(P=>y.isCancellationRequested?null:u.protocol2CodeConverter.asInlineCompletionResult(P,y),P=>u.handleFailedRequest(Ll.InlineCompletionRequest.type,y,P,null));return d.provideInlineCompletionItems?d.provideInlineCompletionItems(i,s,o,a,p):p(i,s,o,a)}};return[qR.languages.registerInlineCompletionItemProvider(this._client.protocol2CodeConverter.asDocumentSelector(t),n),n]}};ra.InlineCompletionItemFeature=Nl});var Wl=x(mt=>{"use strict";Object.defineProperty(mt,"__esModule",{value:!0});mt.ProposedFeatures=mt.BaseLanguageClient=mt.MessageTransports=mt.SuspendMode=mt.State=mt.CloseAction=mt.ErrorAction=mt.RevealOutputChannelOn=void 0;var ke=require("vscode"),A=re(),OR=vm(),LR=wm(),qn=hn(),ia=uo(),Hv=Ke(),MR=Hu(),In=we(),NR=cd(),Wv=Qm(),Kv=Zm(),Pi=ev(),AR=tv(),$R=nv(),jR=rv(),UR=sv(),HR=ov(),WR=Fd(),KR=cv(),VR=uv(),zR=dv(),BR=fv(),Al=hv(),GR=gv(),XR=mv(),JR=yv(),QR=bv(),YR=wv(),ZR=Cv(),eS=Rv(),tS=Sv(),nS=_v(),rS=Tv(),iS=Pv(),sS=Ev(),oS=xv(),aS=Iv(),ki=Ov(),cS=Lv(),uS=Mv(),dS=Av(),lS=jv(),fS=Uv(),Vr;(function(r){r[r.Debug=0]="Debug",r[r.Info=1]="Info",r[r.Warn=2]="Warn",r[r.Error=3]="Error",r[r.Never=4]="Never"})(Vr||(mt.RevealOutputChannelOn=Vr={}));var ls;(function(r){r[r.Continue=1]="Continue",r[r.Shutdown=2]="Shutdown"})(ls||(mt.ErrorAction=ls={}));var Tr;(function(r){r[r.DoNotRestart=1]="DoNotRestart",r[r.Restart=2]="Restart"})(Tr||(mt.CloseAction=Tr={}));var ds;(function(r){r[r.Stopped=1]="Stopped",r[r.Starting=3]="Starting",r[r.Running=2]="Running"})(ds||(mt.State=ds={}));var Vv;(function(r){r.off="off",r.on="on"})(Vv||(mt.SuspendMode=Vv={}));var $l;(function(r){function e(t){return t==null?!1:typeof t=="boolean"||typeof t=="object"&&t!==null&&qn.stringArray(t.enabledCommands)?t:!1}r.sanitizeIsTrusted=e})($l||($l={}));var jl=class{constructor(e,t){this.client=e,this.maxRestartCount=t,this.restarts=[]}error(e,t,n){return n&&n<=3?{action:ls.Continue}:{action:ls.Shutdown}}closed(){return this.restarts.push(Date.now()),this.restarts.length<=this.maxRestartCount?{action:Tr.Restart}:this.restarts[this.restarts.length-1]-this.restarts[0]<=3*60*1e3?{action:Tr.DoNotRestart,message:`The ${this.client.name} server crashed ${this.maxRestartCount+1} times in the last 3 minutes. The server will not be restarted. See the output for more information.`}:(this.restarts.shift(),{action:Tr.Restart})}},le;(function(r){r.Initial="initial",r.Starting="starting",r.StartFailed="startFailed",r.Running="running",r.Stopping="stopping",r.Stopped="stopped"})(le||(le={}));var zv;(function(r){function e(t){return t&&A.MessageReader.is(t.reader)&&A.MessageWriter.is(t.writer)}r.is=e})(zv||(mt.MessageTransports=zv={}));var fs=class r{constructor(e,t,n){this._traceFormat=A.TraceFormat.Text,this._diagnosticQueue=new Map,this._diagnosticQueueState={state:"idle"},this._features=[],this._dynamicFeatures=new Map,this.workspaceEditLock=new ia.Semaphore(1),this._id=e,this._name=t,n=n||{};let i={isTrusted:!1,supportHtml:!1};n.markdown!==void 0&&(i.isTrusted=$l.sanitizeIsTrusted(n.markdown.isTrusted),i.supportHtml=n.markdown.supportHtml===!0),this._clientOptions={documentSelector:n.documentSelector??[],synchronize:n.synchronize??{},diagnosticCollectionName:n.diagnosticCollectionName,outputChannelName:n.outputChannelName??this._name,revealOutputChannelOn:n.revealOutputChannelOn??Vr.Error,stdioEncoding:n.stdioEncoding??"utf8",initializationOptions:n.initializationOptions,initializationFailedHandler:n.initializationFailedHandler,progressOnInitialization:!!n.progressOnInitialization,errorHandler:n.errorHandler??this.createDefaultErrorHandler(n.connectionOptions?.maxRestartCount),middleware:n.middleware??{},uriConverters:n.uriConverters,workspaceFolder:n.workspaceFolder,connectionOptions:n.connectionOptions,markdown:i,diagnosticPullOptions:n.diagnosticPullOptions??{onChange:!0,onSave:!1},notebookDocumentOptions:n.notebookDocumentOptions??{}},this._clientOptions.synchronize=this._clientOptions.synchronize||{},this._state=le.Initial,this._ignoredRegistrations=new Set,this._listeners=[],this._notificationHandlers=new Map,this._pendingNotificationHandlers=new Map,this._notificationDisposables=new Map,this._requestHandlers=new Map,this._pendingRequestHandlers=new Map,this._requestDisposables=new Map,this._progressHandlers=new Map,this._pendingProgressHandlers=new Map,this._progressDisposables=new Map,this._connection=void 0,this._initializeResult=void 0,n.outputChannel?(this._outputChannel=n.outputChannel,this._disposeOutputChannel=!1):(this._outputChannel=void 0,this._disposeOutputChannel=!0),this._traceOutputChannel=n.traceOutputChannel,this._diagnostics=void 0,this._pendingOpenNotifications=new Set,this._pendingChangeSemaphore=new ia.Semaphore(1),this._pendingChangeDelayer=new ia.Delayer(250),this._fileEvents=[],this._fileEventDelayer=new ia.Delayer(250),this._onStop=void 0,this._telemetryEmitter=new A.Emitter,this._stateChangeEmitter=new A.Emitter,this._trace=A.Trace.Off,this._tracer={log:(s,o)=>{qn.string(s)?this.logTrace(s,o):this.logObjectTrace(s)}},this._c2p=OR.createConverter(n.uriConverters?n.uriConverters.code2Protocol:void 0),this._p2c=LR.createConverter(n.uriConverters?n.uriConverters.protocol2Code:void 0,this._clientOptions.markdown.isTrusted,this._clientOptions.markdown.supportHtml),this._syncedDocuments=new Map,this.registerBuiltinFeatures()}get name(){return this._name}get middleware(){return this._clientOptions.middleware??Object.create(null)}get clientOptions(){return this._clientOptions}get protocol2CodeConverter(){return this._p2c}get code2ProtocolConverter(){return this._c2p}get onTelemetry(){return this._telemetryEmitter.event}get onDidChangeState(){return this._stateChangeEmitter.event}get outputChannel(){return this._outputChannel||(this._outputChannel=ke.window.createOutputChannel(this._clientOptions.outputChannelName?this._clientOptions.outputChannelName:this._name)),this._outputChannel}get traceOutputChannel(){return this._traceOutputChannel?this._traceOutputChannel:this.outputChannel}get diagnostics(){return this._diagnostics}get state(){return this.getPublicState()}get $state(){return this._state}set $state(e){let t=this.getPublicState();this._state=e;let n=this.getPublicState();n!==t&&this._stateChangeEmitter.fire({oldState:t,newState:n})}getPublicState(){switch(this.$state){case le.Starting:return ds.Starting;case le.Running:return ds.Running;default:return ds.Stopped}}get initializeResult(){return this._initializeResult}async sendRequest(e,...t){if(this.$state===le.StartFailed||this.$state===le.Stopping||this.$state===le.Stopped)return Promise.reject(new A.ResponseError(A.ErrorCodes.ConnectionInactive,"Client is not running"));let n=await this.$start();this._didChangeTextDocumentFeature.syncKind===A.TextDocumentSyncKind.Full&&await this.sendPendingFullTextDocumentChanges(n);let i=this._clientOptions.middleware?.sendRequest;if(i!==void 0){let s,o;return t.length===1?A.CancellationToken.is(t[0])?o=t[0]:s=t[0]:t.length===2&&(s=t[0],o=t[1]),i(e,s,o,(a,u,d)=>{let p=[];return u!==void 0&&p.push(u),d!==void 0&&p.push(d),n.sendRequest(a,...p)})}else return n.sendRequest(e,...t)}onRequest(e,t){let n=typeof e=="string"?e:e.method;this._requestHandlers.set(n,t);let i=this.activeConnection(),s;return i!==void 0?(this._requestDisposables.set(n,i.onRequest(e,t)),s={dispose:()=>{let o=this._requestDisposables.get(n);o!==void 0&&(o.dispose(),this._requestDisposables.delete(n))}}):(this._pendingRequestHandlers.set(n,t),s={dispose:()=>{this._pendingRequestHandlers.delete(n);let o=this._requestDisposables.get(n);o!==void 0&&(o.dispose(),this._requestDisposables.delete(n))}}),{dispose:()=>{this._requestHandlers.delete(n),s.dispose()}}}async sendNotification(e,t){if(this.$state===le.StartFailed||this.$state===le.Stopping||this.$state===le.Stopped)return Promise.reject(new A.ResponseError(A.ErrorCodes.ConnectionInactive,"Client is not running"));let n=this._didChangeTextDocumentFeature.syncKind===A.TextDocumentSyncKind.Full,i;n&&typeof e!="string"&&e.method===A.DidOpenTextDocumentNotification.method&&(i=t?.textDocument.uri,this._pendingOpenNotifications.add(i));let s=await this.$start();n&&await this.sendPendingFullTextDocumentChanges(s),i!==void 0&&this._pendingOpenNotifications.delete(i);let o=this._clientOptions.middleware?.sendNotification;return o?o(e,s.sendNotification.bind(s),t):s.sendNotification(e,t)}onNotification(e,t){let n=typeof e=="string"?e:e.method;this._notificationHandlers.set(n,t);let i=this.activeConnection(),s;return i!==void 0?(this._notificationDisposables.set(n,i.onNotification(e,t)),s={dispose:()=>{let o=this._notificationDisposables.get(n);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(n))}}):(this._pendingNotificationHandlers.set(n,t),s={dispose:()=>{this._pendingNotificationHandlers.delete(n);let o=this._notificationDisposables.get(n);o!==void 0&&(o.dispose(),this._notificationDisposables.delete(n))}}),{dispose:()=>{this._notificationHandlers.delete(n),s.dispose()}}}async sendProgress(e,t,n){if(this.$state===le.StartFailed||this.$state===le.Stopping||this.$state===le.Stopped)return Promise.reject(new A.ResponseError(A.ErrorCodes.ConnectionInactive,"Client is not running"));try{return(await this.$start()).sendProgress(e,t,n)}catch(i){throw this.error(`Sending progress for token ${t} failed.`,i),i}}onProgress(e,t,n){this._progressHandlers.set(t,{type:e,handler:n});let i=this.activeConnection(),s,o=this._clientOptions.middleware?.handleWorkDoneProgress,a=A.WorkDoneProgress.is(e)&&o!==void 0?u=>{o(t,u,()=>n(u))}:n;return i!==void 0?(this._progressDisposables.set(t,i.onProgress(e,t,a)),s={dispose:()=>{let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}):(this._pendingProgressHandlers.set(t,{type:e,handler:n}),s={dispose:()=>{this._pendingProgressHandlers.delete(t);let u=this._progressDisposables.get(t);u!==void 0&&(u.dispose(),this._progressDisposables.delete(t))}}),{dispose:()=>{this._progressHandlers.delete(t),s.dispose()}}}createDefaultErrorHandler(e){if(e!==void 0&&e<0)throw new Error(`Invalid maxRestartCount: ${e}`);return new jl(this,e??4)}async setTrace(e){this._trace=e;let t=this.activeConnection();t!==void 0&&await t.trace(this._trace,this._tracer,{sendNotification:!1,traceFormat:this._traceFormat})}data2String(e){if(e instanceof A.ResponseError){let t=e;return`  Message: ${t.message}
  Code: ${t.code} ${t.data?`
`+t.data.toString():""}`}return e instanceof Error?qn.string(e.stack)?e.stack:e.message:qn.string(e)?e:e.toString()}debug(e,t,n=!0){this.logOutputMessage(A.MessageType.Debug,Vr.Debug,"Debug",e,t,n)}info(e,t,n=!0){this.logOutputMessage(A.MessageType.Info,Vr.Info,"Info",e,t,n)}warn(e,t,n=!0){this.logOutputMessage(A.MessageType.Warning,Vr.Warn,"Warn",e,t,n)}error(e,t,n=!0){this.logOutputMessage(A.MessageType.Error,Vr.Error,"Error",e,t,n)}logOutputMessage(e,t,n,i,s,o){this.outputChannel.appendLine(`[${n.padEnd(5)} - ${new Date().toLocaleTimeString()}] ${i}`),s!=null&&this.outputChannel.appendLine(this.data2String(s)),(o==="force"||o&&this._clientOptions.revealOutputChannelOn<=t)&&this.showNotificationMessage(e,i)}showNotificationMessage(e,t){t=t??"A request has failed. See the output for more information.",(e===A.MessageType.Error?ke.window.showErrorMessage:e===A.MessageType.Warning?ke.window.showWarningMessage:ke.window.showInformationMessage)(t,"Go to output").then(i=>{i!==void 0&&this.outputChannel.show(!0)})}logTrace(e,t){this.traceOutputChannel.appendLine(`[Trace - ${new Date().toLocaleTimeString()}] ${e}`),t&&this.traceOutputChannel.appendLine(this.data2String(t))}logObjectTrace(e){e.isLSPMessage&&e.type?this.traceOutputChannel.append(`[LSP   - ${new Date().toLocaleTimeString()}] `):this.traceOutputChannel.append(`[Trace - ${new Date().toLocaleTimeString()}] `),e&&this.traceOutputChannel.appendLine(`${JSON.stringify(e)}`)}needsStart(){return this.$state===le.Initial||this.$state===le.Stopping||this.$state===le.Stopped}needsStop(){return this.$state===le.Starting||this.$state===le.Running}activeConnection(){return this.$state===le.Running&&this._connection!==void 0?this._connection:void 0}isRunning(){return this.$state===le.Running}async start(){if(this._disposed==="disposing"||this._disposed==="disposed")throw new Error("Client got disposed and can't be restarted.");if(this.$state===le.Stopping)throw new Error("Client is currently stopping. Can only restart a full stopped client");if(this._onStart!==void 0)return this._onStart;let[e,t,n]=this.createOnStartPromise();this._onStart=e,this._diagnostics===void 0&&(this._diagnostics=this._clientOptions.diagnosticCollectionName?ke.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName):ke.languages.createDiagnosticCollection());for(let[i,s]of this._notificationHandlers)this._pendingNotificationHandlers.has(i)||this._pendingNotificationHandlers.set(i,s);for(let[i,s]of this._requestHandlers)this._pendingRequestHandlers.has(i)||this._pendingRequestHandlers.set(i,s);for(let[i,s]of this._progressHandlers)this._pendingProgressHandlers.has(i)||this._pendingProgressHandlers.set(i,s);this.$state=le.Starting;try{let i=await this.createConnection();i.onNotification(A.LogMessageNotification.type,s=>{switch(s.type){case A.MessageType.Error:this.error(s.message,void 0,!1);break;case A.MessageType.Warning:this.warn(s.message,void 0,!1);break;case A.MessageType.Info:this.info(s.message,void 0,!1);break;case A.MessageType.Debug:this.debug(s.message,void 0,!1);break;default:this.outputChannel.appendLine(s.message)}}),i.onNotification(A.ShowMessageNotification.type,s=>{switch(s.type){case A.MessageType.Error:ke.window.showErrorMessage(s.message);break;case A.MessageType.Warning:ke.window.showWarningMessage(s.message);break;case A.MessageType.Info:ke.window.showInformationMessage(s.message);break;default:ke.window.showInformationMessage(s.message)}}),i.onRequest(A.ShowMessageRequest.type,s=>{let o;switch(s.type){case A.MessageType.Error:o=ke.window.showErrorMessage;break;case A.MessageType.Warning:o=ke.window.showWarningMessage;break;case A.MessageType.Info:o=ke.window.showInformationMessage;break;default:o=ke.window.showInformationMessage}let a=s.actions||[];return o(s.message,...a)}),i.onNotification(A.TelemetryEventNotification.type,s=>{this._telemetryEmitter.fire(s)}),i.onRequest(A.ShowDocumentRequest.type,async s=>{let o=async u=>{let d=this.protocol2CodeConverter.asUri(u.uri);try{if(u.external===!0)return{success:await ke.env.openExternal(d)};{let p={};return u.selection!==void 0&&(p.selection=this.protocol2CodeConverter.asRange(u.selection)),u.takeFocus===void 0||u.takeFocus===!1?p.preserveFocus=!0:u.takeFocus===!0&&(p.preserveFocus=!1),await ke.window.showTextDocument(d,p),{success:!0}}}catch{return{success:!1}}},a=this._clientOptions.middleware.window?.showDocument;return a!==void 0?a(s,o):o(s)}),i.listen(),await this.initialize(i),t()}catch(i){this.$state=le.StartFailed,this.error(`${this._name} client: couldn't create connection to server.`,i,"force"),n(i)}return this._onStart}createOnStartPromise(){let e,t;return[new Promise((i,s)=>{e=i,t=s}),e,t]}async initialize(e){this.refreshTrace(e,!1);let t=this._clientOptions.initializationOptions,[n,i]=this._clientOptions.workspaceFolder!==void 0?[this._clientOptions.workspaceFolder.uri.fsPath,[{uri:this._c2p.asUri(this._clientOptions.workspaceFolder.uri),name:this._clientOptions.workspaceFolder.name}]]:[this._clientGetRootPath(),null],s={processId:null,clientInfo:{name:ke.env.appName,version:ke.version},locale:this.getLocale(),rootPath:n||null,rootUri:n?this._c2p.asUri(ke.Uri.file(n)):null,capabilities:this.computeClientCapabilities(),initializationOptions:qn.func(t)?t():t,trace:A.Trace.toString(this._trace),workspaceFolders:i};if(this.fillInitializeParams(s),this._clientOptions.progressOnInitialization){let o=Hv.generateUuid(),a=new MR.ProgressPart(e,o);s.workDoneToken=o;try{let u=await this.doInitialize(e,s);return a.done(),u}catch(u){throw a.cancel(),u}}else return this.doInitialize(e,s)}async doInitialize(e,t){try{let n=await e.initialize(t);if(n.capabilities.positionEncoding!==void 0&&n.capabilities.positionEncoding!==A.PositionEncodingKind.UTF16)throw new Error(`Unsupported position encoding (${n.capabilities.positionEncoding}) received from server ${this.name}`);this._initializeResult=n,this.$state=le.Running;let i;qn.number(n.capabilities.textDocumentSync)?n.capabilities.textDocumentSync===A.TextDocumentSyncKind.None?i={openClose:!1,change:A.TextDocumentSyncKind.None,save:void 0}:i={openClose:!0,change:n.capabilities.textDocumentSync,save:{includeText:!1}}:n.capabilities.textDocumentSync!==void 0&&n.capabilities.textDocumentSync!==null&&(i=n.capabilities.textDocumentSync),this._capabilities=Object.assign({},n.capabilities,{resolvedTextDocumentSync:i}),e.onNotification(A.PublishDiagnosticsNotification.type,s=>this.handleDiagnostics(s)),e.onRequest(A.RegistrationRequest.type,s=>this.handleRegistrationRequest(s)),e.onRequest("client/registerFeature",s=>this.handleRegistrationRequest(s)),e.onRequest(A.UnregistrationRequest.type,s=>this.handleUnregistrationRequest(s)),e.onRequest("client/unregisterFeature",s=>this.handleUnregistrationRequest(s)),e.onRequest(A.ApplyWorkspaceEditRequest.type,s=>this.handleApplyWorkspaceEdit(s));for(let[s,o]of this._pendingNotificationHandlers)this._notificationDisposables.set(s,e.onNotification(s,o));this._pendingNotificationHandlers.clear();for(let[s,o]of this._pendingRequestHandlers)this._requestDisposables.set(s,e.onRequest(s,o));this._pendingRequestHandlers.clear();for(let[s,o]of this._pendingProgressHandlers)this._progressDisposables.set(s,e.onProgress(o.type,s,o.handler));return this._pendingProgressHandlers.clear(),await e.sendNotification(A.InitializedNotification.type,{}),this.hookFileEvents(e),this.hookConfigurationChanged(e),this.initializeFeatures(e),n}catch(n){throw this._clientOptions.initializationFailedHandler?this._clientOptions.initializationFailedHandler(n)?this.initialize(e):this.stop():n instanceof A.ResponseError&&n.data&&n.data.retry?ke.window.showErrorMessage(n.message,{title:"Retry",id:"retry"}).then(i=>{i&&i.id==="retry"?this.initialize(e):this.stop()}):(n&&n.message&&ke.window.showErrorMessage(n.message),this.error("Server initialization failed.",n),this.stop()),n}}_clientGetRootPath(){let e=ke.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}stop(e=2e3){return this.shutdown("stop",e)}dispose(e=2e3){try{return this._disposed="disposing",this.stop(e)}finally{this._disposed="disposed"}}async shutdown(e,t){if(this.$state===le.Stopped||this.$state===le.Initial)return;if(this.$state===le.Stopping){if(this._onStop!==void 0)return this._onStop;throw new Error("Client is stopping but no stop promise available.")}let n=this.activeConnection();if(n===void 0||this.$state!==le.Running)throw new Error(`Client is not running and can't be stopped. It's current state is: ${this.$state}`);this._initializeResult=void 0,this.$state=le.Stopping,this.cleanUp(e);let i=new Promise(o=>{(0,A.RAL)().timer.setTimeout(o,t)}),s=(async o=>(await o.shutdown(),await o.exit(),o))(n);return this._onStop=Promise.race([i,s]).then(o=>{if(o!==void 0)o.end(),o.dispose();else throw this.error("Stopping server timed out",void 0,!1),new Error("Stopping the server timed out")},o=>{throw this.error("Stopping server failed",o,!1),o}).finally(()=>{this.$state=le.Stopped,e==="stop"&&this.cleanUpChannel(),this._onStart=void 0,this._onStop=void 0,this._connection=void 0,this._ignoredRegistrations.clear()})}cleanUp(e){this._fileEvents=[],this._fileEventDelayer.cancel();let t=this._listeners.splice(0,this._listeners.length);for(let n of t)n.dispose();this._syncedDocuments&&this._syncedDocuments.clear();for(let n of Array.from(this._features.entries()).map(i=>i[1]).reverse())n.clear();e==="stop"&&this._diagnostics!==void 0&&(this._diagnostics.dispose(),this._diagnostics=void 0),this._idleInterval!==void 0&&(this._idleInterval.dispose(),this._idleInterval=void 0)}cleanUpChannel(){this._outputChannel!==void 0&&this._disposeOutputChannel&&(this._outputChannel.dispose(),this._outputChannel=void 0)}notifyFileEvent(e){let t=this;async function n(s){return t._fileEvents.push(s),t._fileEventDelayer.trigger(async()=>{await t.sendNotification(A.DidChangeWatchedFilesNotification.type,{changes:t._fileEvents}),t._fileEvents=[]})}let i=this.clientOptions.middleware?.workspace;(i?.didChangeWatchedFile?i.didChangeWatchedFile(e,n):n(e)).catch(s=>{t.error("Notify file events failed.",s)})}async sendPendingFullTextDocumentChanges(e){return this._pendingChangeSemaphore.lock(async()=>{try{let t=this._didChangeTextDocumentFeature.getPendingDocumentChanges(this._pendingOpenNotifications);if(t.length===0)return;for(let n of t){let i=this.code2ProtocolConverter.asChangeTextDocumentParams(n);await e.sendNotification(A.DidChangeTextDocumentNotification.type,i),this._didChangeTextDocumentFeature.notificationSent(n,A.DidChangeTextDocumentNotification.type,i)}}catch(t){throw this.error("Sending pending changes failed",t,!1),t}})}triggerPendingChangeDelivery(){this._pendingChangeDelayer.trigger(async()=>{let e=this.activeConnection();if(e===void 0){this.triggerPendingChangeDelivery();return}await this.sendPendingFullTextDocumentChanges(e)}).catch(e=>this.error("Delivering pending changes failed",e,!1))}handleDiagnostics(e){if(!this._diagnostics)return;let t=e.uri;this._diagnosticQueueState.state==="busy"&&this._diagnosticQueueState.document===t&&this._diagnosticQueueState.tokenSource.cancel(),this._diagnosticQueue.set(e.uri,e.diagnostics),this.triggerDiagnosticQueue()}triggerDiagnosticQueue(){(0,A.RAL)().timer.setImmediate(()=>{this.workDiagnosticQueue()})}workDiagnosticQueue(){if(this._diagnosticQueueState.state==="busy")return;let e=this._diagnosticQueue.entries().next();if(e.done===!0)return;let[t,n]=e.value;this._diagnosticQueue.delete(t);let i=new ke.CancellationTokenSource;this._diagnosticQueueState={state:"busy",document:t,tokenSource:i},this._p2c.asDiagnostics(n,i.token).then(s=>{if(!i.token.isCancellationRequested){let o=this._p2c.asUri(t),a=this.clientOptions.middleware;a.handleDiagnostics?a.handleDiagnostics(o,s,(u,d)=>this.setDiagnostics(u,d)):this.setDiagnostics(o,s)}}).finally(()=>{this._diagnosticQueueState={state:"idle"},this.triggerDiagnosticQueue()})}setDiagnostics(e,t){this._diagnostics&&this._diagnostics.set(e,t)}getLocale(){return ke.env.language}async $start(){if(this.$state===le.StartFailed)throw new Error("Previous start failed. Can't restart server.");await this.start();let e=this.activeConnection();if(e===void 0)throw new Error("Starting server failed");return e}async createConnection(){let e=(i,s,o)=>{this.handleConnectionError(i,s,o).catch(a=>this.error("Handling connection error failed",a))},t=()=>{this.handleConnectionClosed().catch(i=>this.error("Handling connection close failed",i))},n=await this.createMessageTransports(this._clientOptions.stdioEncoding||"utf8");return this._connection=hS(n.reader,n.writer,e,t,this._clientOptions.connectionOptions),this._connection}async handleConnectionClosed(){if(this.$state===le.Stopped)return;try{this._connection!==void 0&&this._connection.dispose()}catch{}let e={action:Tr.DoNotRestart};if(this.$state!==le.Stopping)try{e=await this._clientOptions.errorHandler.closed()}catch{}this._connection=void 0,e.action===Tr.DoNotRestart?(this.error(e.message??"Connection to server got closed. Server will not be restarted.",void 0,e.handled===!0?!1:"force"),this.cleanUp("stop"),this.$state===le.Starting?this.$state=le.StartFailed:this.$state=le.Stopped,this._onStop=Promise.resolve(),this._onStart=void 0):e.action===Tr.Restart&&(this.info(e.message??"Connection to server got closed. Server will restart.",!e.handled),this.cleanUp("restart"),this.$state=le.Initial,this._onStop=Promise.resolve(),this._onStart=void 0,this.start().catch(t=>this.error("Restarting server failed",t,"force")))}async handleConnectionError(e,t,n){let i=await this._clientOptions.errorHandler.error(e,t,n);i.action===ls.Shutdown?(this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}
Shutting down server.`,void 0,i.handled===!0?!1:"force"),this.stop().catch(s=>{this.error("Stopping server failed",s,!1)})):this.error(i.message??`Client ${this._name}: connection to server is erroring.
${e.message}`,void 0,i.handled===!0?!1:"force")}hookConfigurationChanged(e){this._listeners.push(ke.workspace.onDidChangeConfiguration(()=>{this.refreshTrace(e,!0)}))}refreshTrace(e,t=!1){let n=ke.workspace.getConfiguration(this._id),i=A.Trace.Off,s=A.TraceFormat.Text;if(n){let o=n.get("trace.server","off");typeof o=="string"?i=A.Trace.fromString(o):(i=A.Trace.fromString(n.get("trace.server.verbosity","off")),s=A.TraceFormat.fromString(n.get("trace.server.format","text")))}this._trace=i,this._traceFormat=s,e.trace(this._trace,this._tracer,{sendNotification:t,traceFormat:this._traceFormat}).catch(o=>{this.error("Updating trace failed with error",o,!1)})}hookFileEvents(e){let t=this._clientOptions.synchronize.fileEvents;if(!t)return;let n;qn.array(t)?n=t:n=[t],n&&this._dynamicFeatures.get(A.DidChangeWatchedFilesNotification.type.method).registerRaw(Hv.generateUuid(),n)}registerFeatures(e){for(let t of e)this.registerFeature(t)}registerFeature(e){if(this._features.push(e),In.DynamicFeature.is(e)){let t=e.registrationType;this._dynamicFeatures.set(t.method,e)}}getFeature(e){return this._dynamicFeatures.get(e)}hasDedicatedTextSynchronizationFeature(e){let t=this.getFeature(A.NotebookDocumentSyncRegistrationType.method);return t===void 0||!(t instanceof Wv.NotebookDocumentSyncFeature)?!1:t.handles(e)}registerBuiltinFeatures(){let e=new Map;this.registerFeature(new Kv.ConfigurationFeature(this)),this.registerFeature(new Pi.DidOpenTextDocumentFeature(this,this._syncedDocuments)),this._didChangeTextDocumentFeature=new Pi.DidChangeTextDocumentFeature(this,e),this._didChangeTextDocumentFeature.onPendingChangeAdded(()=>{this.triggerPendingChangeDelivery()}),this.registerFeature(this._didChangeTextDocumentFeature),this.registerFeature(new Pi.WillSaveFeature(this)),this.registerFeature(new Pi.WillSaveWaitUntilFeature(this)),this.registerFeature(new Pi.DidSaveTextDocumentFeature(this)),this.registerFeature(new Pi.DidCloseTextDocumentFeature(this,this._syncedDocuments,e)),this.registerFeature(new QR.FileSystemWatcherFeature(this,t=>this.notifyFileEvent(t))),this.registerFeature(new AR.CompletionItemFeature(this)),this.registerFeature(new $R.HoverFeature(this)),this.registerFeature(new UR.SignatureHelpFeature(this)),this.registerFeature(new jR.DefinitionFeature(this)),this.registerFeature(new VR.ReferencesFeature(this)),this.registerFeature(new HR.DocumentHighlightFeature(this)),this.registerFeature(new WR.DocumentSymbolFeature(this)),this.registerFeature(new KR.WorkspaceSymbolFeature(this)),this.registerFeature(new zR.CodeActionFeature(this)),this.registerFeature(new BR.CodeLensFeature(this)),this.registerFeature(new Al.DocumentFormattingFeature(this)),this.registerFeature(new Al.DocumentRangeFormattingFeature(this)),this.registerFeature(new Al.DocumentOnTypeFormattingFeature(this)),this.registerFeature(new GR.RenameFeature(this)),this.registerFeature(new XR.DocumentLinkFeature(this)),this.registerFeature(new JR.ExecuteCommandFeature(this)),this.registerFeature(new Kv.SyncConfigurationFeature(this)),this.registerFeature(new eS.TypeDefinitionFeature(this)),this.registerFeature(new ZR.ImplementationFeature(this)),this.registerFeature(new YR.ColorProviderFeature(this)),this.clientOptions.workspaceFolder===void 0&&this.registerFeature(new tS.WorkspaceFoldersFeature(this)),this.registerFeature(new nS.FoldingRangeFeature(this)),this.registerFeature(new rS.DeclarationFeature(this)),this.registerFeature(new iS.SelectionRangeFeature(this)),this.registerFeature(new sS.ProgressFeature(this)),this.registerFeature(new oS.CallHierarchyFeature(this)),this.registerFeature(new aS.SemanticTokensFeature(this)),this.registerFeature(new cS.LinkedEditingFeature(this)),this.registerFeature(new ki.DidCreateFilesFeature(this)),this.registerFeature(new ki.DidRenameFilesFeature(this)),this.registerFeature(new ki.DidDeleteFilesFeature(this)),this.registerFeature(new ki.WillCreateFilesFeature(this)),this.registerFeature(new ki.WillRenameFilesFeature(this)),this.registerFeature(new ki.WillDeleteFilesFeature(this)),this.registerFeature(new uS.TypeHierarchyFeature(this)),this.registerFeature(new dS.InlineValueFeature(this)),this.registerFeature(new lS.InlayHintsFeature(this)),this.registerFeature(new NR.DiagnosticFeature(this)),this.registerFeature(new Wv.NotebookDocumentSyncFeature(this))}registerProposedFeatures(){this.registerFeatures(Hl.createAll(this))}fillInitializeParams(e){for(let t of this._features)qn.func(t.fillInitializeParams)&&t.fillInitializeParams(e)}computeClientCapabilities(){let e={};(0,In.ensure)(e,"workspace").applyEdit=!0;let t=(0,In.ensure)((0,In.ensure)(e,"workspace"),"workspaceEdit");t.documentChanges=!0,t.resourceOperations=[A.ResourceOperationKind.Create,A.ResourceOperationKind.Rename,A.ResourceOperationKind.Delete],t.failureHandling=A.FailureHandlingKind.TextOnlyTransactional,t.normalizesLineEndings=!0,t.changeAnnotationSupport={groupsOnLabel:!0};let n=(0,In.ensure)((0,In.ensure)(e,"textDocument"),"publishDiagnostics");n.relatedInformation=!0,n.versionSupport=!1,n.tagSupport={valueSet:[A.DiagnosticTag.Unnecessary,A.DiagnosticTag.Deprecated]},n.codeDescriptionSupport=!0,n.dataSupport=!0;let i=(0,In.ensure)(e,"window"),s=(0,In.ensure)(i,"showMessage");s.messageActionItem={additionalPropertiesSupport:!0};let o=(0,In.ensure)(i,"showDocument");o.support=!0;let a=(0,In.ensure)(e,"general");a.staleRequestSupport={cancel:!0,retryOnContentModified:Array.from(r.RequestsToCancelOnContentModified)},a.regularExpressions={engine:"ECMAScript",version:"ES2020"},a.markdown={parser:"marked",version:"1.1.0"},a.positionEncodings=["utf-16"],this._clientOptions.markdown.supportHtml&&(a.markdown.allowedTags=["ul","li","p","code","blockquote","ol","h1","h2","h3","h4","h5","h6","hr","em","pre","table","thead","tbody","tr","th","td","div","del","a","strong","br","img","span"]);for(let u of this._features)u.fillClientCapabilities(e);return e}initializeFeatures(e){let t=this._clientOptions.documentSelector;for(let n of this._features)qn.func(n.preInitialize)&&n.preInitialize(this._capabilities,t);for(let n of this._features)n.initialize(this._capabilities,t)}async handleRegistrationRequest(e){let t=this.clientOptions.middleware?.handleRegisterCapability;return t?t(e,n=>this.doRegisterCapability(n)):this.doRegisterCapability(e)}async doRegisterCapability(e){if(!this.isRunning()){for(let t of e.registrations)this._ignoredRegistrations.add(t.id);return}for(let t of e.registrations){let n=this._dynamicFeatures.get(t.method);if(n===void 0)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Registration failed.`));let i=t.registerOptions??{};i.documentSelector=i.documentSelector??this._clientOptions.documentSelector;let s={id:t.id,registerOptions:i};try{n.register(s)}catch(o){return Promise.reject(o)}}}async handleUnregistrationRequest(e){let t=this.clientOptions.middleware?.handleUnregisterCapability;return t?t(e,n=>this.doUnregisterCapability(n)):this.doUnregisterCapability(e)}async doUnregisterCapability(e){for(let t of e.unregisterations){if(this._ignoredRegistrations.has(t.id))continue;let n=this._dynamicFeatures.get(t.method);if(!n)return Promise.reject(new Error(`No feature implementation for ${t.method} found. Unregistration failed.`));n.unregister(t.id)}}async handleApplyWorkspaceEdit(e){let t=e.edit,n=await this.workspaceEditLock.lock(()=>this._p2c.asWorkspaceEdit(t)),i=new Map;ke.workspace.textDocuments.forEach(o=>i.set(o.uri.toString(),o));let s=!1;if(t.documentChanges){for(let o of t.documentChanges)if(A.TextDocumentEdit.is(o)&&o.textDocument.version&&o.textDocument.version>=0){let a=this._p2c.asUri(o.textDocument.uri).toString(),u=i.get(a);if(u&&u.version!==o.textDocument.version){s=!0;break}}}return s?Promise.resolve({applied:!1}):qn.asPromise(ke.workspace.applyEdit(n).then(o=>({applied:o})))}handleFailedRequest(e,t,n,i,s=!0){if(n instanceof A.ResponseError){if(n.code===A.ErrorCodes.PendingResponseRejected||n.code===A.ErrorCodes.ConnectionInactive)return i;if(n.code===A.LSPErrorCodes.RequestCancelled||n.code===A.LSPErrorCodes.ServerCancelled){if(t!==void 0&&t.isCancellationRequested)return i;throw n.data!==void 0?new In.LSPCancellationError(n.data):new ke.CancellationError}else if(n.code===A.LSPErrorCodes.ContentModified){if(r.RequestsToCancelOnContentModified.has(e.method)||r.CancellableResolveCalls.has(e.method))throw new ke.CancellationError;return i}}throw this.error(`Request ${e.method} failed.`,n,s),n}};mt.BaseLanguageClient=fs;fs.RequestsToCancelOnContentModified=new Set([A.SemanticTokensRequest.method,A.SemanticTokensRangeRequest.method,A.SemanticTokensDeltaRequest.method]);fs.CancellableResolveCalls=new Set([A.CompletionResolveRequest.method,A.CodeLensResolveRequest.method,A.CodeActionResolveRequest.method,A.InlayHintResolveRequest.method,A.DocumentLinkResolveRequest.method,A.WorkspaceSymbolResolveRequest.method]);var Ul=class{error(e){(0,A.RAL)().console.error(e)}warn(e){(0,A.RAL)().console.warn(e)}info(e){(0,A.RAL)().console.info(e)}log(e){(0,A.RAL)().console.log(e)}};function hS(r,e,t,n,i){let s=new Ul,o=(0,A.createProtocolConnection)(r,e,s,i);return o.onError(u=>{t(u[0],u[1],u[2])}),o.onClose(n),{listen:()=>o.listen(),sendRequest:o.sendRequest,onRequest:o.onRequest,hasPendingResponse:o.hasPendingResponse,sendNotification:o.sendNotification,onNotification:o.onNotification,onProgress:o.onProgress,sendProgress:o.sendProgress,trace:(u,d,p)=>{let m={sendNotification:!1,traceFormat:A.TraceFormat.Text};return p===void 0?o.trace(u,d,m):(qn.boolean(p),o.trace(u,d,p))},initialize:u=>o.sendRequest(A.InitializeRequest.type,u),shutdown:()=>o.sendRequest(A.ShutdownRequest.type,void 0),exit:()=>o.sendNotification(A.ExitNotification.type),end:()=>o.end(),dispose:()=>o.dispose()}}var Hl;(function(r){function e(t){return[new fS.InlineCompletionItemFeature(t)]}r.createAll=e})(Hl||(mt.ProposedFeatures=Hl={}))});var Gv=x(sa=>{"use strict";Object.defineProperty(sa,"__esModule",{value:!0});sa.terminate=void 0;var Bv=require("child_process"),pS=require("path"),gS=process.platform==="win32",mS=process.platform==="darwin",vS=process.platform==="linux";function yS(r,e){if(gS)try{let i={stdio:["pipe","pipe","ignore"]};return e&&(i.cwd=e),Bv.execFileSync("taskkill",["/T","/F","/PID",r.pid.toString()],i),!0}catch{return!1}else if(vS||mS)try{var t=(0,pS.join)(__dirname,"terminateProcess.sh"),n=Bv.spawnSync(t,[r.pid.toString()]);return!n.error}catch{return!1}else return r.kill("SIGKILL"),!0}sa.terminate=yS});var Kl=x((UT,Xv)=>{"use strict";Xv.exports=re()});var hs=x((HT,Jv)=>{var bS=typeof process=="object"&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...r)=>console.error("SEMVER",...r):()=>{};Jv.exports=bS});var oa=x((WT,Qv)=>{var wS="2.0.0",CS=Number.MAX_SAFE_INTEGER||9007199254740991,RS=16,SS=250,DS=["major","premajor","minor","preminor","patch","prepatch","prerelease"];Qv.exports={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:RS,MAX_SAFE_BUILD_LENGTH:SS,MAX_SAFE_INTEGER:CS,RELEASE_TYPES:DS,SEMVER_SPEC_VERSION:wS,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2}});var aa=x((rr,Yv)=>{var{MAX_SAFE_COMPONENT_LENGTH:Vl,MAX_SAFE_BUILD_LENGTH:_S,MAX_LENGTH:TS}=oa(),PS=hs();rr=Yv.exports={};var kS=rr.re=[],ES=rr.safeRe=[],V=rr.src=[],z=rr.t={},xS=0,zl="[a-zA-Z0-9-]",IS=[["\\s",1],["\\d",TS],[zl,_S]],qS=r=>{for(let[e,t]of IS)r=r.split(`${e}*`).join(`${e}{0,${t}}`).split(`${e}+`).join(`${e}{1,${t}}`);return r},ae=(r,e,t)=>{let n=qS(e),i=xS++;PS(r,i,e),z[r]=i,V[i]=e,kS[i]=new RegExp(e,t?"g":void 0),ES[i]=new RegExp(n,t?"g":void 0)};ae("NUMERICIDENTIFIER","0|[1-9]\\d*");ae("NUMERICIDENTIFIERLOOSE","\\d+");ae("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${zl}*`);ae("MAINVERSION",`(${V[z.NUMERICIDENTIFIER]})\\.(${V[z.NUMERICIDENTIFIER]})\\.(${V[z.NUMERICIDENTIFIER]})`);ae("MAINVERSIONLOOSE",`(${V[z.NUMERICIDENTIFIERLOOSE]})\\.(${V[z.NUMERICIDENTIFIERLOOSE]})\\.(${V[z.NUMERICIDENTIFIERLOOSE]})`);ae("PRERELEASEIDENTIFIER",`(?:${V[z.NUMERICIDENTIFIER]}|${V[z.NONNUMERICIDENTIFIER]})`);ae("PRERELEASEIDENTIFIERLOOSE",`(?:${V[z.NUMERICIDENTIFIERLOOSE]}|${V[z.NONNUMERICIDENTIFIER]})`);ae("PRERELEASE",`(?:-(${V[z.PRERELEASEIDENTIFIER]}(?:\\.${V[z.PRERELEASEIDENTIFIER]})*))`);ae("PRERELEASELOOSE",`(?:-?(${V[z.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${V[z.PRERELEASEIDENTIFIERLOOSE]})*))`);ae("BUILDIDENTIFIER",`${zl}+`);ae("BUILD",`(?:\\+(${V[z.BUILDIDENTIFIER]}(?:\\.${V[z.BUILDIDENTIFIER]})*))`);ae("FULLPLAIN",`v?${V[z.MAINVERSION]}${V[z.PRERELEASE]}?${V[z.BUILD]}?`);ae("FULL",`^${V[z.FULLPLAIN]}$`);ae("LOOSEPLAIN",`[v=\\s]*${V[z.MAINVERSIONLOOSE]}${V[z.PRERELEASELOOSE]}?${V[z.BUILD]}?`);ae("LOOSE",`^${V[z.LOOSEPLAIN]}$`);ae("GTLT","((?:<|>)?=?)");ae("XRANGEIDENTIFIERLOOSE",`${V[z.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`);ae("XRANGEIDENTIFIER",`${V[z.NUMERICIDENTIFIER]}|x|X|\\*`);ae("XRANGEPLAIN",`[v=\\s]*(${V[z.XRANGEIDENTIFIER]})(?:\\.(${V[z.XRANGEIDENTIFIER]})(?:\\.(${V[z.XRANGEIDENTIFIER]})(?:${V[z.PRERELEASE]})?${V[z.BUILD]}?)?)?`);ae("XRANGEPLAINLOOSE",`[v=\\s]*(${V[z.XRANGEIDENTIFIERLOOSE]})(?:\\.(${V[z.XRANGEIDENTIFIERLOOSE]})(?:\\.(${V[z.XRANGEIDENTIFIERLOOSE]})(?:${V[z.PRERELEASELOOSE]})?${V[z.BUILD]}?)?)?`);ae("XRANGE",`^${V[z.GTLT]}\\s*${V[z.XRANGEPLAIN]}$`);ae("XRANGELOOSE",`^${V[z.GTLT]}\\s*${V[z.XRANGEPLAINLOOSE]}$`);ae("COERCEPLAIN",`(^|[^\\d])(\\d{1,${Vl}})(?:\\.(\\d{1,${Vl}}))?(?:\\.(\\d{1,${Vl}}))?`);ae("COERCE",`${V[z.COERCEPLAIN]}(?:$|[^\\d])`);ae("COERCEFULL",V[z.COERCEPLAIN]+`(?:${V[z.PRERELEASE]})?(?:${V[z.BUILD]})?(?:$|[^\\d])`);ae("COERCERTL",V[z.COERCE],!0);ae("COERCERTLFULL",V[z.COERCEFULL],!0);ae("LONETILDE","(?:~>?)");ae("TILDETRIM",`(\\s*)${V[z.LONETILDE]}\\s+`,!0);rr.tildeTrimReplace="$1~";ae("TILDE",`^${V[z.LONETILDE]}${V[z.XRANGEPLAIN]}$`);ae("TILDELOOSE",`^${V[z.LONETILDE]}${V[z.XRANGEPLAINLOOSE]}$`);ae("LONECARET","(?:\\^)");ae("CARETTRIM",`(\\s*)${V[z.LONECARET]}\\s+`,!0);rr.caretTrimReplace="$1^";ae("CARET",`^${V[z.LONECARET]}${V[z.XRANGEPLAIN]}$`);ae("CARETLOOSE",`^${V[z.LONECARET]}${V[z.XRANGEPLAINLOOSE]}$`);ae("COMPARATORLOOSE",`^${V[z.GTLT]}\\s*(${V[z.LOOSEPLAIN]})$|^$`);ae("COMPARATOR",`^${V[z.GTLT]}\\s*(${V[z.FULLPLAIN]})$|^$`);ae("COMPARATORTRIM",`(\\s*)${V[z.GTLT]}\\s*(${V[z.LOOSEPLAIN]}|${V[z.XRANGEPLAIN]})`,!0);rr.comparatorTrimReplace="$1$2$3";ae("HYPHENRANGE",`^\\s*(${V[z.XRANGEPLAIN]})\\s+-\\s+(${V[z.XRANGEPLAIN]})\\s*$`);ae("HYPHENRANGELOOSE",`^\\s*(${V[z.XRANGEPLAINLOOSE]})\\s+-\\s+(${V[z.XRANGEPLAINLOOSE]})\\s*$`);ae("STAR","(<|>)?=?\\s*\\*");ae("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$");ae("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")});var ca=x((KT,Zv)=>{var FS=Object.freeze({loose:!0}),OS=Object.freeze({}),LS=r=>r?typeof r!="object"?FS:r:OS;Zv.exports=LS});var ry=x((VT,ny)=>{var ey=/^[0-9]+$/,ty=(r,e)=>{let t=ey.test(r),n=ey.test(e);return t&&n&&(r=+r,e=+e),r===e?0:t&&!n?-1:n&&!t?1:r<e?-1:1},MS=(r,e)=>ty(e,r);ny.exports={compareIdentifiers:ty,rcompareIdentifiers:MS}});var ps=x((zT,ay)=>{var ua=hs(),{MAX_LENGTH:iy,MAX_SAFE_INTEGER:da}=oa(),{safeRe:sy,t:oy}=aa(),NS=ca(),{compareIdentifiers:Ei}=ry(),Bl=class r{constructor(e,t){if(t=NS(t),e instanceof r){if(e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>iy)throw new TypeError(`version is longer than ${iy} characters`);ua("SemVer",e,t),this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease;let n=e.trim().match(t.loose?sy[oy.LOOSE]:sy[oy.FULL]);if(!n)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+n[1],this.minor=+n[2],this.patch=+n[3],this.major>da||this.major<0)throw new TypeError("Invalid major version");if(this.minor>da||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>da||this.patch<0)throw new TypeError("Invalid patch version");n[4]?this.prerelease=n[4].split(".").map(i=>{if(/^[0-9]+$/.test(i)){let s=+i;if(s>=0&&s<da)return s}return i}):this.prerelease=[],this.build=n[5]?n[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(ua("SemVer.compare",this.version,this.options,e),!(e instanceof r)){if(typeof e=="string"&&e===this.version)return 0;e=new r(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof r||(e=new r(e,this.options)),Ei(this.major,e.major)||Ei(this.minor,e.minor)||Ei(this.patch,e.patch)}comparePre(e){if(e instanceof r||(e=new r(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let t=0;do{let n=this.prerelease[t],i=e.prerelease[t];if(ua("prerelease compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Ei(n,i)}while(++t)}compareBuild(e){e instanceof r||(e=new r(e,this.options));let t=0;do{let n=this.build[t],i=e.build[t];if(ua("build compare",t,n,i),n===void 0&&i===void 0)return 0;if(i===void 0)return 1;if(n===void 0)return-1;if(n===i)continue;return Ei(n,i)}while(++t)}inc(e,t,n){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",t,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",t,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",t,n),this.inc("pre",t,n);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",t,n),this.inc("pre",t,n);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{let i=Number(n)?1:0;if(!t&&n===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[i];else{let s=this.prerelease.length;for(;--s>=0;)typeof this.prerelease[s]=="number"&&(this.prerelease[s]++,s=-2);if(s===-1){if(t===this.prerelease.join(".")&&n===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(i)}}if(t){let s=[t,i];n===!1&&(s=[t]),Ei(this.prerelease[0],t)===0?isNaN(this.prerelease[1])&&(this.prerelease=s):this.prerelease=s}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};ay.exports=Bl});var dy=x((BT,uy)=>{var cy=ps(),AS=(r,e,t=!1)=>{if(r instanceof cy)return r;try{return new cy(r,e)}catch(n){if(!t)return null;throw n}};uy.exports=AS});var fy=x((GT,ly)=>{var Gl=class{constructor(){this.max=1e3,this.map=new Map}get(e){let t=this.map.get(e);if(t!==void 0)return this.map.delete(e),this.map.set(e,t),t}delete(e){return this.map.delete(e)}set(e,t){if(!this.delete(e)&&t!==void 0){if(this.map.size>=this.max){let i=this.map.keys().next().value;this.delete(i)}this.map.set(e,t)}return this}};ly.exports=Gl});var zr=x((XT,py)=>{var hy=ps(),$S=(r,e,t)=>new hy(r,t).compare(new hy(e,t));py.exports=$S});var my=x((JT,gy)=>{var jS=zr(),US=(r,e,t)=>jS(r,e,t)===0;gy.exports=US});var yy=x((QT,vy)=>{var HS=zr(),WS=(r,e,t)=>HS(r,e,t)!==0;vy.exports=WS});var wy=x((YT,by)=>{var KS=zr(),VS=(r,e,t)=>KS(r,e,t)>0;by.exports=VS});var Ry=x((ZT,Cy)=>{var zS=zr(),BS=(r,e,t)=>zS(r,e,t)>=0;Cy.exports=BS});var Dy=x((eP,Sy)=>{var GS=zr(),XS=(r,e,t)=>GS(r,e,t)<0;Sy.exports=XS});var Ty=x((tP,_y)=>{var JS=zr(),QS=(r,e,t)=>JS(r,e,t)<=0;_y.exports=QS});var ky=x((nP,Py)=>{var YS=my(),ZS=yy(),eD=wy(),tD=Ry(),nD=Dy(),rD=Ty(),iD=(r,e,t,n)=>{switch(e){case"===":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r===t;case"!==":return typeof r=="object"&&(r=r.version),typeof t=="object"&&(t=t.version),r!==t;case"":case"=":case"==":return YS(r,t,n);case"!=":return ZS(r,t,n);case">":return eD(r,t,n);case">=":return tD(r,t,n);case"<":return nD(r,t,n);case"<=":return rD(r,t,n);default:throw new TypeError(`Invalid operator: ${e}`)}};Py.exports=iD});var Ly=x((rP,Oy)=>{var gs=Symbol("SemVer ANY"),Ql=class r{static get ANY(){return gs}constructor(e,t){if(t=Ey(t),e instanceof r){if(e.loose===!!t.loose)return e;e=e.value}e=e.trim().split(/\s+/).join(" "),Jl("comparator",e,t),this.options=t,this.loose=!!t.loose,this.parse(e),this.semver===gs?this.value="":this.value=this.operator+this.semver.version,Jl("comp",this)}parse(e){let t=this.options.loose?xy[Iy.COMPARATORLOOSE]:xy[Iy.COMPARATOR],n=e.match(t);if(!n)throw new TypeError(`Invalid comparator: ${e}`);this.operator=n[1]!==void 0?n[1]:"",this.operator==="="&&(this.operator=""),n[2]?this.semver=new qy(n[2],this.options.loose):this.semver=gs}toString(){return this.value}test(e){if(Jl("Comparator.test",e,this.options.loose),this.semver===gs||e===gs)return!0;if(typeof e=="string")try{e=new qy(e,this.options)}catch{return!1}return Xl(e,this.operator,this.semver,this.options)}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new Fy(e.value,t).test(this.value):e.operator===""?e.value===""?!0:new Fy(this.value,t).test(e.semver):(t=Ey(t),t.includePrerelease&&(this.value==="<0.0.0-0"||e.value==="<0.0.0-0")||!t.includePrerelease&&(this.value.startsWith("<0.0.0")||e.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&e.operator.startsWith(">")||this.operator.startsWith("<")&&e.operator.startsWith("<")||this.semver.version===e.semver.version&&this.operator.includes("=")&&e.operator.includes("=")||Xl(this.semver,"<",e.semver,t)&&this.operator.startsWith(">")&&e.operator.startsWith("<")||Xl(this.semver,">",e.semver,t)&&this.operator.startsWith("<")&&e.operator.startsWith(">")))}};Oy.exports=Ql;var Ey=ca(),{safeRe:xy,t:Iy}=aa(),Xl=ky(),Jl=hs(),qy=ps(),Fy=Yl()});var Yl=x((iP,$y)=>{var sD=/\s+/g,Zl=class r{constructor(e,t){if(t=aD(t),e instanceof r)return e.loose===!!t.loose&&e.includePrerelease===!!t.includePrerelease?e:new r(e.raw,t);if(e instanceof ef)return this.raw=e.value,this.set=[[e]],this.formatted=void 0,this;if(this.options=t,this.loose=!!t.loose,this.includePrerelease=!!t.includePrerelease,this.raw=e.trim().replace(sD," "),this.set=this.raw.split("||").map(n=>this.parseRange(n.trim())).filter(n=>n.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){let n=this.set[0];if(this.set=this.set.filter(i=>!Ny(i[0])),this.set.length===0)this.set=[n];else if(this.set.length>1){for(let i of this.set)if(i.length===1&&pD(i[0])){this.set=[i];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let e=0;e<this.set.length;e++){e>0&&(this.formatted+="||");let t=this.set[e];for(let n=0;n<t.length;n++)n>0&&(this.formatted+=" "),this.formatted+=t[n].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(e){let n=((this.options.includePrerelease&&fD)|(this.options.loose&&hD))+":"+e,i=My.get(n);if(i)return i;let s=this.options.loose,o=s?Gt[Nt.HYPHENRANGELOOSE]:Gt[Nt.HYPHENRANGE];e=e.replace(o,DD(this.options.includePrerelease)),Ue("hyphen replace",e),e=e.replace(Gt[Nt.COMPARATORTRIM],uD),Ue("comparator trim",e),e=e.replace(Gt[Nt.TILDETRIM],dD),Ue("tilde trim",e),e=e.replace(Gt[Nt.CARETTRIM],lD),Ue("caret trim",e);let a=e.split(" ").map(m=>gD(m,this.options)).join(" ").split(/\s+/).map(m=>SD(m,this.options));s&&(a=a.filter(m=>(Ue("loose invalid filter",m,this.options),!!m.match(Gt[Nt.COMPARATORLOOSE])))),Ue("range list",a);let u=new Map,d=a.map(m=>new ef(m,this.options));for(let m of d){if(Ny(m))return[m];u.set(m.value,m)}u.size>1&&u.has("")&&u.delete("");let p=[...u.values()];return My.set(n,p),p}intersects(e,t){if(!(e instanceof r))throw new TypeError("a Range is required");return this.set.some(n=>Ay(n,t)&&e.set.some(i=>Ay(i,t)&&n.every(s=>i.every(o=>s.intersects(o,t)))))}test(e){if(!e)return!1;if(typeof e=="string")try{e=new cD(e,this.options)}catch{return!1}for(let t=0;t<this.set.length;t++)if(_D(this.set[t],e,this.options))return!0;return!1}};$y.exports=Zl;var oD=fy(),My=new oD,aD=ca(),ef=Ly(),Ue=hs(),cD=ps(),{safeRe:Gt,t:Nt,comparatorTrimReplace:uD,tildeTrimReplace:dD,caretTrimReplace:lD}=aa(),{FLAG_INCLUDE_PRERELEASE:fD,FLAG_LOOSE:hD}=oa(),Ny=r=>r.value==="<0.0.0-0",pD=r=>r.value==="",Ay=(r,e)=>{let t=!0,n=r.slice(),i=n.pop();for(;t&&n.length;)t=n.every(s=>i.intersects(s,e)),i=n.pop();return t},gD=(r,e)=>(Ue("comp",r,e),r=yD(r,e),Ue("caret",r),r=mD(r,e),Ue("tildes",r),r=wD(r,e),Ue("xrange",r),r=RD(r,e),Ue("stars",r),r),At=r=>!r||r.toLowerCase()==="x"||r==="*",mD=(r,e)=>r.trim().split(/\s+/).map(t=>vD(t,e)).join(" "),vD=(r,e)=>{let t=e.loose?Gt[Nt.TILDELOOSE]:Gt[Nt.TILDE];return r.replace(t,(n,i,s,o,a)=>{Ue("tilde",r,n,i,s,o,a);let u;return At(i)?u="":At(s)?u=`>=${i}.0.0 <${+i+1}.0.0-0`:At(o)?u=`>=${i}.${s}.0 <${i}.${+s+1}.0-0`:a?(Ue("replaceTilde pr",a),u=`>=${i}.${s}.${o}-${a} <${i}.${+s+1}.0-0`):u=`>=${i}.${s}.${o} <${i}.${+s+1}.0-0`,Ue("tilde return",u),u})},yD=(r,e)=>r.trim().split(/\s+/).map(t=>bD(t,e)).join(" "),bD=(r,e)=>{Ue("caret",r,e);let t=e.loose?Gt[Nt.CARETLOOSE]:Gt[Nt.CARET],n=e.includePrerelease?"-0":"";return r.replace(t,(i,s,o,a,u)=>{Ue("caret",r,i,s,o,a,u);let d;return At(s)?d="":At(o)?d=`>=${s}.0.0${n} <${+s+1}.0.0-0`:At(a)?s==="0"?d=`>=${s}.${o}.0${n} <${s}.${+o+1}.0-0`:d=`>=${s}.${o}.0${n} <${+s+1}.0.0-0`:u?(Ue("replaceCaret pr",u),s==="0"?o==="0"?d=`>=${s}.${o}.${a}-${u} <${s}.${o}.${+a+1}-0`:d=`>=${s}.${o}.${a}-${u} <${s}.${+o+1}.0-0`:d=`>=${s}.${o}.${a}-${u} <${+s+1}.0.0-0`):(Ue("no pr"),s==="0"?o==="0"?d=`>=${s}.${o}.${a}${n} <${s}.${o}.${+a+1}-0`:d=`>=${s}.${o}.${a}${n} <${s}.${+o+1}.0-0`:d=`>=${s}.${o}.${a} <${+s+1}.0.0-0`),Ue("caret return",d),d})},wD=(r,e)=>(Ue("replaceXRanges",r,e),r.split(/\s+/).map(t=>CD(t,e)).join(" ")),CD=(r,e)=>{r=r.trim();let t=e.loose?Gt[Nt.XRANGELOOSE]:Gt[Nt.XRANGE];return r.replace(t,(n,i,s,o,a,u)=>{Ue("xRange",r,n,i,s,o,a,u);let d=At(s),p=d||At(o),m=p||At(a),g=m;return i==="="&&g&&(i=""),u=e.includePrerelease?"-0":"",d?i===">"||i==="<"?n="<0.0.0-0":n="*":i&&g?(p&&(o=0),a=0,i===">"?(i=">=",p?(s=+s+1,o=0,a=0):(o=+o+1,a=0)):i==="<="&&(i="<",p?s=+s+1:o=+o+1),i==="<"&&(u="-0"),n=`${i+s}.${o}.${a}${u}`):p?n=`>=${s}.0.0${u} <${+s+1}.0.0-0`:m&&(n=`>=${s}.${o}.0${u} <${s}.${+o+1}.0-0`),Ue("xRange return",n),n})},RD=(r,e)=>(Ue("replaceStars",r,e),r.trim().replace(Gt[Nt.STAR],"")),SD=(r,e)=>(Ue("replaceGTE0",r,e),r.trim().replace(Gt[e.includePrerelease?Nt.GTE0PRE:Nt.GTE0],"")),DD=r=>(e,t,n,i,s,o,a,u,d,p,m,g)=>(At(n)?t="":At(i)?t=`>=${n}.0.0${r?"-0":""}`:At(s)?t=`>=${n}.${i}.0${r?"-0":""}`:o?t=`>=${t}`:t=`>=${t}${r?"-0":""}`,At(d)?u="":At(p)?u=`<${+d+1}.0.0-0`:At(m)?u=`<${d}.${+p+1}.0-0`:g?u=`<=${d}.${p}.${m}-${g}`:r?u=`<${d}.${p}.${+m+1}-0`:u=`<=${u}`,`${t} ${u}`.trim()),_D=(r,e,t)=>{for(let n=0;n<r.length;n++)if(!r[n].test(e))return!1;if(e.prerelease.length&&!t.includePrerelease){for(let n=0;n<r.length;n++)if(Ue(r[n].semver),r[n].semver!==ef.ANY&&r[n].semver.prerelease.length>0){let i=r[n].semver;if(i.major===e.major&&i.minor===e.minor&&i.patch===e.patch)return!0}return!1}return!0}});var Uy=x((sP,jy)=>{var TD=Yl(),PD=(r,e,t)=>{try{e=new TD(e,t)}catch{return!1}return e.test(r)};jy.exports=PD});var Wy=x(an=>{"use strict";var kD=an&&an.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),tf=an&&an.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&kD(e,r,t)};Object.defineProperty(an,"__esModule",{value:!0});an.DiagnosticPullMode=an.vsdiag=void 0;tf(re(),an);tf(we(),an);var Hy=cd();Object.defineProperty(an,"vsdiag",{enumerable:!0,get:function(){return Hy.vsdiag}});Object.defineProperty(an,"DiagnosticPullMode",{enumerable:!0,get:function(){return Hy.DiagnosticPullMode}});tf(Wl(),an)});var la=x(Xt=>{"use strict";var ED=Xt&&Xt.__createBinding||(Object.create?function(r,e,t,n){n===void 0&&(n=t);var i=Object.getOwnPropertyDescriptor(e,t);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(r,n,i)}:function(r,e,t,n){n===void 0&&(n=t),r[n]=e[t]}),zy=Xt&&Xt.__exportStar||function(r,e){for(var t in r)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&ED(e,r,t)};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.SettingMonitor=Xt.LanguageClient=Xt.TransportKind=void 0;var ir=require("child_process"),nf=require("fs"),rf=require("path"),kr=require("vscode"),Ve=hn(),Ky=Wl(),xD=Gv(),Xe=Kl(),ID=dy(),qD=Uy();zy(Kl(),Xt);zy(Wy(),Xt);var Vy="^1.82.0",Je;(function(r){r[r.stdio=0]="stdio",r[r.ipc=1]="ipc",r[r.pipe=2]="pipe",r[r.socket=3]="socket"})(Je||(Xt.TransportKind=Je={}));var Pr;(function(r){function e(t){let n=t;return n&&n.kind===Je.socket&&Ve.number(n.port)}r.isSocket=e})(Pr||(Pr={}));var sf;(function(r){function e(t){return Ve.string(t.command)}r.is=e})(sf||(sf={}));var of;(function(r){function e(t){return Ve.string(t.module)}r.is=e})(of||(of={}));var af;(function(r){function e(t){let n=t;return n&&n.writer!==void 0&&n.reader!==void 0}r.is=e})(af||(af={}));var cf;(function(r){function e(t){let n=t;return n&&n.process!==void 0&&typeof n.detached=="boolean"}r.is=e})(cf||(cf={}));var uf=class extends Ky.BaseLanguageClient{constructor(e,t,n,i,s){let o,a,u,d,p;Ve.string(t)?(o=e,a=t,u=n,d=i,p=!!s):(o=e.toLowerCase(),a=e,u=t,d=n,p=i),p===void 0&&(p=!1),super(o,a,d),this._serverOptions=u,this._forceDebug=p,this._isInDebugMode=p;try{this.checkVersion()}catch(m){throw Ve.string(m.message)&&this.outputChannel.appendLine(m.message),m}}checkVersion(){let e=ID(kr.version);if(!e)throw new Error(`No valid VS Code version detected. Version string is: ${kr.version}`);if(e.prerelease&&e.prerelease.length>0&&(e.prerelease=[]),!qD(e,Vy))throw new Error(`The language client requires VS Code version ${Vy} but received version ${kr.version}`)}get isInDebugMode(){return this._isInDebugMode}async restart(){await this.stop(),this.isInDebugMode?(await new Promise(e=>setTimeout(e,1e3)),await this.start()):await this.start()}stop(e=2e3){return super.stop(e).finally(()=>{if(this._serverProcess){let t=this._serverProcess;this._serverProcess=void 0,(this._isDetached===void 0||!this._isDetached)&&this.checkProcessDied(t),this._isDetached=void 0}})}checkProcessDied(e){!e||e.pid===void 0||setTimeout(()=>{try{e.pid!==void 0&&(process.kill(e.pid,0),(0,xD.terminate)(e))}catch{}},2e3)}handleConnectionClosed(){return this._serverProcess=void 0,super.handleConnectionClosed()}fillInitializeParams(e){super.fillInitializeParams(e),e.processId===null&&(e.processId=process.pid)}createMessageTransports(e){function t(p,m){if(!p&&!m)return;let g=Object.create(null);return Object.keys(process.env).forEach(S=>g[S]=process.env[S]),m&&(g.ELECTRON_RUN_AS_NODE="1",g.ELECTRON_NO_ASAR="1"),p&&Object.keys(p).forEach(S=>g[S]=p[S]),g}let n=["--debug=","--debug-brk=","--inspect=","--inspect-brk="],i=["--debug","--debug-brk","--inspect","--inspect-brk"];function s(){let p=process.execArgv;return p?p.some(m=>n.some(g=>m.startsWith(g))||i.some(g=>m===g)):!1}function o(p){if(p.stdin===null||p.stdout===null||p.stderr===null)throw new Error("Process created without stdio streams")}let a=this._serverOptions;if(Ve.func(a))return a().then(p=>{if(Ky.MessageTransports.is(p))return this._isDetached=!!p.detached,p;if(af.is(p))return this._isDetached=!!p.detached,{reader:new Xe.StreamMessageReader(p.reader),writer:new Xe.StreamMessageWriter(p.writer)};{let m;return cf.is(p)?(m=p.process,this._isDetached=p.detached):(m=p,this._isDetached=!1),m.stderr.on("data",g=>this.outputChannel.append(Ve.string(g)?g:g.toString(e))),{reader:new Xe.StreamMessageReader(m.stdout),writer:new Xe.StreamMessageWriter(m.stdin)}}});let u,d=a;return d.run||d.debug?this._forceDebug||s()?(u=d.debug,this._isInDebugMode=!0):(u=d.run,this._isInDebugMode=!1):u=a,this._getServerWorkingDir(u.options).then(p=>{if(of.is(u)&&u.module){let m=u,g=m.transport||Je.stdio;if(m.runtime){let S=[],y=m.options??Object.create(null);y.execArgv&&y.execArgv.forEach(N=>S.push(N)),S.push(m.module),m.args&&m.args.forEach(N=>S.push(N));let P=Object.create(null);P.cwd=p,P.env=t(y.env,!1);let E=this._getRuntimePath(m.runtime,p),L;if(g===Je.ipc?(P.stdio=[null,null,null,"ipc"],S.push("--node-ipc")):g===Je.stdio?S.push("--stdio"):g===Je.pipe?(L=(0,Xe.generateRandomPipeName)(),S.push(`--pipe=${L}`)):Pr.isSocket(g)&&S.push(`--socket=${g.port}`),S.push(`--clientProcessId=${process.pid.toString()}`),g===Je.ipc||g===Je.stdio){let N=ir.spawn(E,S,P);return!N||!N.pid?xi(N,`Launching server using runtime ${E} failed.`):(this._serverProcess=N,N.stderr.on("data",M=>this.outputChannel.append(Ve.string(M)?M:M.toString(e))),g===Je.ipc?(N.stdout.on("data",M=>this.outputChannel.append(Ve.string(M)?M:M.toString(e))),Promise.resolve({reader:new Xe.IPCMessageReader(N),writer:new Xe.IPCMessageWriter(N)})):Promise.resolve({reader:new Xe.StreamMessageReader(N.stdout),writer:new Xe.StreamMessageWriter(N.stdin)}))}else{if(g===Je.pipe)return(0,Xe.createClientPipeTransport)(L).then(N=>{let M=ir.spawn(E,S,P);return!M||!M.pid?xi(M,`Launching server using runtime ${E} failed.`):(this._serverProcess=M,M.stderr.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),M.stdout.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),N.onConnected().then(H=>({reader:H[0],writer:H[1]})))});if(Pr.isSocket(g))return(0,Xe.createClientSocketTransport)(g.port).then(N=>{let M=ir.spawn(E,S,P);return!M||!M.pid?xi(M,`Launching server using runtime ${E} failed.`):(this._serverProcess=M,M.stderr.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),M.stdout.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),N.onConnected().then(H=>({reader:H[0],writer:H[1]})))})}}else{let S;return new Promise((y,P)=>{let E=(m.args&&m.args.slice())??[];g===Je.ipc?E.push("--node-ipc"):g===Je.stdio?E.push("--stdio"):g===Je.pipe?(S=(0,Xe.generateRandomPipeName)(),E.push(`--pipe=${S}`)):Pr.isSocket(g)&&E.push(`--socket=${g.port}`),E.push(`--clientProcessId=${process.pid.toString()}`);let L=m.options??Object.create(null);if(L.env=t(L.env,!0),L.execArgv=L.execArgv||[],L.cwd=p,L.silent=!0,g===Je.ipc||g===Je.stdio){let N=ir.fork(m.module,E||[],L);o(N),this._serverProcess=N,N.stderr.on("data",M=>this.outputChannel.append(Ve.string(M)?M:M.toString(e))),g===Je.ipc?(N.stdout.on("data",M=>this.outputChannel.append(Ve.string(M)?M:M.toString(e))),y({reader:new Xe.IPCMessageReader(this._serverProcess),writer:new Xe.IPCMessageWriter(this._serverProcess)})):y({reader:new Xe.StreamMessageReader(N.stdout),writer:new Xe.StreamMessageWriter(N.stdin)})}else g===Je.pipe?(0,Xe.createClientPipeTransport)(S).then(N=>{let M=ir.fork(m.module,E||[],L);o(M),this._serverProcess=M,M.stderr.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),M.stdout.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),N.onConnected().then(H=>{y({reader:H[0],writer:H[1]})},P)},P):Pr.isSocket(g)&&(0,Xe.createClientSocketTransport)(g.port).then(N=>{let M=ir.fork(m.module,E||[],L);o(M),this._serverProcess=M,M.stderr.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),M.stdout.on("data",H=>this.outputChannel.append(Ve.string(H)?H:H.toString(e))),N.onConnected().then(H=>{y({reader:H[0],writer:H[1]})},P)},P)})}}else if(sf.is(u)&&u.command){let m=u,g=u.args!==void 0?u.args.slice(0):[],S,y=u.transport;if(y===Je.stdio)g.push("--stdio");else if(y===Je.pipe)S=(0,Xe.generateRandomPipeName)(),g.push(`--pipe=${S}`);else if(Pr.isSocket(y))g.push(`--socket=${y.port}`);else if(y===Je.ipc)throw new Error("Transport kind ipc is not support for command executable");let P=Object.assign({},m.options);if(P.cwd=P.cwd||p,y===void 0||y===Je.stdio){let E=ir.spawn(m.command,g,P);return!E||!E.pid?xi(E,`Launching server using command ${m.command} failed.`):(E.stderr.on("data",L=>this.outputChannel.append(Ve.string(L)?L:L.toString(e))),this._serverProcess=E,this._isDetached=!!P.detached,Promise.resolve({reader:new Xe.StreamMessageReader(E.stdout),writer:new Xe.StreamMessageWriter(E.stdin)}))}else{if(y===Je.pipe)return(0,Xe.createClientPipeTransport)(S).then(E=>{let L=ir.spawn(m.command,g,P);return!L||!L.pid?xi(L,`Launching server using command ${m.command} failed.`):(this._serverProcess=L,this._isDetached=!!P.detached,L.stderr.on("data",N=>this.outputChannel.append(Ve.string(N)?N:N.toString(e))),L.stdout.on("data",N=>this.outputChannel.append(Ve.string(N)?N:N.toString(e))),E.onConnected().then(N=>({reader:N[0],writer:N[1]})))});if(Pr.isSocket(y))return(0,Xe.createClientSocketTransport)(y.port).then(E=>{let L=ir.spawn(m.command,g,P);return!L||!L.pid?xi(L,`Launching server using command ${m.command} failed.`):(this._serverProcess=L,this._isDetached=!!P.detached,L.stderr.on("data",N=>this.outputChannel.append(Ve.string(N)?N:N.toString(e))),L.stdout.on("data",N=>this.outputChannel.append(Ve.string(N)?N:N.toString(e))),E.onConnected().then(N=>({reader:N[0],writer:N[1]})))})}}return Promise.reject(new Error("Unsupported server configuration "+JSON.stringify(a,null,4)))}).finally(()=>{this._serverProcess!==void 0&&this._serverProcess.on("exit",(p,m)=>{p!==null&&this.error(`Server process exited with code ${p}.`,void 0,!1),m!==null&&this.error(`Server process exited with signal ${m}.`,void 0,!1)})})}_getRuntimePath(e,t){if(rf.isAbsolute(e))return e;let n=this._mainGetRootPath();if(n!==void 0){let i=rf.join(n,e);if(nf.existsSync(i))return i}if(t!==void 0){let i=rf.join(t,e);if(nf.existsSync(i))return i}return e}_mainGetRootPath(){let e=kr.workspace.workspaceFolders;if(!e||e.length===0)return;let t=e[0];if(t.uri.scheme==="file")return t.uri.fsPath}_getServerWorkingDir(e){let t=e&&e.cwd;return t||(t=this.clientOptions.workspaceFolder?this.clientOptions.workspaceFolder.uri.fsPath:this._mainGetRootPath()),t?new Promise(n=>{nf.lstat(t,(i,s)=>{n(!i&&s.isDirectory()?t:void 0)})}):Promise.resolve(void 0)}};Xt.LanguageClient=uf;var df=class{constructor(e,t){this._client=e,this._setting=t,this._listeners=[]}start(){return kr.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration,this,this._listeners),this.onDidChangeConfiguration(),new kr.Disposable(()=>{this._client.needsStop()&&this._client.stop()})}onDidChangeConfiguration(){let e=this._setting.indexOf("."),t=e>=0?this._setting.substr(0,e):this._setting,n=e>=0?this._setting.substr(e+1):void 0,i=n?kr.workspace.getConfiguration(t).get(n,!1):kr.workspace.getConfiguration(t);i&&this._client.needsStart()?this._client.start().catch(s=>this._client.error("Start failed after configuration change",s,"force")):!i&&this._client.needsStop()&&this._client.stop().catch(s=>this._client.error("Stop failed after configuration change",s,"force"))}};Xt.SettingMonitor=df;function xi(r,e){return r===null?Promise.reject(e):new Promise((t,n)=>{r.on("error",i=>{n(`${e} ${i}`)}),setImmediate(()=>n(e))})}});var fa=x((cP,By)=>{"use strict";By.exports=la()});var VD={};Ib(VD,{activate:()=>UD,deactivate:()=>HD});module.exports=qb(VD);var Db=te(require("os")),Yt=te(require("vscode"));var $=te(require("vscode")),Pf=te(fa());var ms=class{provideTextDocumentContent(e){let t="Not a valid Ruby LSP document";switch(e.path){case"show-syntax-tree":t=e.query;break}return t}};var ob=require("crypto"),Qe=te(require("vscode")),Ta=te(fa());var Ra=te(require("path")),pf=te(require("os")),rt=te(require("vscode"));var Gy=require("child_process"),Xy=require("crypto"),Jy=require("util"),Er=te(require("vscode"));var wn=new Er.EventEmitter,It=(0,Jy.promisify)(Gy.exec),ha="Ruby LSP",sr=Er.window.createOutputChannel(ha,{log:!0}),xr=["ruby","erb"],lf={tapiocaAddon:0,launcher:.05};function Qy(r,e){let t=null;return function(...n){return t&&clearTimeout(t),new Promise((i,s)=>{t=setTimeout(()=>{r(...n).then(o=>i(o)).catch(o=>s(o))},e)})}}function ff(r){let e=Er.workspace.getConfiguration("rubyLsp").get("featureFlags");if(e[r]===!1||e.all===!1)return!1;if(e.all||e[r])return!0;let t=lf[r],n=Er.env.machineId,i=(0,Xy.createHash)("sha256").update(`${n}-${r}`).digest("hex");return parseInt(i.substring(0,8),16)/4294967295<t}var Gr=te(require("vscode"));var vs=te(require("path")),Yy=te(require("os")),or=te(require("vscode"));var Br="RUBY_LSP_ACTIVATION_SEPARATOR",vt=class{constructor(e,t,n){this.activationScript=[`STDERR.print("${Br}" + `,"{ env: ENV.to_h, yjit: !!defined?(RubyVM::YJIT), version: RUBY_VERSION, gemPath: Gem.path }.to_json + ",`"${Br}")`].join("");this.workspaceFolder=e,this.outputChannel=t,this.manuallySelectRuby=n;let i=or.workspace.getConfiguration("rubyLsp").get("bundleGemfile");i.length>0&&(this.customBundleGemfile=vs.default.isAbsolute(i)?i:vs.default.resolve(vs.default.join(this.workspaceFolder.uri.fsPath,i))),this.bundleUri=this.customBundleGemfile?or.Uri.file(vs.default.dirname(this.customBundleGemfile)):e.uri}async runEnvActivationScript(e){let t=await this.runScript(`${e} -W0 -rjson -e '${this.activationScript}'`),n=new RegExp(`${Br}(.*)${Br}`).exec(t.stderr);return this.parseWithErrorHandling(n[1])}parseWithErrorHandling(e){try{return JSON.parse(e)}catch(t){throw this.outputChannel.error(`Tried parsing invalid JSON environment: ${e}`),t}}runScript(e){let t;return or.env.shell.length>0&&Yy.default.platform()!=="win32"&&(t=or.env.shell),this.outputChannel.info(`Running command: \`${e}\` in ${this.bundleUri.fsPath} using shell: ${t}`),this.outputChannel.debug(`Environment used for command: ${JSON.stringify(process.env)}`),It(e,{cwd:this.bundleUri.fsPath,shell:t,env:process.env})}async findExec(e,t){for(let n of e)try{let i=or.Uri.joinPath(n,t);return await or.workspace.fs.stat(i),this.outputChannel.info(`Found ${t} executable at ${n.fsPath}`),i.fsPath}catch{}return t}};var pa=class extends vt{async activate(){try{await Gr.workspace.fs.stat(Gr.Uri.joinPath(this.bundleUri,".shadowenv.d"))}catch{throw new Error("The Ruby LSP version manager is configured to be shadowenv,         but no .shadowenv.d directory was found in the workspace")}let e=await this.findExec([Gr.Uri.file("/opt/homebrew/bin")],"shadowenv");try{let t=await this.runEnvActivationScript(`${e} exec -- ruby`);return delete t.env.BUNDLE_GEMFILE,{env:{...process.env,...t.env},yjit:t.yjit,version:t.version,gemPath:t.gemPath}}catch(t){if(t.message.includes("untrusted shadowenv program")){if(await Gr.window.showErrorMessage(`Tried to activate Shadowenv, but the workspace is untrusted.
           Workspaces must be trusted to before allowing Shadowenv to load the environment for security reasons.`,"Trust workspace","Shutdown Ruby LSP")==="Trust workspace")return await It("shadowenv trust",{cwd:this.bundleUri.fsPath}),this.activate();throw new Error("Cannot activate Ruby environment in an untrusted workspace")}try{await It("shadowenv --version")}catch{throw new Error(`Shadowenv executable not found. Ensure it is installed and available in the PATH.
           This error may happen if your shell configuration is failing to be sourced from the editor or if
           another extension is mutating the process PATH.`)}throw new Error(`Failed to activate Ruby environment with Shadowenv: ${t.message}`)}}};var hf=te(require("os")),zn=te(require("path")),Ee=te(require("vscode"));var ys=class extends Error{},Ii=class extends vt{constructor(t,n,i){super(t,n,i);this.rubyInstallationUris=[Ee.Uri.joinPath(Ee.Uri.file(hf.default.homedir()),".rubies"),Ee.Uri.joinPath(Ee.Uri.file("/"),"opt","rubies")];let s=Ee.workspace.getConfiguration("rubyLsp").get("rubyVersionManager.chrubyRubies");s&&this.rubyInstallationUris.push(...s.map(o=>Ee.Uri.file(o)))}async activate(){let t=await this.discoverRubyVersion(),n;try{if(t)n=await this.findRubyUri(t);else{let d=await this.fallbackWithCancellation("No .ruby-version file found. Trying to fall back to latest installed Ruby in 10 seconds","You can create a .ruby-version file in a parent directory to configure a fallback",this.findFallbackRuby.bind(this),this.rubyVersionError.bind(this));t=d.rubyVersion,n=d.uri}}catch(d){if(d instanceof ys)return this.activate();throw d}try{if(!n){let d={...t},p=await this.fallbackWithCancellation(`Couldn't find installation for ${t.version}. Trying to fall back to other Ruby in 10 seconds`,"You can cancel this fallback and install the required Ruby",async()=>this.findClosestRubyInstallation(d),()=>this.missingRubyError(d.version));t=p.rubyVersion,n=p.uri}}catch(d){if(d instanceof ys)return this.activate();throw d}this.outputChannel.info(`Discovered Ruby installation at ${n.fsPath}`);let{defaultGems:i,gemHome:s,yjit:o,version:a}=await this.runActivationScript(n,t);this.outputChannel.info(`Activated Ruby environment: defaultGems=${i} gemHome=${s} yjit=${o}`);let u={GEM_HOME:s,GEM_PATH:`${s}${zn.default.delimiter}${i}`,PATH:`${zn.default.join(s,"bin")}${zn.default.delimiter}${zn.default.join(i,"bin")}${zn.default.delimiter}${zn.default.dirname(n.fsPath)}${zn.default.delimiter}${this.getProcessPath()}`};return{env:{...process.env,...u},yjit:o,version:a,gemPath:[s,i]}}getProcessPath(){return process.env.PATH}async findRubyUri(t){let n=t.engine?[`${t.engine}-${t.version}`,t.version]:[t.version,`ruby-${t.version}`];for(let i of this.rubyInstallationUris){let s;try{s=(await Ee.workspace.fs.readDirectory(i)).sort((o,a)=>a[0].localeCompare(o[0]))}catch{this.outputChannel.debug(`Tried searching for Ruby installation in ${i.fsPath} but it doesn't exist`);continue}for(let o of n){let a=s.find(([u])=>u.startsWith(o));if(a)return Ee.Uri.joinPath(i,a[0],"bin","ruby")}}}async findClosestRubyInstallation(t){let[n,i,s]=t.version.split("."),o=[];for(let u of this.rubyInstallationUris)try{(await Ee.workspace.fs.readDirectory(u)).forEach(([d])=>{let p=/((?<engine>[A-Za-z]+)-)?(?<version>\d+\.\d+(\.\d+)?(-[A-Za-z0-9]+)?)/.exec(d);p?.groups&&p.groups.version.startsWith(n)&&o.push({uri:Ee.Uri.joinPath(u,d,"bin","ruby"),rubyVersion:{engine:p.groups.engine,version:p.groups.version}})})}catch{this.outputChannel.debug(`Tried searching for Ruby installation in ${u.fsPath} but it doesn't exist`);continue}let a=o.sort((u,d)=>{let p=u.rubyVersion.version.split("."),m=d.rubyVersion.version.split("."),g=Math.abs(Number(p[1])-Number(i)),S=Math.abs(Number(m[1])-Number(i));return g===S?Number(m[2]||0)-Number(p[2]||0):g-S})[0];if(a)return a;throw new Error("Cannot find any Ruby installations")}async discoverRubyVersion(){let t=this.bundleUri,n=zn.default.parse(t.fsPath).root,i,s;for(;t.fsPath!==n;){try{s=Ee.Uri.joinPath(t,".ruby-version"),i=(await Ee.workspace.fs.readFile(s)).toString().trim()}catch{t=Ee.Uri.file(zn.default.dirname(t.fsPath));continue}if(i==="")throw new Error(`Ruby version file ${s} is empty`);let o=/((?<engine>[A-Za-z]+)-)?(?<version>\d+\.\d+(\.\d+)?(-[A-Za-z0-9]+)?)/.exec(i);if(!o?.groups)throw new Error(`Ruby version file ${s} contains invalid format. Expected (engine-)?version, got ${i}`);return this.outputChannel.info(`Discovered Ruby version ${i} from ${s.fsPath}`),{engine:o.groups.engine,version:o.groups.version}}}async fallbackWithCancellation(t,n,i,s){let o;try{o=await Ee.workspace.fs.readFile(Ee.Uri.joinPath(this.workspaceFolder.uri,"Gemfile"))}catch{}if(o&&/^ruby(\s|\()("|')[\d.]+/.test(o.toString()))throw s();return await Ee.window.withProgress({title:t,location:Ee.ProgressLocation.Notification,cancellable:!0},async(u,d)=>{if(u.report({message:n}),await new Promise(p=>{setTimeout(p,1e4),d.onCancellationRequested(()=>{p()})}),d.isCancellationRequested)throw await this.handleCancelledFallback(s),new ys;return i()})}async handleCancelledFallback(t){let n=await Ee.window.showInformationMessage(`The Ruby LSP requires a Ruby version to launch.
      You can define a fallback for the system or for the Ruby LSP only`,"System","Ruby LSP only");throw n==="System"?await this.createParentRubyVersionFile(t):n==="Ruby LSP only"&&await this.manuallySelectRuby(),t()}async createParentRubyVersionFile(t){let n=[];for(let o of this.rubyInstallationUris){let a;try{a=(await Ee.workspace.fs.readDirectory(o)).sort((u,d)=>d[0].localeCompare(u[0])),a.forEach(u=>{n.push({label:u[0]})})}catch{continue}}let i=await Ee.window.showQuickPick(n,{title:"Select a Ruby version to use as fallback",ignoreFocusOut:!0});if(!i)throw t();let s=await Ee.window.showOpenDialog({defaultUri:Ee.Uri.file(hf.default.homedir()),openLabel:"Add fallback in this directory",canSelectFiles:!1,canSelectFolders:!0,canSelectMany:!1,title:"Select the directory to create the .ruby-version fallback in"});if(!s)throw t();await Ee.workspace.fs.writeFile(Ee.Uri.joinPath(s[0],".ruby-version"),Buffer.from(i.label))}async findFallbackRuby(){for(let t of this.rubyInstallationUris){let n;try{n=(await Ee.workspace.fs.readDirectory(t)).sort((o,a)=>a[0].localeCompare(o[0]));let i,s;for(let o of n){let a=/((?<engine>[A-Za-z]+)-)?(?<version>\d+\.\d+(\.\d+)?(-[A-Za-z0-9]+)?)/.exec(o[0]);if(a?.groups){i=a.groups,s=o;break}}if(s)return{uri:Ee.Uri.joinPath(t,s[0],"bin","ruby"),rubyVersion:{engine:i.engine,version:i.version}}}catch{this.outputChannel.debug(`Tried searching for Ruby installation in ${t.fsPath} but it doesn't exist`);continue}}throw new Error("Cannot find any Ruby installations")}async runActivationScript(t,n){let i=["user_dir = Gem.user_dir","paths = Gem.path","if paths.length > 2","  paths.delete(Gem.default_dir)","  paths.delete(Gem.user_dir)","  if paths[0]","    user_dir = paths[0] if Dir.exist?(paths[0])","  end","end",`newer_gem_home = File.join(File.dirname(user_dir), "${n.version}")`,"gems = (Dir.exist?(newer_gem_home) ? newer_gem_home : user_dir)",`STDERR.print([Gem.default_dir, gems, !!defined?(RubyVM::YJIT), RUBY_VERSION].join("${Br}"))`].join(";"),s=await this.runScript(`${t.fsPath} -W0 -e '${i}'`),[o,a,u,d]=s.stderr.split(Br);return{defaultGems:o,gemHome:a,yjit:u==="true",version:d}}missingRubyError(t){return new Error(`Cannot find Ruby installation for version ${t}`)}rubyVersionError(){return new Error(`Cannot find .ruby-version file. Please specify the Ruby version in a
           .ruby-version either in ${this.bundleUri.fsPath} or in a parent directory`)}};var Zy=te(require("os")),Xr=te(require("vscode"));var ga=class extends vt{async activate(){let e=await this.findMiseUri(),t=await this.runEnvActivationScript(`${e.fsPath} x -- ruby`);return{env:{...process.env,...t.env},yjit:t.yjit,version:t.version,gemPath:t.gemPath}}async findMiseUri(){let t=Xr.workspace.getConfiguration("rubyLsp").get("rubyVersionManager.miseExecutablePath"),n=t?Xr.Uri.file(t):Xr.Uri.joinPath(Xr.Uri.file(Zy.default.homedir()),".local","bin","mise");try{return await Xr.workspace.fs.stat(n),n}catch{}throw new Error(`The Ruby LSP version manager is configured to be Mise, but ${n.fsPath} does not exist`)}};var ma=te(require("os")),Ir=te(require("vscode"));var va=class extends Ii{getProcessPath(){return process.env.Path??process.env.PATH??process.env.path}async findRubyUri(e){let[t,n,i]=e.version.split(".").map(Number),s=[Ir.Uri.joinPath(Ir.Uri.file("C:"),`Ruby${t}${n}-${ma.default.arch()}`),Ir.Uri.joinPath(Ir.Uri.file(ma.default.homedir()),`Ruby${t}${n}-${ma.default.arch()}`)];for(let o of s)try{return await Ir.workspace.fs.stat(o),Ir.Uri.joinPath(o,"bin","ruby")}catch{}throw new Error(`Cannot find installation directory for Ruby version ${e.version}.         Searched in ${s.map(o=>o.fsPath).join(", ")}`)}runScript(e){return this.outputChannel.info(`Running command: \`${e}\` in ${this.bundleUri.fsPath}`),this.outputChannel.debug(`Environment used for command: ${JSON.stringify(process.env)}`),It(e,{cwd:this.bundleUri.fsPath,env:process.env})}};var Jr=te(require("vscode"));var ya=class extends vt{async activate(){let e=await this.findRbenv(),t=await this.runEnvActivationScript(`${e} exec ruby`);return{env:{...process.env,...t.env},yjit:t.yjit,version:t.version,gemPath:t.gemPath}}async findRbenv(){let t=Jr.workspace.getConfiguration("rubyLsp").get("rubyVersionManager.rbenvExecutablePath");return t?this.ensureRbenvExistsAt(t):this.findExec([Jr.Uri.file("/opt/homebrew/bin"),Jr.Uri.file("/usr/local/bin")],"rbenv")}async ensureRbenvExistsAt(e){try{return await Jr.workspace.fs.stat(Jr.Uri.file(e)),e}catch{throw new Error(`The Ruby LSP version manager is configured to be rbenv, but ${e} does not exist`)}}};var eb=te(require("os")),ar=te(require("vscode"));var ba=class extends vt{async activate(){let e=await this.findRvmInstallation(),t=await this.runEnvActivationScript(e.fsPath),n=Object.entries(t.env).map(([i,s])=>`${i}=${s}`).join(" ");return this.outputChannel.info(`Activated Ruby environment: ${n}`),{env:{...process.env,...t.env},yjit:t.yjit,version:t.version,gemPath:t.gemPath}}async findRvmInstallation(){let e=[ar.Uri.joinPath(ar.Uri.file(eb.default.homedir()),".rvm","bin","rvm-auto-ruby"),ar.Uri.joinPath(ar.Uri.file("/"),"usr","local","rvm","bin","rvm-auto-ruby"),ar.Uri.joinPath(ar.Uri.file("/"),"usr","share","rvm","bin","rvm-auto-ruby")];for(let t of e)try{return await ar.workspace.fs.stat(t),t}catch{}throw new Error(`Cannot find RVM installation directory. Searched in ${e.map(t=>t.fsPath).join(",")}`)}};var qi=class extends vt{constructor(e,t,n,i){super(e,t,n),this.rubyPath=i??"ruby"}async activate(){let e=await this.runEnvActivationScript(this.rubyPath);return{env:{...process.env,...e.env},yjit:e.yjit,version:e.version,gemPath:e.gemPath}}};var tb=te(require("vscode"));var wa=class extends vt{async activate(){let e=await this.runEnvActivationScript(`${this.customCommand()} && ruby`);return{env:{...process.env,...e.env},yjit:e.yjit,version:e.version,gemPath:e.gemPath}}customCommand(){let t=tb.workspace.getConfiguration("rubyLsp").get("customRubyCommand");if(t===void 0)throw new Error("The customRubyCommand configuration must be set when 'custom' is selected as the version manager.         See the [README](https://shopify.github.io/ruby-lsp/version-managers.html) for instructions.");return t}};var nb=te(require("os")),rb=te(require("path")),qt=te(require("vscode"));var Ca=class extends vt{async activate(){let e=await this.findAsdfInstallation(),t=await this.runEnvActivationScript(`. ${e.fsPath} && asdf exec ruby`);return{env:{...process.env,...t.env},yjit:t.yjit,version:t.version,gemPath:t.gemPath}}async findAsdfInstallation(){let e=rb.default.basename(qt.env.shell)==="fish"?"asdf.fish":"asdf.sh",n=qt.workspace.getConfiguration("rubyLsp").get("rubyVersionManager.asdfExecutablePath");if(n){let s=qt.Uri.file(n);try{return await qt.workspace.fs.stat(s),s}catch{throw new Error(`ASDF executable configured as ${s}, but that file doesn't exist`)}}let i=[qt.Uri.joinPath(qt.Uri.file(nb.default.homedir()),".asdf",e),qt.Uri.joinPath(qt.Uri.file("/"),"opt","asdf-vm",e),qt.Uri.joinPath(qt.Uri.file("/"),"opt","homebrew","opt","asdf","libexec",e),qt.Uri.joinPath(qt.Uri.file("/"),"usr","local","opt","asdf","libexec",e)];for(let s of i)try{return await qt.workspace.fs.stat(s),s}catch{}throw new Error(`Could not find ASDF installation. Searched in ${i.join(", ")}`)}};var gf=(p=>(p.Asdf="asdf",p.Auto="auto",p.Chruby="chruby",p.Rbenv="rbenv",p.Rvm="rvm",p.Shadowenv="shadowenv",p.Mise="mise",p.RubyInstaller="rubyInstaller",p.None="none",p.Custom="custom",p))(gf||{}),Sa=class{constructor(e,t,n,i){this.gemPath=[];this.#e=rt.workspace.getConfiguration("rubyLsp").get("rubyVersionManager");this.shell=process.env.SHELL?.replace(/(\s+)/g,"\\$1");this._env={};this._error=!1;this.context=e,this.workspaceFolder=t,this.outputChannel=n,this.telemetry=i;let s=rt.workspace.getConfiguration("rubyLsp").get("bundleGemfile");s.length>0&&(this.customBundleGemfile=Ra.default.isAbsolute(s)?s:Ra.default.resolve(Ra.default.join(this.workspaceFolder.uri.fsPath,s)))}#e;get versionManager(){return this.#e}set versionManager(e){typeof e=="string"?this.#e.identifier=e:this.#e=e}get env(){return this._env}get error(){return this._error}async activateRuby(e=rt.workspace.getConfiguration("rubyLsp").get("rubyVersionManager")){this.versionManager=e,this._error=!1;let t=this.context.workspaceState.get(`rubyLsp.workspaceRubyPath.${this.workspaceFolder.name}`);if(t)await this.runActivation(new qi(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this),t));else{this.versionManager.identifier==="auto"&&(await this.discoverVersionManager(),this.outputChannel.info(`Discovered version manager ${this.versionManager.identifier}`));try{await this.runManagerActivation()}catch(n){this.telemetry.logError(n,{versionManager:this.versionManager.identifier});let i=rt.workspace.getConfiguration("rubyLsp").get("rubyExecutablePath");if(i)await this.runActivation(new qi(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this),i));else{if(this._error=!0,this.context.extensionMode===rt.ExtensionMode.Test)throw n;await this.handleRubyError(n.message)}}}this.error||(this.fetchRubyVersionInfo(),await this.setupBundlePath())}async manuallySelectRuby(){let e=await rt.window.showInformationMessage("Configure global or workspace specific fallback for the Ruby LSP?","global","workspace","clear previous workspace selection");if(!e)return;if(e==="clear previous workspace selection")return await this.context.workspaceState.update(`rubyLsp.workspaceRubyPath.${this.workspaceFolder.name}`,void 0),this.activateRuby();let t=await rt.window.showOpenDialog({title:`Select Ruby binary path for ${e} configuration`,openLabel:"Select Ruby binary",canSelectMany:!1});if(!t)return;let n=t[0].fsPath;return e==="global"?await rt.workspace.getConfiguration("rubyLsp").update("rubyExecutablePath",n,!0):await this.context.workspaceState.update(`rubyLsp.workspaceRubyPath.${this.workspaceFolder.name}`,n),this.activateRuby()}mergeComposedEnvironment(e){this._env={...this._env,...e}}async runActivation(e){let{env:t,version:n,yjit:i,gemPath:s}=await e.activate(),[o,a,u]=n.split(".").map(Number);this.sanitizeEnvironment(t),process.env=t,this._env=t,this.rubyVersion=n,this.yjitEnabled=i&&o>3||o===3&&a>=2,this.gemPath.push(...s)}fetchRubyVersionInfo(){let[e,t,n]=this.rubyVersion.split(".").map(Number);if(e<3)throw new Error(`The Ruby LSP requires Ruby 3.0 or newer to run. This project is using ${this.rubyVersion}.         [See alternatives](https://github.com/Shopify/ruby-lsp/blob/main/vscode/README.md#ruby-version-requirement)`);this.yjitEnabled&&e===3&&t===2&&(this._env.RUBYOPT?this._env.RUBYOPT.concat(" --yjit"):this._env.RUBYOPT="--yjit")}sanitizeEnvironment(e){Object.keys(e).forEach(t=>{t.startsWith("RUBY_GC")&&delete e[t]}),delete e.VERBOSE,delete e.DEBUG}async runManagerActivation(){switch(this.versionManager.identifier){case"asdf":await this.runActivation(new Ca(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"chruby":await this.runActivation(new Ii(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"rbenv":await this.runActivation(new ya(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"rvm":await this.runActivation(new ba(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"mise":await this.runActivation(new ga(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"rubyInstaller":await this.runActivation(new va(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"custom":await this.runActivation(new wa(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;case"none":await this.runActivation(new qi(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break;default:await this.runActivation(new pa(this.workspaceFolder,this.outputChannel,this.manuallySelectRuby.bind(this)));break}}async setupBundlePath(){if(this.customBundleGemfile)try{await rt.workspace.fs.stat(rt.Uri.file(this.customBundleGemfile)),this._env.BUNDLE_GEMFILE=this.customBundleGemfile}catch{throw new Error(`The configured bundle gemfile ${this.customBundleGemfile} does not exist`)}}async discoverVersionManager(){try{await rt.workspace.fs.stat(rt.Uri.joinPath(this.workspaceFolder.uri,".shadowenv.d")),this.versionManager.identifier="shadowenv";return}catch{}let e=["chruby","rbenv","rvm","asdf"];for(let t of e)if(await this.toolExists(t)){this.versionManager=t;return}try{await rt.workspace.fs.stat(rt.Uri.joinPath(rt.Uri.file(pf.default.homedir()),".local","bin","mise")),this.versionManager="mise";return}catch{}if(pf.default.platform()==="win32"){this.versionManager="rubyInstaller";return}this.versionManager="none"}async toolExists(e){try{let t=this.shell?`${this.shell} -i -c '`:"";return t+=`${e} --version`,this.shell&&(t+="'"),this.outputChannel.info(`Checking if ${e} is available on the path with command: ${t}`),await It(t,{cwd:this.workspaceFolder.uri.fsPath,timeout:1e3}),!0}catch{return!1}}async handleRubyError(e){let t=await rt.window.showErrorMessage(`Automatic Ruby environment activation with ${this.versionManager.identifier} failed: ${e}`,"Retry","Select Ruby manually");if(t)return t==="Retry"&&await rt.commands.executeCommand("workbench.action.reloadWindow"),this.manuallySelectRuby()}};var mf=te(require("path")),ib=te(require("os")),Da=require("perf_hooks"),he=te(require("vscode")),cn=te(fa());function FD(){let r=Object.keys(lf);return Object.fromEntries(r.map(e=>[e,ff(e)]))}function OD(r,e){let t,n,i=he.workspace.getConfiguration("rubyLsp"),s=i.get("branch"),o=i.get("bundleGemfile"),a=i.get("useBundlerCompose"),u=i.get("bypassTypechecker"),d={cwd:r.uri.fsPath,env:u?{...e,RUBY_LSP_BYPASS_TYPECHECKER:"true"}:e,shell:!0};if(o.length>0)t={command:"bundle",args:["exec","ruby-lsp"],options:d},n={command:"bundle",args:["exec","ruby-lsp","--debug"],options:d};else if(a)t={command:"bundle",args:["compose","gem","ruby-lsp"],options:d},n={command:"bundle",args:["compose","gem","ruby-lsp","--","--debug"],options:d};else{let p=[];s.length>0&&p.push("--branch",s),ff("launcher")&&p.push("--use-launcher"),t={command:"ruby-lsp",args:p,options:d},n={command:"ruby-lsp",args:p.concat(["--debug"]),options:d}}return{run:t,debug:n}}function LD(r,e,t,n,i,s){let o=r.get("pullDiagnosticsOn"),a={onChange:o==="change"||o==="both",onSave:o==="save"||o==="both"},u=r.get("enabledFeatures"),d=Object.keys(u).filter(S=>u[S]),p=["file","git"],m=e.uri.fsPath.replace(/\/$/,""),g=xr.flatMap(S=>p.map(y=>({scheme:y,language:S,pattern:`${m}/**/*`})));return i&&xr.forEach(S=>{g.push({language:S,scheme:"untitled"})}),n.gemPath.forEach(S=>{p.forEach(y=>{g.push({scheme:y,language:"ruby",pattern:`${S}/**/*`}),/lib\/ruby\/gems\/(?=\d)/.test(S)&&g.push({scheme:y,language:"ruby",pattern:`${S.replace(/lib\/ruby\/gems\/(?=\d)/,"lib/ruby/")}/**/*`})})}),r.get("erbSupport")||(g=g.filter(S=>S.language!=="erb")),{documentSelector:g,workspaceFolder:e,diagnosticCollectionName:ha,outputChannel:t,revealOutputChannelOn:cn.RevealOutputChannelOn.Never,diagnosticPullOptions:a,errorHandler:new vf(e,s),initializationOptions:{enabledFeatures:d,featuresConfiguration:r.get("featuresConfiguration"),formatter:r.get("formatter"),linters:r.get("linters"),indexing:r.get("indexing"),addonSettings:r.get("addonSettings"),enabledFeatureFlags:FD()}}}var vf=class{constructor(e,t){this.workspaceFolder=e,this.telemetry=t}error(e,t,n){return{action:cn.ErrorAction.Shutdown,handled:!0}}async closed(){let e=he.workspace.getConfiguration("rubyLsp").get("useLauncher")?"launcher":"direct";return this.telemetry.logUsage("ruby_lsp.launch_failure",{type:"counter",attributes:{label:e}}),await he.window.showErrorMessage(`Launching the Ruby LSP failed. This typically happens due to an error with version manager
      integration or Bundler issues.

      [Logs](command:workbench.action.output.toggleOutput) |
      [Troubleshooting](https://shopify.github.io/ruby-lsp/troubleshooting.html) |
      [Run bundle install](command:rubyLsp.bundleInstall?"${this.workspaceFolder.uri.toString()}")`,"Retry","Shutdown")==="Retry"?{action:cn.CloseAction.Restart,handled:!0}:{action:cn.CloseAction.DoNotRestart,handled:!0}}},yf=class{fillClientCapabilities(e){e.experimental={requestDelegation:!0}}initialize(e,t){}getState(){return{kind:"static"}}clear(){}},bs=class extends cn.LanguageClient{constructor(t,n,i,s,o,a,u,d=!1,p){super(ha,OD(o,i.env),LD(he.workspace.getConfiguration("rubyLsp"),o,a,i,d,n),p);this.degraded=!1;this.virtualDocuments=new Map;this.registerFeature(new yf),this.workspaceOutputChannel=a,this.virtualDocuments=u,this.registerMiddleware(),this.workingDirectory=o.uri.fsPath,this.baseFolder=mf.default.basename(this.workingDirectory),this.telemetry=n,this.createTestItems=s,this.#e=t,this.ruby=i,this.#t="",this.onNotification("delegate/textDocument/virtualState",m=>{this.virtualDocuments.set(m.textDocument.uri,m.textDocument.text)}),this.onTelemetry(m=>{m.type==="error"&&this.telemetry.logError({message:m.errorMessage,name:m.errorClass,stack:m.stack},{serverVersion:this.serverVersion})})}#e;#t;async afterStart(){this.#t=this.initializeResult?.formatter,this.serverVersion=this.initializeResult?.serverInfo?.version,this.initializeResult?.degraded_mode&&(this.degraded=this.initializeResult?.degraded_mode),this.initializeResult?.bundle_env&&this.ruby.mergeComposedEnvironment(this.initializeResult.bundle_env),await this.fetchAddons()}async fetchAddons(){if(this.initializeResult?.capabilities.experimental?.addon_detection)try{this.addons=await this.sendRequest("rubyLsp/workspace/addons",{})}catch(t){this.workspaceOutputChannel.error(`Error while fetching addons: ${t.data.errorMessage}`)}}get formatter(){return this.#t}get context(){return this.#e}set context(t){this.#e=t}async sendShowSyntaxTreeRequest(t,n){return this.sendRequest("rubyLsp/textDocument/showSyntaxTree",{textDocument:{uri:t.toString()},range:n})}async benchmarkMiddleware(t,n,i){if(this.state!==cn.State.Running)return i();let s=typeof t=="string"?t:t.method;try{Da.performance.mark(`${s}.start`);let o=await i();Da.performance.mark(`${s}.end`);let a=Da.performance.measure("benchmarks",`${s}.start`,`${s}.end`);return this.logResponseTime(a.duration,s),o}catch(o){if(o.code===-32900)return this.executeDelegateRequest(t,n);if(o.data)if(this.baseFolder==="ruby-lsp"||this.baseFolder==="ruby-lsp-rails")await he.window.showErrorMessage(`Ruby LSP error ${o.data.errorClass}: ${o.data.errorMessage}

${o.data.backtrace}`);else{let{errorMessage:a,errorClass:u,backtrace:d}=o.data;if(a&&u&&d&&o.code===cn.ErrorCodes.InternalError){let p=new he.TelemetryTrustedValue(d.split(`
`).map(m=>m.replace(ib.default.homedir(),"~")).join(`
`));this.telemetry.logError({message:a,name:u,stack:p},{...o.data,serverVersion:this.serverVersion,workspace:new he.TelemetryTrustedValue(mf.default.basename(this.workingDirectory))})}}throw o}}async executeDelegateRequest(t,n){let i=typeof t=="string"?t:t.method,s=n.textDocument.uri;if(!s)return null;let o=this.virtualDocumentUri(s);switch(i){case"textDocument/completion":return he.commands.executeCommand("vscode.executeCompletionItemProvider",he.Uri.parse(o),n.position,n.context.triggerCharacter).then(a=>(a.items.forEach(u=>{u.documentation&&typeof u.documentation!="string"&&"value"in u.documentation&&(u.documentation.kind="markdown"),u.data={...u.data,delegateCompletion:!0}}),a));case"textDocument/hover":return he.commands.executeCommand("vscode.executeHoverProvider",he.Uri.parse(o),n.position);case"textDocument/definition":return he.commands.executeCommand("vscode.executeDefinitionProvider",he.Uri.parse(o),n.position);case"textDocument/signatureHelp":return he.commands.executeCommand("vscode.executeSignatureHelpProvider",he.Uri.parse(o),n.position,n.context?.triggerCharacter);case"textDocument/documentHighlight":return he.commands.executeCommand("vscode.executeDocumentHighlights",he.Uri.parse(o),n.position);default:return this.workspaceOutputChannel.warn(`Attempted to delegate unsupported request ${i}`),null}}registerMiddleware(){this.clientOptions.middleware={provideCodeLenses:async(t,n,i)=>{let s=await i(t,n);if(s){let o=s.filter(a=>a.data.type==="test");o.length&&this.createTestItems(o)}return s},provideOnTypeFormattingEdits:async(t,n,i,s,o,a)=>{let u=await this.sendRequest("textDocument/onTypeFormatting",{textDocument:{uri:t.uri.toString()},position:n,ch:i,options:s},o);if(!u)return null;let d=u.find(E=>E.newText==="$0");if(!d)return u;u.splice(u.indexOf(d),1);let p=new he.WorkspaceEdit;p.set(t.uri,u);let g=he.window.activeTextEditor.document.lineAt(d.range.start.line).text;await he.workspace.applyEdit(p);let S=he.window.activeTextEditor?.options.insertSpaces?" ":"	",y=0;/^\s*$/.exec(g)&&(y=d.range.end.character);let P=S.repeat(y);return await he.window.activeTextEditor.insertSnippet(new he.SnippetString(`${P}${d.newText}`),new he.Selection(d.range.start,d.range.end)),null},sendRequest:async(t,n,i,s)=>this.benchmarkMiddleware(t,n,()=>s(t,n,i)),sendNotification:async(t,n,i)=>this.benchmarkMiddleware(t,i,()=>n(t,i)),didClose:(t,n)=>(this.virtualDocuments.delete(t.uri.toString(!0)),n(t)),provideFoldingRanges:async(t,n,i,s)=>{if(t.languageId==="erb"){let o=this.virtualDocumentUri(t.uri.toString(!0)),a=await he.commands.executeCommand("vscode.executeFoldingRangeProvider",he.Uri.parse(o)),u=await s(t,n,i);return a.concat(u??[])}return s(t,n,i)},provideDocumentLinks:async(t,n,i)=>{if(t.languageId==="erb"){let s=this.virtualDocumentUri(t.uri.toString(!0)),o=await he.commands.executeCommand("vscode.executeLinkProvider",he.Uri.parse(s)),a=await i(t,n);return o.concat(a??[])}return i(t,n)}}}virtualDocumentUri(t){let n=/\.([^.]+)\.erb$/.exec(t)?.[1]||"html";return`embedded-content://${n}/${encodeURIComponent(t)}.${n}`}logResponseTime(t,n){this.telemetry.logUsage("ruby_lsp.response_time",{type:"histogram",value:t,attributes:{message:new he.TelemetryTrustedValue(n),lspVersion:this.serverVersion,rubyVersion:this.ruby.rubyVersion}})}};var _a=class{constructor(e,t){this.prefix=`(${e})`,this.actualChannel=t,this.onDidChangeLogLevel=this.actualChannel.onDidChangeLogLevel}get name(){return this.actualChannel.name}get logLevel(){return this.actualChannel.logLevel}trace(e,...t){this.actualChannel.trace(`${this.prefix} ${e}`,...t)}debug(e,...t){this.actualChannel.debug(`${this.prefix} ${e}`,...t)}info(e,...t){this.actualChannel.info(`${this.prefix} ${e}`,...t)}warn(e,...t){this.actualChannel.warn(`${this.prefix} ${e}`,...t)}error(e,...t){this.actualChannel.error(`${this.prefix} ${e}`,...t)}append(e){this.actualChannel.append(`${this.prefix} ${e}`)}appendLine(e){this.actualChannel.appendLine(`${this.prefix} ${e}`)}replace(e){this.actualChannel.replace(`${this.prefix} ${e}`)}clear(){this.actualChannel.clear()}show(e,t){this.actualChannel.show(t)}hide(){this.actualChannel.hide()}dispose(){this.actualChannel.dispose()}};var sb=["Gemfile.lock","gems.locked",".rubocop.yml",".rubocop"],Pa=class{constructor(e,t,n,i,s,o=!1){this.virtualDocuments=new Map;this.restartDocumentShas=new Map;this.needsRestart=!1;this.#e=!1;this.#t=!1;this.debouncedRestart=Qy(async e=>{this.outputChannel.info(`Restarting the Ruby LSP because ${e}`),await this.restart()},5e3);this.context=e,this.workspaceFolder=t,this.outputChannel=new _a(t.name,sr),this.telemetry=n,this.ruby=new Sa(e,t,this.outputChannel,n),this.createTestItems=i,this.isMainWorkspace=o,this.virtualDocuments=s}#e;#t;async activate(){let e=Qe.extensions.getExtension("vscode.git"),t=this.workspaceFolder.uri;if(e){let i=await e.exports.getAPI(1).openRepository(this.workspaceFolder.uri);i&&(t=i.rootUri)}this.registerCreateDeleteWatcher(t,".git/{rebase-merge,rebase-apply,BISECT_START,CHERRY_PICK_HEAD}"),this.registerRestarts();for(let n of sb){let i=Qe.Uri.joinPath(this.workspaceFolder.uri,n),s=await this.fileContentsSha(i);s&&this.restartDocumentShas.set(i.fsPath,s)}}async start(e){if(await this.ruby.activateRuby(),this.ruby.error){this.error=!0;return}try{if((await Qe.workspace.fs.stat(this.workspaceFolder.uri)).permissions)throw new Error(`Directory ${this.workspaceFolder.uri.fsPath} is readonly.`)}catch{this.error=!0,await Qe.window.showErrorMessage(`Directory ${this.workspaceFolder.uri.fsPath} is not writable. The Ruby LSP server needs to be able to create a
        .ruby-lsp directory to function appropriately. Consider switching to a directory for which VS Code has write
        permissions`);return}try{await this.installOrUpdateServer(!1)}catch(t){this.error=!0,await Qe.window.showErrorMessage(`Failed to setup the bundle: ${t.message}.         See [Troubleshooting](https://shopify.github.io/ruby-lsp/troubleshooting.html) for help`);return}this.lspClient&&(await this.lspClient.stop(),await this.lspClient.dispose()),this.lspClient=new bs(this.context,this.telemetry,this.ruby,this.createTestItems,this.workspaceFolder,this.outputChannel,this.virtualDocuments,this.isMainWorkspace,e);try{wn.fire(this),await Qe.window.withProgress({location:Qe.ProgressLocation.Window,title:"Initializing Ruby LSP"},async()=>{await this.lspClient.start(),await this.lspClient.afterStart()}),wn.fire(this),this.needsRestart&&(this.needsRestart=!1,await this.debouncedRestart("a restart was requested while the server was still booting"))}catch(t){this.error=!0,this.outputChannel.error(`Error starting the server: ${t.message}`)}}async stop(){await this.lspClient?.stop()}async restart(){try{if(this.#e)return;if(this.error=!1,!this.lspClient)return this.start();switch(this.lspClient.state){case Ta.State.Starting:this.needsRestart=!0;break;case Ta.State.Running:await this.stop(),await this.lspClient.dispose(),this.lspClient=void 0,await this.start();break;case Ta.State.Stopped:await this.lspClient.dispose(),this.lspClient=void 0,await this.start();break}}catch(e){this.error=!0,this.outputChannel.error(`Error restarting the server: ${e.message}`)}}async dispose(){await this.lspClient?.dispose()}async installOrUpdateServer(e){if(Qe.workspace.getConfiguration("rubyLsp").get("bundleGemfile").length>0)return;let n=24*60*60*1e3,i=this.context.workspaceState.get("rubyLsp.lastGemUpdate"),s=["ruby-lsp","language_server-protocol","prism","rbs","sorbet-runtime"],{stdout:o}=await It(`gem list ${s.join(" ")}`,{cwd:this.workspaceFolder.uri.fsPath,env:this.ruby.env});if(!s.every(a=>new RegExp(`${a}\\s`).exec(o))){await It("gem install ruby-lsp",{cwd:this.workspaceFolder.uri.fsPath,env:this.ruby.env}),await this.context.workspaceState.update("rubyLsp.lastGemUpdate",Date.now());return}if(e)try{await Qe.workspace.fs.delete(Qe.Uri.joinPath(this.workspaceFolder.uri,".ruby-lsp"),{recursive:!0})}catch{this.outputChannel.info(`Tried deleting ${Qe.Uri.joinPath(this.workspaceFolder.uri,".ruby-lsp")}, but it doesn't exist`)}if(e||i===void 0||Date.now()-i>n)try{await It("gem update ruby-lsp",{cwd:this.workspaceFolder.uri.fsPath,env:this.ruby.env}),await this.context.workspaceState.update("rubyLsp.lastGemUpdate",Date.now())}catch(a){this.outputChannel.error(`Failed to update global ruby-lsp gem: ${a}`)}}get error(){return this.#t}set error(e){wn.fire(this),this.#t=e}get inhibitRestart(){return this.#e}async execute(e,t=!1){t&&(this.outputChannel.show(),this.outputChannel.info(`Running "${e}"`));let n=await It(e,{env:this.ruby.env,cwd:this.workspaceFolder.uri.fsPath});return t&&(n.stderr.length>0?this.outputChannel.error(n.stderr):this.outputChannel.info(n.stdout)),n}registerRestarts(){this.createRestartWatcher(`{${sb.join(",")}}`),this.context.subscriptions.push(Qe.workspace.onDidChangeConfiguration(async e=>{e.affectsConfiguration("rubyLsp")&&await this.debouncedRestart("configuration changed")}))}createRestartWatcher(e){let t=Qe.workspace.createFileSystemWatcher(new Qe.RelativePattern(this.workspaceFolder,e)),n=async s=>{let o=s.fsPath,a=await this.fileContentsSha(s);a&&this.restartDocumentShas.get(o)!==a&&(this.restartDocumentShas.set(o,a),await this.debouncedRestart(`${o} changed, matching ${e}`))},i=async s=>{this.restartDocumentShas.delete(s.fsPath),await this.debouncedRestart(`${s.fsPath} changed, matching ${e}`)};this.context.subscriptions.push(t,t.onDidChange(n),t.onDidCreate(n),t.onDidDelete(i))}registerCreateDeleteWatcher(e,t){let n=Qe.workspace.createFileSystemWatcher(new Qe.RelativePattern(e,t)),i=()=>{this.#e=!0},s=async o=>{this.#e=!1,await this.debouncedRestart(`${o.fsPath} changed, matching ${t}`)};this.context.subscriptions.push(n,n.onDidCreate(i),n.onDidDelete(s))}async fileContentsSha(e){let t;try{t=await Qe.workspace.fs.readFile(e)}catch{return}let n=(0,ob.createHash)("sha256");return n.update(t.toString()),n.digest("hex")}};var Jt=te(require("vscode")),ka=te(la());var ab=[{label:"Ruby LSP: Start",description:"rubyLsp.start"},{label:"Ruby LSP: Restart",description:"rubyLsp.restart"}],bf=[{label:"Ruby LSP: Stop",description:"rubyLsp.stop"},{label:"Ruby LSP: Restart",description:"rubyLsp.restart"}],Qr=class{constructor(e){let t=xr.map(n=>({language:n}));this.item=Jt.languages.createLanguageStatusItem(e,t)}dispose(){this.item.dispose()}},wf=class extends Qr{constructor(){super("rubyVersion"),this.item.name="Ruby Version",this.item.command={title:"Configure",command:"rubyLsp.selectRubyVersionManager"},this.item.text="Activating Ruby environment",this.item.severity=Jt.LanguageStatusSeverity.Information}refresh(e){e.ruby.error?(this.item.text="Failed to activate Ruby",this.item.severity=Jt.LanguageStatusSeverity.Error):(this.item.text=`Using Ruby ${e.ruby.rubyVersion} with ${e.ruby.versionManager.identifier}`,this.item.severity=Jt.LanguageStatusSeverity.Information)}},Cf=class extends Qr{constructor(){super("server"),this.item.name="Ruby LSP Server Status",this.item.text="Ruby LSP: Starting",this.item.severity=Jt.LanguageStatusSeverity.Information,this.item.command={title:"Configure",command:"rubyLsp.serverOptions",arguments:[bf]}}refresh(e){if(e.error){this.item.text="Ruby LSP: Error",this.item.command.arguments=[ab],this.item.severity=Jt.LanguageStatusSeverity.Error;return}if(e.lspClient)switch(e.lspClient.state){case ka.State.Running:{this.item.text=e.lspClient.serverVersion?`Ruby LSP v${e.lspClient.serverVersion}: Running`:"Ruby LSP: Running",e.lspClient.degraded?(this.item.text+=" (degraded)",this.item.severity=Jt.LanguageStatusSeverity.Warning):this.item.severity=Jt.LanguageStatusSeverity.Information,this.item.command.arguments=[bf];break}case ka.State.Starting:{this.item.text="Ruby LSP: Starting",this.item.command.arguments=[bf],this.item.severity=Jt.LanguageStatusSeverity.Information;break}case ka.State.Stopped:{this.item.text="Ruby LSP: Stopped",this.item.command.arguments=[ab],this.item.severity=Jt.LanguageStatusSeverity.Information;break}}}},Rf=class extends Qr{constructor(){super("features"),this.item.name="Ruby LSP Features",this.item.command={title:"Manage",command:"rubyLsp.toggleFeatures"},this.item.text="Fetching feature information"}refresh(e){let n=Jt.workspace.getConfiguration("rubyLsp").get("enabledFeatures"),i=Object.keys(n).filter(s=>n[s]);this.item.text=`${i.length}/${Object.keys(n).length} features enabled`}},Sf=class extends Qr{constructor(){super("formatter"),this.item.name="Ruby LSP Formatter",this.item.command={title:"Help",command:"rubyLsp.formatterHelp"},this.item.text="Fetching formatter information"}refresh(e){e.lspClient&&(e.lspClient.formatter?this.item.text=`Formatter: ${e.lspClient.formatter}`:this.item.text="Formatter: requires server to be v0.12.4 or higher to display this field")}},Df=class extends Qr{constructor(){super("addons"),this.item.name="Ruby LSP Addons",this.item.text="Fetching addon information"}refresh(e){e.lspClient&&(e.lspClient.addons===void 0?this.item.text="Addons: requires server to be v0.17.4 or higher to display this field":e.lspClient.addons.length===0?this.item.text="Addons: none":(this.item.text=`Addons: ${e.lspClient.addons.length}`,this.item.command={title:"Details",command:"rubyLsp.displayAddons"}))}},Ea=class{constructor(){this.items=[];this.items=[new wf,new Cf,new Rf,new Sf,new Df],wn.event(e=>{e&&this.items.forEach(t=>t.refresh(e))})}dispose(){this.items.forEach(e=>e.dispose())}};var ub=require("child_process"),db=require("util"),ue=te(require("vscode")),MD=(0,db.promisify)(ub.exec),xa=class{constructor(e,t,n){this.debugTag=new ue.TestTag("debug");this.testTimeout=ue.workspace.getConfiguration("rubyLsp").get("testTimeout");this.telemetry=t,this.currentWorkspace=n,this.testController=ue.tests.createTestController("rubyTests","Ruby Tests"),this.testCommands=new WeakMap,this.testRunProfile=this.testController.createRunProfile("Run",ue.TestRunProfileKind.Run,async(i,s)=>{await this.runHandler(i,s)},!0),this.testDebugProfile=this.testController.createRunProfile("Debug",ue.TestRunProfileKind.Debug,async(i,s)=>{await this.debugHandler(i,s)},!1,this.debugTag),e.subscriptions.push(this.testController,this.testDebugProfile,this.testRunProfile,ue.window.onDidCloseTerminal(i=>{i===this.terminal&&(this.terminal=void 0)}))}createTestItems(e){this.testController.items.forEach(i=>{this.testController.items.delete(i.id),this.testCommands.delete(i)});let t=new Map,n=ue.Uri.from({scheme:"file",path:e[0].command.arguments[0]});e.forEach(i=>{let[s,o,a,u,d]=i.command.arguments,p=this.testController.createTestItem(o,d||o,n),m=i.data;if(p.tags=[new ue.TestTag(m.kind)],this.testCommands.set(p,a),p.range=new ue.Range(new ue.Position(u.start_line,u.start_column),new ue.Position(u.end_line,u.end_column)),m.id?(t.set(m.id,p),p.canResolveChildren=!0):p.tags=[...p.tags,this.debugTag],m.group_id){let g=t.get(m.group_id);g?g.children.add(p):this.currentWorkspace()?.outputChannel.error(`Test example "${o}" is attached to group_id ${m.group_id}, but that group does not exist`)}else this.testController.items.add(p)})}runTestInTerminal(e,t,n){n??=this.testCommands.get(this.findTestByActiveLine())||"",this.terminal===void 0&&(this.terminal=this.getTerminal()),this.terminal.show(),this.terminal.sendText(n),this.telemetry.logUsage("ruby_lsp.code_lens",{type:"counter",attributes:{label:"test_in_terminal",vscodemachineid:ue.env.machineId}})}async runOnClick(e){let t=this.findTestById(e);if(!t)return;await ue.commands.executeCommand("vscode.revealTestInExplorer",t);let n=new ue.CancellationTokenSource;n.token.onCancellationRequested(async()=>{n?.dispose(),n=null,await ue.window.showInformationMessage("Cancelled the progress")});let i=new ue.TestRunRequest([t],[],this.testRunProfile);return this.testRunProfile.runHandler(i,n.token)}debugTest(e,t,n){n??=this.testCommands.get(this.findTestByActiveLine())||"";let i=this.currentWorkspace();if(!i)throw new Error("No workspace found. Debugging requires a workspace to be opened");return ue.debug.startDebugging(i.workspaceFolder,{type:"ruby_lsp",name:"Debug",request:"launch",program:n,env:{...i.ruby.env,DISABLE_SPRING:"1"}})}getTerminal(){let e=this.currentWorkspace(),t=e?`${e.workspaceFolder.name}: test`:"Ruby LSP: test",n=ue.window.terminals.find(i=>i.name===t);return n||ue.window.createTerminal({name:t})}async debugHandler(e,t){let n=this.testController.createTestRun(e,void 0,!0),i=e.include[0],s=Date.now();await this.debugTest("","",this.testCommands.get(i)),n.passed(i,Date.now()-s),n.end(),this.telemetry.logUsage("ruby_lsp.code_lens",{type:"counter",attributes:{label:"debug",vscodemachineid:ue.env.machineId}})}async runHandler(e,t){let n=this.testController.createTestRun(e,void 0,!0),i=[],s=a=>{i.push(a),n.enqueued(a)};e.include?e.include.forEach(s):this.testController.items.forEach(s);let o=this.currentWorkspace();for(;i.length>0&&!t.isCancellationRequested;){let a=i.pop();if(e.exclude?.includes(a)){n.skipped(a);continue}if(n.started(a),a.tags.find(u=>u.id==="example")){let u=Date.now();try{if(!o){n.errored(a,new ue.TestMessage("No workspace found"));continue}let d=await this.assertTestPasses(a,o.workspaceFolder.uri.fsPath,o.ruby.env);n.appendOutput(d.replace(/\r?\n/g,`\r
`),void 0,a),n.passed(a,Date.now()-u)}catch(d){let p=Date.now()-u;if(d.killed){n.errored(a,new ue.TestMessage(`Test timed out after ${this.testTimeout} seconds`),p);continue}let m=d.message.split(`
`),g=m[0]===""?m.slice(10,m.length-2).join(`
`):m.slice(4,m.length-9).join(`
`),S=[new ue.TestMessage(d.message),new ue.TestMessage(g)];m.find(y=>y==="F")?n.failed(a,S,p):n.errored(a,S,p)}}a.children.forEach(s)}n.end(),this.telemetry.logUsage("ruby_lsp.code_lens",{type:"counter",attributes:{label:"test",vscodemachineid:ue.env.machineId}})}async assertTestPasses(e,t,n){try{return(await MD(this.testCommands.get(e),{cwd:t,env:n,timeout:this.testTimeout*1e3})).stdout}catch(i){throw i.killed?i:new Error(i.stdout)}}findTestById(e,t=this.testController.items){if(!e)return this.findTestByActiveLine();let n=t.get(e);return n||(t.forEach(i=>{let s=this.findTestById(e,i.children);s&&(n=s)}),n)}findTestByActiveLine(e=ue.window.activeTextEditor,t=this.testController.items){if(!e)return;let n=e.selection.active.line,i;return t.forEach(s=>{if(!i&&(s.uri?.toString()===e.document.uri.toString()&&s.range?.start.line<=n&&s.range?.end.line>=n&&(i=s),s.children.size>0)){let o=this.findTestByActiveLine(e,s.children);o&&(i=o)}}),i}};var lb=te(require("path")),$e=te(require("vscode"));async function fb(r,e,t){let{file:n,...i}=t,{line:s,character:o=0,endLine:a=s,endCharacter:u=o}=i,d=new $e.Range(s,o,a,u),p=$e.Uri.parse(`file://${n}`),m=await $e.workspace.openTextDocument(p);await $e.window.showTextDocument(m,{selection:d}),e?.lspClient?.serverVersion&&r.logUsage("ruby_lsp.code_lens",{type:"counter",attributes:{label:"open_file",vscodemachineid:$e.env.machineId}})}async function hb(r){if(r.length===1){await $e.commands.executeCommand("vscode.open",$e.Uri.parse(r[0]));return}let e=r.map(n=>{let i=$e.Uri.parse(n);return{label:lb.default.basename(i.fsPath),iconPath:new $e.ThemeIcon("go-to-file"),uri:i}}),t=await $e.window.showQuickPick(e,{title:"Select a file to jump to"});t&&await $e.commands.executeCommand("vscode.open",t.uri)}async function pb(){let r=await $e.workspace.openTextDocument({language:"ruby"}),e=await $e.window.showTextDocument(r,{preview:!1}),t=new $e.Position(0,0);await e.insertSnippet(new $e.SnippetString(`require "test_helper"

class $1Test < Minitest::Test
  def test_$2
    $3
  end
end
`),new $e.Selection(t,t))}var gb=te(require("net")),mb=te(require("os")),vb=require("child_process"),ot=te(require("vscode"));var _f=class{append(e){console.log(e)}appendLine(e){console.log(e)}},Ia=class{constructor(e,t){this.console=process.env.CI?new _f:ot.debug.activeDebugConsole;this.workspaceResolver=t,e.subscriptions.push(ot.debug.registerDebugConfigurationProvider("ruby_lsp",this),ot.debug.registerDebugAdapterDescriptorFactory("ruby_lsp",this))}async createDebugAdapterDescriptor(e,t){return e.configuration.request==="launch"?this.spawnDebuggeeForLaunch(e):e.configuration.request==="attach"?this.attachDebuggee(e):new Promise((n,i)=>i(new Error(`Unknown request type: ${e.configuration.request}. Please review your launch configurations`)))}provideDebugConfigurations(e,t){return[{type:"ruby_lsp",name:"Debug script",request:"launch",program:"ruby ${file}"},{type:"ruby_lsp",name:"Debug test",request:"launch",program:"ruby -Itest ${relativeFile}"},{type:"ruby_lsp",name:"Attach debugger",request:"attach"}]}resolveDebugConfiguration(e,t,n){let i=this.workspaceResolver(e?.uri);if(!i)throw new Error(`Couldn't find a workspace for URI: ${e?.uri} or editor: ${ot.window.activeTextEditor}`);t.env?t.env=Object.assign(t.env,i.ruby.env):t.env=i.ruby.env;let s=i.workspaceFolder.uri;if(t.targetFolder={path:s.fsPath,name:i.workspaceFolder.name},t.env.BUNDLE_GEMFILE)return t;let o=ot.Uri.joinPath(s,".ruby-lsp");return ot.workspace.fs.readDirectory(o).then(a=>(a.some(u=>u[0]==="Gemfile")?t.env.BUNDLE_GEMFILE=ot.Uri.joinPath(o,"Gemfile").fsPath:a.some(u=>u[0]==="gems.rb")&&(t.env.BUNDLE_GEMFILE=ot.Uri.joinPath(o,"gems.rb").fsPath),t),()=>t)}dispose(){this.debugProcess&&this.debugProcess.kill("SIGTERM")}async getSockets(e){let t=e.configuration,n=e.configuration.debugSocketPath;if(n)return[n];let i=[];try{i=(await It("bundle exec rdbg --util=list-socks",{cwd:e.workspaceFolder?.uri.fsPath,env:t.env})).stdout.toString().split(`
`).filter(o=>o.length>0)}catch(s){this.console.append(`Error listing sockets: ${s.message}`)}return i}async attachDebuggee(e){let t=e.configuration.debugPort;if(t){let s=e.configuration.debugHost;return s?new ot.DebugAdapterServer(t,s):new ot.DebugAdapterServer(t)}let n=await this.getSockets(e);if(n.length===0)throw new Error("No debuggee processes found. Is the process running?");if(n.length===1)return new ot.DebugAdapterNamedPipeServer(n[0]);let i=await ot.window.showQuickPick(n,{placeHolder:"Select a debuggee",ignoreFocusOut:!0}).then(s=>{if(s===void 0)throw new Error("No debuggee selected");return s});return new ot.DebugAdapterNamedPipeServer(i)}async spawnDebuggeeForLaunch(e){let t="",n=!1,i=e.configuration,o=i.targetFolder.path,a=mb.default.platform()==="win32"?await this.availablePort():void 0;return new Promise((u,d)=>{let p=["exec","rdbg"];a&&p.push("--port",a.toString()),p.push("--open","--command","--",i.program),this.logDebuggerMessage(`Spawning debugger in directory ${o}`),this.logDebuggerMessage(`   Command bundle ${p.join(" ")}`),this.logDebuggerMessage(`   Environment ${JSON.stringify(i.env)}`),this.debugProcess=(0,vb.spawn)("bundle",p,{shell:!0,env:i.env,cwd:o}),this.debugProcess.stderr.on("data",m=>{let g=m.toString();if(this.logDebuggerMessage(g),n||(t+=g),t.includes("DEBUGGER: wait for debugger connection...")){n=!0;let y=RegExp(/DEBUGGER: Debugger can attach via UNIX domain socket \((.*)\)/).exec(t);a?u(new ot.DebugAdapterServer(a)):y&&y.length===2?u(new ot.DebugAdapterNamedPipeServer(y[1])):d(new Error("Debugger not found on UNIX socket"))}}),this.debugProcess.stdout.on("data",m=>{this.logDebuggerMessage(m.toString())}),this.debugProcess.on("error",m=>{this.logDebuggerMessage(m.message),d(m)}),this.debugProcess.on("close",m=>{if(m){let g=`Debugger exited with status ${m}. Check the Ruby LSP output channel for more information.`;this.logDebuggerMessage(g),d(new Error(g))}})})}async availablePort(){return new Promise((e,t)=>{let n=gb.default.createServer();n.unref(),n.on("error",t),n.listen(0,()=>{let i=n.address(),s=typeof i=="string"?Number(i):i?.port;n.close(()=>{e(s)})})})}logDebuggerMessage(e){let t=e.trimEnd();t.length>0&&(sr.info(`[debugger]: ${t}`),this.console.append(t))}};var yb=te(require("path")),Ie=te(require("vscode")),bb=te(la());var qa=class{constructor(){this._onDidChangeTreeData=new Ie.EventEmitter;this.onDidChangeTreeData=this._onDidChangeTreeData.event;this.subscriptions=[];this.gemRootFolders={};this.treeView=Ie.window.createTreeView("dependencies",{treeDataProvider:this,showCollapseAll:!0}),this.subscriptions.push(wn.event(this.workspaceDidChange.bind(this)),Ie.window.onDidChangeActiveTextEditor(this.activeEditorDidChange.bind(this)),this.treeView.onDidChangeVisibility(this.treeVisibilityDidChange.bind(this)))}dispose(){this.subscriptions.forEach(e=>e.dispose()),this.treeView.dispose()}getTreeItem(e){return e}getChildren(e){return e?e.getChildren():this.fetchDependencies()}getParent(e){let t=Ie.Uri.joinPath(e.resourceUri,".."),n=yb.default.parse(t.path).root;if(t.path!==n)if(e instanceof ws||e instanceof Fi){let i=this.gemRootFolders[t.toString()];return i||new ws(t)}else return}async refresh(){await this.fetchDependencies(),this._onDidChangeTreeData.fire(void 0)}async workspaceDidChange(e){if(!(!e||e===this.currentWorkspace))return this.currentWorkspace=e,this.refresh()}async activeEditorDidChange(e){let t=e?.document.uri;t&&(this.currentVisibleItem=new Fi(t),this.treeView.visible&&await this.revealElement(this.currentVisibleItem))}async treeVisibilityDidChange(e){this.currentVisibleItem&&e.visible&&await this.revealElement(this.currentVisibleItem)}async revealElement(e){Ie.workspace.getConfiguration("explorer").get("autoReveal")&&await this.treeView.reveal(e,{select:!0,focus:!1,expand:!0}),this.currentVisibleItem=void 0}async fetchDependencies(){if(this.gemRootFolders={},!this.currentWorkspace)return[];let e=this.currentWorkspace.lspClient;if(!e||e.state!==bb.State.Running)return[];let n=(await e.sendRequest("rubyLsp/workspace/dependencies",{})).sort((i,s)=>i.dependency===s.dependency?i.name.localeCompare(s.name):s.dependency?1:-1).map(i=>{let s=Ie.Uri.file(i.path),o=new Tf(i.name,i.version,s);return this.gemRootFolders[s.toString()]=o,o});return n.forEach(i=>{this.gemRootFolders[i.resourceUri.toString()]=i}),n}},Tf=class extends Ie.TreeItem{constructor(t,n,i){super(`${t} (${n})`,Ie.TreeItemCollapsibleState.Collapsed);this.resourceUri=i;this.contextValue="dependency",this.iconPath=new Ie.ThemeIcon("ruby")}async getChildren(){let t=this.resourceUri;return(await Ie.workspace.fs.readDirectory(t)).map(([i,s])=>s===Ie.FileType.Directory?new ws(Ie.Uri.joinPath(t,i)):new Fi(Ie.Uri.joinPath(t,i)))}},ws=class r extends Ie.TreeItem{constructor(t){super(t,Ie.TreeItemCollapsibleState.Collapsed);this.resourceUri=t;this.contextValue="gem-directory-path",this.description=!0,this.command={command:"list.toggleExpand",title:"Toggle"}}async getChildren(){let t=this.resourceUri;return(await Ie.workspace.fs.readDirectory(t)).map(([i,s])=>s===Ie.FileType.Directory?new r(Ie.Uri.joinPath(t,i)):new Fi(Ie.Uri.joinPath(t,i)))}},Fi=class extends Ie.TreeItem{constructor(t){super(t,Ie.TreeItemCollapsibleState.None);this.resourceUri=t;this.contextValue="gem-file-path",this.description=!0,this.command={command:"vscode.open",title:"Open",arguments:[t]}}getChildren(){}};var Cb=te(require("os")),Qt=te(require("vscode")),wb=Cb.default.platform()==="win32"?"ruby bin/rails":"bin/rails",Fa=class{constructor(e){this.showWorkspacePick=e}async generate(e,t){let n=t??await this.showWorkspacePick();if(!n)return;let i=[],s=`${wb} generate ${e}`;await Qt.window.withProgress({location:Qt.ProgressLocation.Notification,title:"Running Rails generate"},async o=>{o.report({message:`Running "${s}"`});let{stdout:a}=await n.execute(s,!0);a.split(`
`).forEach(u=>{let d=/create\s*(.*\..*)/.exec(u);d&&i.push(d[1])}),o.report({message:"Revealing generated files"}),await this.revealFormattedFiles(n,i)})}async destroy(e,t){let n=t??await this.showWorkspacePick();if(!n)return;let i=[],s=`${wb} destroy ${e}`;await Qt.window.withProgress({location:Qt.ProgressLocation.Notification,title:"Running Rails destroy"},async o=>{o.report({message:`Running "${s}"`});let{stdout:a}=await n.execute(s,!0);a.split(`
`).forEach(u=>{let d=/remove\s*(.*\..*)/.exec(u);d&&i.push(d[1])}),o.report({message:"Closing deleted files"});for(let u of i)await Qt.commands.executeCommand("workbench.action.closeActiveEditor",Qt.Uri.joinPath(n.workspaceFolder.uri,u))})}async revealFormattedFiles(e,t){for(let n of t){let i=Qt.Uri.joinPath(e.workspaceFolder.uri,n);await Qt.window.showTextDocument(i,{preview:!1}),await Qt.commands.executeCommand("editor.action.formatDocument",i),await Qt.commands.executeCommand("workbench.action.files.save",i)}}};var ze=te(require("vscode"));var Rb="rubyLsp.chatAgent",ND=`
  You are a domain driven design and Ruby on Rails expert.
  The user will provide you with details about their Rails application.
  The user will ask you to help model a single specific concept.

  Analyze the provided concept carefully and think step by step. Consider the following aspects:
  1. The core purpose of the concept
  2. Its relationships with other potential entities in the system
  3. The attributes that would best represent this concept in a database

  Based on your analysis, suggest an appropriate model name and attributes to effectively model the concept.
  Follow these guidelines:

  1. Choose a clear, singular noun for the model name that accurately represents the concept
  2. Select attributes that capture the essential characteristics of the concept
  3. Use appropriate data types for each attribute (e.g. string, integer, datetime, boolean)
  4. Consider adding foreign keys for relationships with other models, if applicable

  After determining the model structure, generate the Rails commands to create the model and any associated resources.
  Include all relevant \`generate\` commands in a single Markdown shell code block at the end of your response.

  The \`generate\` commands should ONLY include the type of generator and arguments, not the \`rails generate\` part
  (e.g.: \`model User name:string\` but not \`rails generate model User name:string\`).
  NEVER include commands to migrate the database as part of the code block.
  NEVER include redundant commands (e.g. including the migration and model generation commands for the same model).
`.trim(),Oa=class{constructor(e,t){this.agent=ze.chat.createChatParticipant(Rb,this.handler.bind(this)),this.agent.iconPath=ze.Uri.joinPath(e.extensionUri,"icon.png"),this.showWorkspacePick=t}dispose(){this.agent.dispose()}async handler(e,t,n,i){return this.withinConversation("design",e,t)?this.runDesignCommand(e,t,n,i):(n.markdown("Please indicate which command you would like to use for our chat."),{metadata:{command:""}})}async runDesignCommand(e,t,n,i){let s=this.previousInteractions(t),o=[ze.LanguageModelChatMessage.User(`User prompt: ${e.prompt}`),ze.LanguageModelChatMessage.User(ND),ze.LanguageModelChatMessage.User(`Previous interactions with the user: ${s}`)],a=await this.showWorkspacePick();if(e.command&&a){let u=await this.schema(a);u&&o.push(ze.LanguageModelChatMessage.User(`Existing application schema: ${u}`))}try{let[u]=await ze.lm.selectChatModels({vendor:"copilot",family:"gpt-4o"});n.progress("Designing the models for the requested concept...");let d=await u.sendRequest(o,{},i),p="";for await(let g of d.text)n.markdown(g),p+=g;let m=/(?<=```shell)[^.$]*(?=```)/.exec(p);if(a&&m&&m[0]){let g=m[0].trim().split(`
`).map(S=>S.replace(/\s*(bin\/rails|rails) generate\s*/,""));n.button({command:"rubyLsp.railsGenerate",title:"Generate with Rails",arguments:[g,a]}),n.button({command:"rubyLsp.railsDestroy",title:"Revert previous generation",arguments:[g,a]})}}catch(u){this.handleError(u,n)}return{metadata:{command:"design"}}}async schema(e){try{return(await ze.workspace.fs.readFile(ze.Uri.joinPath(e.workspaceFolder.uri,"db/schema.rb"))).toString()}catch{}try{return(await ze.workspace.fs.readFile(ze.Uri.joinPath(e.workspaceFolder.uri,"db/structure.sql"))).toString()}catch{}}withinConversation(e,t,n){return t.command===e||!t.command&&n.history.some(i=>i instanceof ze.ChatRequestTurn&&i.command===e)}handleError(e,t){if(e instanceof ze.LanguageModelError)e.cause instanceof Error&&e.cause.message.includes("off_topic")&&t.markdown("Sorry, I can only help you with Ruby related questions");else throw e}previousInteractions(e){let t="";return e.history.forEach(n=>{if(n instanceof ze.ChatResponseTurn){if(n.participant===Rb){let i="";n.response.forEach(s=>{s instanceof ze.ChatResponseMarkdownPart&&(i+=s.value.value)}),t+=`Response: ${i}`}}else t+=`Request: ${n.prompt}`}),t}};var un=te(require("vscode"));async function Sb(r){if(!r){await un.window.showErrorMessage("No active Ruby workspace found.");return}let e=await AD(r),t=un.window.createWebviewPanel("rubyLspInfo","Ruby LSP Information",un.ViewColumn.One,{enableScripts:!0});t.webview.html=jD(e)}async function AD(r){let e=un.version,n=un.extensions.getExtension("Shopify.ruby-lsp").packageJSON.version,i=r.lspClient?.serverVersion??"Unknown",s=r.lspClient?.addons?.map(p=>p.name)??[],o=await $D(),a=un.workspace.getConfiguration("rubyLsp",r.workspaceFolder),u=un.workspace.getConfiguration("rubyLsp"),d={};for(let p of Object.keys(a))a.inspect(p)?.workspaceValue!==void 0&&(d[p]=a.get(p));return{"VS Code Version":e,"Ruby LSP Extension Version":n,"Ruby LSP Server Version":i,"Ruby LSP Addons":s,"Ruby Version":r.ruby.rubyVersion??"Unknown","Ruby Version Manager":r.ruby.versionManager.identifier,"Installed Extensions":o.sort(),"Ruby LSP Settings":{Workspace:d,User:u}}}async function $D(){return un.extensions.all.filter(r=>!(r.packageJSON.isBuiltin||r.packageJSON.license==="UNLICENSED"||!r.packageJSON.license)).map(r=>`${r.packageJSON.name} (${r.packageJSON.version})`)}function jD(r){let e=`
### Ruby LSP Information

`;for(let[n,i]of Object.entries(r)){if(e+=`#### ${n}

`,Array.isArray(i))n==="Installed Extensions"?(e+=`&lt;details&gt;
&lt;summary&gt;Click to expand&lt;/summary&gt;

`,e+=`${i.map(s=>`- ${s}`).join(`
`)}
`,e+=`&lt;/details&gt;
`):e+=`${i.map(s=>`- ${s}`).join(`
`)}
`;else if(typeof i=="object"&&i!==null){e+=`&lt;details&gt;
&lt;summary&gt;Click to expand&lt;/summary&gt;

`;for(let[s,o]of Object.entries(i))e+=`##### ${s}

`,e+=`\`\`\`json
${JSON.stringify(o,null,2)}
\`\`\`

`;e+=`&lt;/details&gt;
`}else e+=`${i}
`;e+=`
`}return`
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Ruby LSP Information</title>
      <style>
        body { font-family: var(--vscode-font-family); padding: 20px; }
        h1, h2, h3, p, li { color: var(--vscode-editor-foreground); }
        pre {
          background-color: var(--vscode-textBlockQuote-background);
          padding: 16px;
          overflow-x: auto;
          position: relative;
        }
        code { font-family: var(--vscode-editor-font-family); }
        #copyButton {
          position: absolute;
          top: 5px;
          right: 5px;
          background-color: var(--vscode-button-background);
          color: var(--vscode-button-foreground);
          border: none;
          padding: 5px 10px;
          cursor: pointer;
        }
        #copyButton:hover { background-color: var(--vscode-button-hoverBackground); }
      </style>
    </head>
    <body>
      <h1>Ruby LSP Information</h1>
      <p>Please copy the content below and paste it into the issue you're opening:</p>
      <pre><button id="copyButton">Copy</button><code id="diagnosticContent">${e}</code></pre>
      <script>
        const copyButton = document.getElementById('copyButton');
        const diagnosticContent = document.getElementById('diagnosticContent');

        copyButton.addEventListener('click', () => {
          const range = document.createRange();
          range.selectNode(diagnosticContent);
          window.getSelection().removeAllRanges();
          window.getSelection().addRange(range);
          document.execCommand('copy');
          window.getSelection().removeAllRanges();

          copyButton.textContent = 'Copied!';
          setTimeout(() => {
            copyButton.textContent = 'Copy';
          }, 2000);
        });
      </script>
    </body>
    </html>
  `}var La=class{constructor(e,t){this.workspaces=new Map;this.virtualDocuments=new Map;this.workspacesBeingLaunched=new Set;this.context=e,this.telemetry=t,this.testController=new xa(e,this.telemetry,this.currentActiveWorkspace.bind(this)),this.debug=new Ia(e,this.workspaceResolver.bind(this)),this.rails=new Fa(this.showWorkspacePick.bind(this)),this.registerCommands(e),this.statusItems=new Ea;let n=new qa;e.subscriptions.push(this.statusItems,this.debug,n,new Oa(e,this.showWorkspacePick.bind(this)),$.window.onDidChangeActiveTextEditor(i=>{wn.fire(this.currentActiveWorkspace(i))}),$.workspace.onDidChangeWorkspaceFolders(async i=>{for(let s of i.removed){let o=this.getWorkspace(s.uri);o&&(await o.stop(),await o.dispose(),this.workspaces.delete(s.uri.toString()))}}),$.workspace.onDidOpenTextDocument(async i=>{if(!xr.includes(i.languageId))return;let s=$.workspace.getWorkspaceFolder(i.uri);if(!s||this.workspacesBeingLaunched.has(s.index))return;this.getWorkspace(s.uri)||(this.workspacesBeingLaunched.add(s.index),await this.activateWorkspace(s,!1))}),$.workspace.registerTextDocumentContentProvider("embedded-content",{provideTextDocumentContent:i=>{let s=/^\/(.*)\.[^.]+$/.exec(i.path)?.[1];if(!s)return"";let o=decodeURIComponent(s);return this.virtualDocuments.get(o)}}),sr)}async activate(){await $.commands.executeCommand("testing.clearTestResults");let e=$.workspace.workspaceFolders?.[0];e&&await this.activateWorkspace(e,!0);let t=$.window.activeTextEditor?.document;if(t&&xr.includes(t.languageId)){let n=$.workspace.getWorkspaceFolder(t.uri);if(n){let i=this.workspaces.get(n.uri.toString());n&&!i&&await this.activateWorkspace(n,!1)}}this.context.subscriptions.push($.workspace.registerTextDocumentContentProvider("ruby-lsp",new ms)),wn.fire(this.currentActiveWorkspace())}async deactivate(){for(let e of this.workspaces.values())await e.stop()}async activateWorkspace(e,t){let n=$.workspace.getConfiguration("rubyLsp").get("bundleGemfile"),i=await this.lockfileExists(e.uri);if(t&&!i)return;n.length===0&&!i&&await this.showStandaloneWarning(e.uri.fsPath);let s=new Pa(this.context,e,this.telemetry,this.testController.createTestItems.bind(this.testController),this.virtualDocuments,this.workspaces.size===0);this.workspaces.set(e.uri.toString(),s),await s.activate(),await s.start(),this.context.subscriptions.push(s),await $.commands.executeCommand("setContext","rubyLsp.activated",!0),await this.showFormatOnSaveModeWarning(s),this.workspacesBeingLaunched.delete(e.index)}registerCommands(e){e.subscriptions.push($.commands.registerCommand("rubyLsp.update",async()=>{let t=await this.showWorkspacePick();t&&(await t.installOrUpdateServer(!0),await t.restart())}),$.commands.registerCommand("rubyLsp.start",async()=>{await(await this.showWorkspacePick())?.start()}),$.commands.registerCommand("rubyLsp.restart",async()=>{await(await this.showWorkspacePick())?.restart()}),$.commands.registerCommand("rubyLsp.stop",async()=>{await(await this.showWorkspacePick())?.stop()}),$.commands.registerCommand("rubyLsp.showSyntaxTree",this.showSyntaxTree.bind(this)),$.commands.registerCommand("rubyLsp.formatterHelp",()=>$.env.openExternal($.Uri.parse("https://github.com/Shopify/ruby-lsp/blob/main/vscode/README.md#formatting"))),$.commands.registerCommand("rubyLsp.displayAddons",async()=>{let t=this.currentActiveWorkspace()?.lspClient;if(!t||!t.addons)return;let n=t.addons.sort(s=>s.errored?1:-1).map(s=>({label:`${s.errored?"$(error)":"$(pass)"} ${s.name} ${s.version?`v${s.version}`:""}`})),i=$.window.createQuickPick();i.items=n,i.placeholder="Addons (click to view output)",i.onDidAccept(()=>{i.selectedItems[0]&&this.currentActiveWorkspace()?.outputChannel.show(),i.hide()}),i.onDidHide(()=>{i.dispose()}),i.show()}),$.commands.registerCommand("rubyLsp.toggleFeatures",async()=>{let t=$.extensions.getExtension("Shopify.ruby-lsp").packageJSON.contributes.configuration.properties["rubyLsp.enabledFeatures"].properties,n={};Object.entries(t).forEach(([d,p])=>{n[d]=p.description});let s=$.workspace.getConfiguration("rubyLsp").get("enabledFeatures"),o=Object.keys(s),a=o.map(d=>({label:d,picked:s[d],description:n[d]})),u=await $.window.showQuickPick(a,{canPickMany:!0,placeHolder:"Select the features you would like to enable"});u!==void 0&&(o.forEach(d=>{s[d]=u.some(p=>p.label===d)}),await $.workspace.getConfiguration("rubyLsp").update("enabledFeatures",s,!0,!0))}),$.commands.registerCommand("rubyLsp.toggleExperimentalFeatures",async()=>{let t=$.workspace.getConfiguration("rubyLsp"),n=t.get("enableExperimentalFeatures");await t.update("enableExperimentalFeatures",!n,!0,!0),wn.fire(this.currentActiveWorkspace())}),$.commands.registerCommand("rubyLsp.serverOptions",async t=>{let n=await $.window.showQuickPick(t,{placeHolder:"Select server action"});n!==void 0&&await $.commands.executeCommand(n.description)}),$.commands.registerCommand("rubyLsp.selectRubyVersionManager",async()=>{let t=await $.window.showQuickPick(["Change version manager","Change manual Ruby configuration"],{placeHolder:"What would you like to do?"});if(!t)return;if(t==="Change version manager"){let i=$.workspace.getConfiguration("rubyLsp"),s=i.get("rubyVersionManager"),o=Object.values(gf),a=await $.window.showQuickPick(o,{placeHolder:`Current: ${s.identifier}`});a!==void 0&&(s.identifier=a,await i.update("rubyVersionManager",s,!0));return}let n=await this.showWorkspacePick();n&&await n.ruby.manuallySelectRuby()}),$.commands.registerCommand("rubyLsp.runTest",(t,n,i)=>this.testController.runOnClick(n)),$.commands.registerCommand("rubyLsp.runTestInTerminal",this.testController.runTestInTerminal.bind(this.testController)),$.commands.registerCommand("rubyLsp.debugTest",this.testController.debugTest.bind(this.testController)),$.commands.registerCommand("rubyLsp.runTask",async t=>{let n=this.currentActiveWorkspace();n||(n=await this.showWorkspacePick()),n&&await n.execute(t,!0)}),$.commands.registerCommand("rubyLsp.bundleInstall",t=>{let n=this.workspaces.get(t);if(!n)return;let i=$.window.createTerminal({name:"Bundle install",cwd:n.workspaceFolder.uri.fsPath,env:n.ruby.env});i.show(),i.sendText("bundle install")}),$.commands.registerCommand("rubyLsp.openFile",t=>{if(typeof t[0]=="string")return hb(t);let[n,i]=t,s=this.currentActiveWorkspace();return fb(this.telemetry,s,{file:n,line:parseInt(i,10)-1})}),$.commands.registerCommand("rubyLsp.railsGenerate",async(t,n)=>{let i=t??await $.window.showInputBox({title:"Rails generate arguments",placeHolder:"model User name:string | scaffold Post title:string"});if(i){if(typeof i=="string"){await this.rails.generate(i,n);return}for(let s of i)await this.rails.generate(s,n)}}),$.commands.registerCommand("rubyLsp.railsDestroy",async(t,n)=>{let i=t??await $.window.showInputBox({title:"Rails destroy arguments",placeHolder:"model User name:string | scaffold Post title:string"});if(i){if(typeof i=="string"){await this.rails.destroy(i,n);return}for(let s of i)await this.rails.destroy(s,n)}}),$.commands.registerCommand("rubyLsp.fileOperation",async()=>{let t=await this.showWorkspacePick();if(!t)return;let n=[{label:"Minitest test",description:"Create a new Minitest test",iconPath:new $.ThemeIcon("new-file"),command:"rubyLsp.newMinitestFile",args:[]}];t.lspClient?.addons?.some(s=>s.name==="Ruby LSP Rails")&&n.push({label:"Rails generate",description:"Run Rails generate",iconPath:new $.ThemeIcon("new-file"),command:"rubyLsp.railsGenerate",args:[void 0,t]},{label:"Rails destroy",description:"Run Rails destroy",iconPath:new $.ThemeIcon("trash"),command:"rubyLsp.railsDestroy",args:[void 0,t]});let i=await $.window.showQuickPick(n,{title:"Select a Ruby file operation"});i&&await $.commands.executeCommand(i.command,...i.args)}),$.commands.registerCommand("rubyLsp.newMinitestFile",pb),$.commands.registerCommand("rubyLsp.collectRubyLspInfo",async()=>{let t=await this.showWorkspacePick();await Sb(t)}),$.commands.registerCommand("rubyLsp.startServerInDebugMode",async()=>{await(await this.showWorkspacePick())?.start(!0)}))}currentActiveWorkspace(e=$.window.activeTextEditor){let t;if(e?t=$.workspace.getWorkspaceFolder(e.document.uri):t=$.workspace.workspaceFolders?.find(n=>n.name===$.workspace.name),!!t)return this.getWorkspace(t.uri)}getWorkspace(e){return this.workspaces.get(e.toString())}workspaceResolver(e){if(!e)return this.currentActiveWorkspace();let t=this.workspaces.get(e.toString());return t||this.currentActiveWorkspace()}async showWorkspacePick(){if(this.workspaces.size===1)return this.workspaces.values().next().value;let e=await $.window.showWorkspaceFolderPick();if(e)return this.getWorkspace(e.uri)}async showSyntaxTree(){let e=$.window.activeTextEditor;if(e){let t=e.document;if(t.languageId!=="ruby"){await $.window.showErrorMessage("Show syntax tree: not a Ruby file");return}let n=$.workspace.getWorkspaceFolder(t.uri);if(!n)return;let i=this.getWorkspace(n.uri),s=e.selection,o;s.active.isEqual(s.anchor)||(s.isReversed?o=Pf.Range.create(s.active.line,s.active.character,s.anchor.line,s.anchor.character):o=Pf.Range.create(s.anchor.line,s.anchor.character,s.active.line,s.active.character));let a=await i?.lspClient?.sendShowSyntaxTreeRequest(t.uri,o);if(a){let u=await $.workspace.openTextDocument($.Uri.from({scheme:"ruby-lsp",path:"show-syntax-tree",query:a.ast}));await $.window.showTextDocument(u,{viewColumn:$.ViewColumn.Beside,preserveFocus:!0})}}}async showFormatOnSaveModeWarning(e){let t=$.workspace.getConfiguration("editor",{languageId:"ruby"}),n=t.get("formatOnSaveMode");if(n==="file")return;await $.window.showWarningMessage(`The "editor.formatOnSaveMode" setting is set to ${n} in workspace ${e.workspaceFolder.name}, which
      is currently unsupported by the Ruby LSP. If you'd like to have formatting enabled, please set it to 'file'`,"Change setting to 'file'","Use without formatting")==="Change setting to 'file'"&&await t.update("formatOnSaveMode","file",$.ConfigurationTarget.Global)}async lockfileExists(e){try{return await $.workspace.fs.stat($.Uri.joinPath(e,"Gemfile.lock")),!0}catch{}try{return await $.workspace.fs.stat($.Uri.joinPath(e,"gems.locked")),!0}catch{}return!1}async showStandaloneWarning(e){await $.window.withProgress({location:$.ProgressLocation.Notification,title:"No bundle found. Launching in standalone mode in 5 seconds",cancellable:!0},async(t,n)=>{if(t.report({message:"If working in a monorepo, cancel to see configuration instructions"}),await new Promise(i=>{n.onCancellationRequested(()=>{i()}),setTimeout(i,5e3)}),n.isCancellationRequested&&await $.window.showWarningMessage(`Could not find a lockfile in ${e}. Are you using a monorepo setup?`,"See the multi-root workspace docs","Launch anyway")==="See the multi-root workspace docs"){let s=$.Uri.parse("https://github.com/Shopify/ruby-lsp/blob/main/vscode/README.md?tab=readme-ov-file#multi-root-workspaces");await $.env.openExternal(s)}})}};var kf;async function UD(r){if(!Yt.workspace.workspaceFolders){await Yt.window.showWarningMessage(`Using the Ruby LSP without any workspaces opened is currently not supported
      ([learn more](https://github.com/Shopify/ruby-lsp/issues/1780))`,"Open a workspace","Continue anyway")==="Open a workspace"&&await Yt.commands.executeCommand("workbench.action.files.openFolder");return}await WD();let e=await KD(r);r.subscriptions.push(e),kf=new La(r,e),await kf.activate()}async function HD(){await kf.deactivate()}async function WD(){let r=Yt.workspace.getConfiguration("rubyLsp");r.get("enableExperimentalFeatures")&&(await r.update("enableExperimentalFeatures",void 0,!0),await r.update("featureFlags",{all:!0},!0))}async function KD(r){let e;switch(r.extensionMode){case Yt.ExtensionMode.Development:e={sendEventData:(t,n)=>{sr.debug(t,n)},sendErrorData:(t,n)=>{sr.error(t,n)}};break;case Yt.ExtensionMode.Test:e={sendEventData:(t,n)=>{},sendErrorData:(t,n)=>{}};break;default:try{let t=0;for(;!e&&t<5;)await Yt.commands.executeCommand("getTelemetrySenderObject"),e=await Yt.commands.executeCommand("getTelemetrySenderObject"),t++}catch{e={sendEventData:(n,i)=>{},sendErrorData:(n,i)=>{}}}break}return e||(e={sendEventData:(t,n)=>{},sendErrorData:(t,n)=>{}}),Yt.env.createTelemetryLogger(e,{ignoreBuiltInCommonProperties:!0,ignoreUnhandledErrors:!0,additionalCommonProperties:{extensionVersion:r.extension.packageJSON.version,environment:Db.default.platform()}})}0&&(module.exports={activate,deactivate});
